{"version":3,"sources":["webpack://Graphon/webpack/universalModuleDefinition","webpack://Graphon/webpack/bootstrap","webpack://Graphon/./src/styles/index.pcss","webpack://Graphon/./src/modules/state.js","webpack://Graphon/./src/utils/dom.js","webpack://Graphon/./src/utils/event.js","webpack://Graphon/./src/modules/path.js","webpack://Graphon/./src/modules/bar.js","webpack://Graphon/./src/modules/area.js","webpack://Graphon/./src/modules/graph.js","webpack://Graphon/./src/utils/numbers.js","webpack://Graphon/./src/modules/minimap.js","webpack://Graphon/./src/modules/tooltip.js","webpack://Graphon/./src/modules/pointer.js","webpack://Graphon/./src/modules/chart.js","webpack://Graphon/./src/modules/legend.js","webpack://Graphon/./src/modules/header.js","webpack://Graphon/./src/graphon.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","State","chartsData","colors","titles","type","title","byMonth","scaled","height","lines","split","this","columns","dates","forEach","line","date","values","val","index","parseFloat","Math","round","push","names","isYScaled","_cache","getLinePoints","daysCount","length","_recalculatedPoints","keys","lineName","getColumnByName","from","count","slice","chartName","types","currentChartNumber","pointIndex","prevChartKey","linesAvailable","stacks","to","stackValue","getStackForPoint","skipLines","includes","max","filter","maxPerLines","map","minPerLines","min","leftPointIndex","pointsVisible","getPointsSlice","entries","make","tagName","classNames","attributes","el","document","createElementNS","createElement","Array","isArray","classList","add","className","attrName","setAttribute","animateCounter","holder","prevVal","animateType","prev","cur","style","width","textContent","innerHTML","appendChild","getPageX","event","touches","pageX","canvasHeight","zeroShifting","color","kY","stroke","stepX","isScaled","prevX","currentMinimum","path","fill","pathData","graphHidden","x","y","skipStep","contains","CSS","status","toggle","wrapper","hidden","transform","prevValue","bar","newStack","children","createPath","morphing","undefined","per","total","valueInPercents","valueToPercent","percentToValue","skip","prevPercents","isNaN","percentage","pointToChange","trim","join","beginElement","canvas","oyGroup","oxGroup","stepY","strokeWidth","initialWidth","maxPoint","minPoint","oyScaling","zeroShiftingScaling","charts","_width","_height","computeInitialWidth","computeSteps","state","stepsAvailable","newStepYIndex","reverse","findIndex","step","newStepY","getCommonChartsType","getMaximumAccumulatedByColumns","drawBarCharts","drawAreaCharts","drawScaledLineCharts","drawLineCharts","areas","getLineColor","pointsCount","getStacks","moveTo","pointValue","stepTo","area","finish","getAll","barmens","barmen","chart","isHidden","hiddenCharts","getMaxForLineSliced","checkPathVisibility","lineMin","minForLine","lineMax","maxForLine","column","render","leftPoint","newLeft","scaling","newMax","newMin","number","maxSlicing","zeros","log10","rounding","pow","result","floor","newZeroShifting","shift","newKY","useRecalculated","recalculateBars","recalculateArea","recalculated","recalculatedValues","lenCached","move","clearRecalculatedValues","hiddenPointsValue","reduce","saveRecalculatedValues","update","toggleVisibility","nodes","leftZone","leftZoneScaler","rightZone","rightZoneScaler","centerZone","wrapperWidthCached","viewportWidth","viewportWidthInitial","viewportOffsetLeft","scalerWidth","viewportWidthBeforeDrag","moveStartX","wrapperLeftCoord","viewportPressed","leftScalerClicked","rightScalerClicked","scaleDebounce","leftZoneWidth","rightZoneWidth","wrapperRect","graph","animate","setTimeout","getBoundingClientRect","bindEvents","remove","renderCanvas","offsetWidth","offsetHeight","renderCharts","setInitialPosition","wrapperWidth","left","scrollDistance","leftWidth","rightWidth","centerWidth","rect","minimalMapWidth","moveViewport","syncScrollWithChart","fitToMax","scrolledValue","offsetLeft","maxLeft","minLeft","leftZoneMinimumWidth","supportsPassive","opts","addEventListener","removeEventListener","e","viewportMousedown","passive","viewportMousemove","viewportMouseup","target","closest","viewportDragged","scalerDragged","finishSliding","finishLeftScaling","finishRightScaling","delta","_ftmd","clearTimeout","newScroll","fromScale","chartScroll","parseInt","scroll","side","newScalerWidth","direction","right","leftZoneMaximumWidth","rightZoneMaximumWidth","newViewportWidth","initialScale","scale","togglePathVisibility","recalculatePointsHeight","notHiddenGraph","scaleToMaxPoint","getMaxFromVisible","_values","showed","valueTitle","lineLeftCoord","clear","prevValues","_setValuesDebounce","summ","createItem","all","isAll","item","counter","acc","percent","ceil","percentEl","titleEl","valueBeautified","toString","replace","string","dt","months","week","month","getMonth","year","getFullYear","weekday","getDay","day","getDate","newDate","_prevDate","pointers","pointer","pointerHidden","leftPx","show","borderColor","coord","kYScaled","viewport","cursorLine","grid","gridLines","legend","legendDates","overlays","overlayLeft","overlayRight","tooltip","scrollValue","legendDateWidth","legendDateWidthMargins","legendDatesHidedTimes","legendDatesRecentlyHided","onscreenDates","Set","onscreenDatesElements","_datesPerScreenInitial","_showEveryNDateInitial","cache","_initialScale","_initialStep","_hoveredPointIndex","chartToViewportRatio","originalWidth","scaledViewportRatio","originalScalingChange","gridSection","gridSectionHidden","gridCounter","gridCounterHidden","gridCounterFirst","gridCounterSecond","dateHidden","viewportHeight","calculateWrapperCoords","calculateInitialValues","renderGrid","renderLegend","renderOverlays","stepsCount","kYRatio","diffSize","decimals","possibleHeight","isSecond","text","thousands","dataset","element","parentNode","insertBefore","stepYSecond","kYSecond","maxSecond","minSecond","getMaxVisiblePoint","linesCount","getLegendStep","getMinVisiblePoint","j","createLine","bottom","getLegendCounter","counter2","toggleGridLabelsForChart","originalIndex","skippedCount","onscreenPointsCount","datesPerScreen","checks","check","some","dateEl","centering","newX","stepScaled","checkDateShouldBeHidden","originIndex","visibleIndex","Date","toLocaleDateString","moveDate","datesOnScreenSlice","rightPointIndex","datesOnScreenIndexes","pointsOnScreen","has","pushDate","removeDate","delete","nextSibling","position","hide","hideBarHighlighting","addOnscreenDates","_sd","rightDate","header","setPeriod","scaleLines","leftPointVisible","getMinForLineSliced","_gd","mouseMove","mouseLeave","viewportX","stepXWithScale","scrollOffset","hoveredPointIndex","abs","highlightBar","showValues","hideOverlays","querySelectorAll","opacity","rightX","buttons","itemWobble","itemSelected","itemEnabled","checkbox","createTextNode","_clickPrevented","itemClicked","mousedown","mouseup","_timer","uncheckAllExceptPassed","exceptName","togglePath","minimap","isLast","querySelector","backgroundColor","typeSwitchers","detailsTogglers","typeSwitcher","typeSwitcherCurrent","detailsToggler","detailsTogglerItem","detailsTogglerItemCurrent","dataByMonth","appendDetailsToggler","showTypeSwitchers","icon","switcher","typeSwitcherClicked","toggler","dataStoringProperty","togglerItem","detailsTogglerClicked","destroy","renderMap","createState","leftDateTimestamp","rightDateTimestamp","leftDate","holderId","data","showLegend","getElementById","loadStyles","prepareUi","nightModeEnabled","head","id","renderUi"],"mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAiB,QAAID,IAErBD,EAAc,QAAIC,IARpB,CASGK,OAAQ,WACX,O,YCTE,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUP,QAGnC,IAAIC,EAASI,EAAiBE,GAAY,CACzCC,EAAGD,EACHE,GAAG,EACHT,QAAS,IAUV,OANAU,EAAQH,GAAUI,KAAKV,EAAOD,QAASC,EAAQA,EAAOD,QAASM,GAG/DL,EAAOQ,GAAI,EAGJR,EAAOD,QA0Df,OArDAM,EAAoBM,EAAIF,EAGxBJ,EAAoBO,EAAIR,EAGxBC,EAAoBQ,EAAI,SAASd,EAASe,EAAMC,GAC3CV,EAAoBW,EAAEjB,EAASe,IAClCG,OAAOC,eAAenB,EAASe,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEV,EAAoBgB,EAAI,SAAStB,GACX,oBAAXuB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAenB,EAASuB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAenB,EAAS,aAAc,CAAEyB,OAAO,KAQvDnB,EAAoBoB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQnB,EAAoBmB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFAxB,EAAoBgB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOnB,EAAoBQ,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRvB,EAAoB2B,EAAI,SAAShC,GAChC,IAAIe,EAASf,GAAUA,EAAO2B,WAC7B,WAAwB,OAAO3B,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAK,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG7B,EAAoBgC,EAAI,GAIjBhC,EAAoBA,EAAoBiC,EAAI,G,gBClFrDtC,EAAOD,QAAU,ysd,wDCIF,MAAMwC,EAUnB,YAAYC,EAAYC,EAAQC,EAAQC,EAAMC,EAAOC,EAASC,EAAQC,GACpE,MAAMC,EAAQR,EAAWS,MAAM,MAE/BC,KAAKC,QAAU,GACfD,KAAKE,MAAQ,GACbF,KAAKP,KAAOA,EACZO,KAAKN,MAAQA,EACbM,KAAKL,QAAUA,EACfK,KAAKH,OAASA,EAEdC,EAAMK,QAASC,IACb,IAAKC,KAASC,GAAUF,EAAKL,MAAM,KAEnCO,EAAOH,QAAQ,CAACI,EAAKC,KACnBD,EAAME,WAAWF,GACjBA,EAAMG,KAAKC,MAAY,IAANJ,GAAa,IAE1BP,KAAKC,QAAQO,GACfR,KAAKC,QAAQO,GAAOI,KAAKL,GAEzBP,KAAKC,QAAQO,GAAS,CAACD,KAI3BP,KAAKE,MAAMU,KAAKP,KAGlBL,KAAKT,OAASA,EACdS,KAAKa,MAAQrB,EACbQ,KAAKc,UAAYlB,IAAU,EAK3BI,KAAKe,OAAS,CAIZC,cAAe,GACfd,MAAOF,KAAKC,QAAQ,GACpBgB,UAAWjB,KAAKC,QAAQ,GAAGiB,QAG7BlB,KAAKmB,oBAAsB,GAgB7B,qBACE,OAAOpD,OAAOqD,KAAKpB,KAAKa,OAO1B,gBACE,OAAOb,KAAKe,OAAOE,UAQrB,cAAcI,GACZ,OAAIrB,KAAKe,OAAOC,cAAcK,GACrBrB,KAAKe,OAAOC,cAAcK,IAGnCrB,KAAKe,OAAOC,cAAcK,GAAYrB,KAAKsB,gBAAgBD,GAGpDrB,KAAKe,OAAOC,cAAcK,IAQnC,gBAAgBzD,GACd,OAAOoC,KAAKC,QAAQrC,GAUtB,eAAeyD,EAAUE,EAAMC,GAC7B,OAAOxB,KAAKgB,cAAcK,GAAUI,MAAMF,EAAMA,EAAOC,GAQzD,aAAaH,GACX,OAAOrB,KAAKT,OAAO8B,GAQrB,aAAaK,GACX,OAAO1B,KAAK2B,MAAMD,GAOpB,sBACE,OAAO1B,KAAKP,KAQd,0BAA0BmC,EAAoBC,GAC5C,IAAIC,EAAe9B,KAAK+B,eAAeH,EAAqB,GAC5D,OAAO5B,KAAKgB,cAAcc,GAAcD,GAM1C,YACE,GAAI7B,KAAKe,OAAOiB,OACd,OAAOhC,KAAKe,OAAOiB,OAGrB,IACIC,EAAKjC,KAAKiB,UACVe,EAAS,GAEb,IAAK,IAAIH,EAJE,EAIiBA,EAAaI,EAAIJ,IAAa,CACxD,IAAIK,EAAalC,KAAKmC,iBAAiBN,GAEvCG,EAAOpB,KAAKsB,GAKd,OAFAlC,KAAKe,OAAOiB,OAASA,EAEdhC,KAAKe,OAAOiB,OASrB,iBAAiBH,EAAYO,EAAY,IACvC,IAAIF,EAAa,EAUjB,OARAlC,KAAK+B,eAAe5B,QAAQC,IACtBgC,EAAUC,SAASjC,KAIvB8B,GAAclC,KAAKgB,cAAcZ,GAAMyB,MAGlCK,EAUT,+BAA+BX,EAAO,EAAGU,EAAKjC,KAAKiB,UAAWmB,EAAY,IACxE,IAAIE,EAAM,EAEV,IAAK,IAAIT,EAAaN,EAAMM,EAAaI,EAAIJ,IAAa,CACxD,IAAIK,EAAalC,KAAKmC,iBAAiBN,EAAYO,GAE/CE,EAAMJ,IACRI,EAAMJ,GAIV,OAAOI,EAQT,cAAcZ,GACZ,OAAO3D,OAAOqD,KAAKpB,KAAK2B,OAAOY,OAAO9C,GAAQA,IAASiC,GAOzD,UACE,MAAMc,EAAcxC,KAAK+B,eAAeU,IAAK7E,GACpC8C,KAAK4B,OAAOtC,KAAKgB,cAAcpD,KAGxC,OAAO8C,KAAK4B,OAAOE,GAOrB,WAAW5E,GACT,OAAO8C,KAAK4B,OAAOtC,KAAKgB,cAAcpD,IAOxC,UACE,MAAM8E,EAAc1C,KAAK+B,eAAeU,IAAK7E,GACpC8C,KAAKiC,OAAO3C,KAAKgB,cAAcpD,KAGxC,OAAO8C,KAAKiC,OAAOD,GAOrB,WAAW9E,GACT,OAAO8C,KAAKiC,OAAO3C,KAAKgB,cAAcpD,IAMxC,oBAAoBwC,EAAMwC,EAAgBC,GACxC,OAAOnC,KAAK4B,OAAOtC,KAAK8C,eAAe1C,EAAMwC,EAAgBC,IAM/D,oBAAoBzC,EAAMwC,EAAgBC,GACxC,OAAOnC,KAAKiC,OAAO3C,KAAK8C,eAAe1C,EAAMwC,EAAgBC,IAO/D,iBACE,OAAO9E,OAAOgF,QAAQ/C,KAAKT,QAAQkD,IAAI,EAAE7E,EAAMU,KAAWA,GAO5D,gBACE,OAAOP,OAAOgF,QAAQ/C,KAAKa,OAAO4B,IAAI,EAAE7E,EAAMU,KAAWA,GAO3D,uBAAuBgC,GACrBN,KAAKmB,oBAAoBP,KAAKN,GAOhC,0BACEN,KAAKmB,oBAAsB,GAG7B,yBACE,OAAOnB,KAAKmB,qBCtTT,SAAS6B,EAAKC,EAASC,EAAwBC,EAAa,IACjE,MAGMC,EAFc,CAAC,MAAO,OAAQ,OAAQ,SAAU,OAAQ,IAAK,WACzCf,SAASY,GACmBI,SAASC,gBAH1C,6BAGwEL,GAAzEI,SAASE,cAAcN,GAQ3C,GANIO,MAAMC,QAAQP,IAAeA,EAAWhC,OAC1CkC,EAAGM,UAAUC,OAAOT,GACXA,IACTE,EAAGQ,UAAYV,GAGbC,GAAcpF,OAAOqD,KAAK+B,GAAYjC,OACxC,IAAK,IAAI2C,KAAYV,EACfA,EAAWjE,eAAe2E,IAC5BT,EAAGU,aAAaD,EAAUV,EAAWU,IAK3C,OAAOT,EAiBF,SAASW,EAAeC,EAAQzD,EAAK0D,EAASC,EAAc,WACjE,IAAIC,EAAOnB,EAAK,OAAQ,CAAC,eAAgBkB,IACrCE,EAAMpB,EAAK,OAAQ,CAAC,cAAekB,IAEvCF,EAAOK,MAAMC,MAAqB,EAAb/D,EAAIW,OAAa,KAEtCiD,EAAKI,YAAcN,EACnBG,EAAIG,YAAchE,EAElByD,EAAOQ,UAAY,GACnBR,EAAOS,YAAYN,GAEnBH,EAAOS,YAAYL,GCpDd,SAASM,EAASC,GACvB,OAAIA,EAAMC,QACDD,EAAMC,QAAQ,GAAGC,MAGnBF,EAAME,MCJA,MAAM,EACnB,aAAY,aAACC,EAAY,aAAEC,EAAY,MAAEC,EAAK,GAAEC,EAAE,OAAEC,EAAM,MAAEC,EAAK,IAAE7C,EAAG,IAAEK,EAAG,SAAEyC,IAC3EpF,KAAK8E,aAAeA,EACpB9E,KAAK+E,aAAeA,EACpB/E,KAAKiF,GAAKA,EACVjF,KAAKmF,MAAQA,EACbnF,KAAKqF,MAAQ,EACbrF,KAAKsC,IAAMA,EACXtC,KAAK2C,IAAMA,EAGX3C,KAAKsF,eAAiB,EAEtBtF,KAAKuF,KAAO,EAAS,OAAQ,KAAM,CACjC,eAAiBL,EACjBA,OAASF,EACTQ,KAAO,cACP,iBAAmB,QACnB,kBAAoB,QACpB,gBAAiB,uBAGfJ,GACFpF,KAAKuF,KAAK7B,UAAUC,IAAI,UAG1B3D,KAAKyF,SAAW,GAOlB,iBACE,MAAO,CACLC,YAAa,oBAOjB,EAAEnF,GACA,OAAOG,KAAKC,MAAMX,KAAK8E,aAAevE,EAAMP,KAAKiF,GAAKjF,KAAK+E,cAM7D,EAAExE,GACA,OAAOA,EAQT,OAAOoF,EAAGC,GACR5F,KAAKyF,eAAiBzF,KAAK2F,EAAEA,MAAM3F,KAAK4F,EAAEA,KAO5C,OAAOA,EAAGC,GACHA,IACH7F,KAAKqF,MAAQrF,KAAKqF,MAAQrF,KAAKmF,OAEjCnF,KAAKyF,gBAAkBzF,KAAK2F,EAAE3F,KAAKqF,UAAUrF,KAAK4F,EAAEA,KAMtD,SAEE,OADA5F,KAAKuF,KAAKzB,aAAa,IAAK9D,KAAKyF,UAC1BzF,KAAKuF,KAGd,eACE,OAAOvF,KAAKuF,KAAK7B,UAAUoC,SAAS,EAAKC,IAAIL,aAG/C,iBAAiBM,GACfhG,KAAKuF,KAAK7B,UAAUuC,OAAO,EAAKF,IAAIL,YAAaM,ICtFtC,MAAM,EACnB,aAAY,aAAClB,EAAY,GAAEG,EAAE,MAAEE,EAAK,IAAEvG,IACpCoB,KAAK8E,aAAeA,EACpB9E,KAAKiF,GAAKA,EACVjF,KAAKpB,IAAMA,EAEXoB,KAAKqF,MAAQ,EACbrF,KAAKmF,MAAQA,EAEbnF,KAAKkG,QAAU,EAAS,KACxBlG,KAAKkG,QAAQpC,aAAa,QAAS,EAAIiC,IAAIG,SAC3ClG,KAAKkG,QAAQpC,aAAa,gBAAiB,sBAC3C9D,KAAKmG,QAAS,EACdnG,KAAKkG,QAAQ7B,MAAM+B,yBAA2BpG,KAAKmF,MAAQ,OAI7D,SACE,OAAOnF,KAAKkG,QAOd,iBACE,MAAO,CACLA,QAAS,SACTR,YAAa,kBAOjB,EAAEnF,GACA,OAAOP,KAAK8E,aAAevE,EAAMP,KAAKiF,GAMxC,EAAE1E,GACA,OAAOA,EAOT,IAAIqF,EAAG1D,EAAYmE,EAAWrB,GAC5B,IAEInF,EAFcqC,EAAalC,KAAKiF,GACnBoB,EAAYrG,KAAKiF,GAGlC,MAAMqB,EAAM,EAAS,QACrBA,EAAIxC,aAAa,QAAS9D,KAAKmF,OAC/BmB,EAAIxC,aAAa,SAAUjE,GAC3ByG,EAAIxC,aAAa,IAAK9D,KAAKqF,OAC3BiB,EAAIxC,aAAa,IAAK9D,KAAK4F,EAAE1D,EAAamE,IAC1CC,EAAIxC,aAAa,OAAQkB,GAEzBhF,KAAKqF,MAAQrF,KAAKqF,MAAQrF,KAAKmF,MAK/BnF,KAAKkG,QAAQzB,YAAY6B,GAG3B,KAAK9F,EAAO+F,EAAUF,GACpB,IAAIC,EAAMtG,KAAKkG,QAAQM,SAAShG,GAG5BX,EAFc0G,EAAWvG,KAAKiF,GACjBoB,EAAYrG,KAAKiF,GAGlCqB,EAAIxC,aAAa,SAAUjE,GAC3ByG,EAAIxC,aAAa,IAAK9D,KAAK4F,EAAEW,EAAWF,IAI1C,eACE,OAAOrG,KAAKmG,OAGd,iBAAiBH,GACfhG,KAAKmG,QAAUnG,KAAKmG,OACpBnG,KAAKkG,QAAQxC,UAAUuC,OAAO,EAAIF,IAAIL,YAAaM,ICvFxC,MAAM,EACnB,aAAY,aAAClB,EAAY,MAAEK,EAAK,IAAEvG,EAAG,MAAEoG,IACrChF,KAAK8E,aAAeA,EACpB9E,KAAKpB,IAAMA,EACXoB,KAAKgF,MAAQA,EAEbhF,KAAKqF,MAAQ,EACbrF,KAAKmF,MAAQA,EACbnF,KAAKmG,QAAS,EAGdnG,KAAKuF,KAAOvF,KAAKyG,aACjBzG,KAAK0G,cAAWC,EAEhB3G,KAAKyF,SAAW,GAGlB,aACE,IAAIF,EAAO,EAAS,OAAQ,KAAM,CAChCC,KAAOxF,KAAKgF,MACZ,gBAAiB,uBAKnB,OAFAO,EAAK7B,UAAUC,IAAI,EAAKoC,IAAIR,MAErBA,EAGT,SACE,OAAOvF,KAAKuF,KAOd,iBACE,MAAO,CACLA,KAAM,UACNG,YAAa,mBAOjB,EAAEnF,GACA,OAAOP,KAAK8E,aAAevE,EAM7B,EAAEA,GACA,OAAOA,EAGT,eAAeqG,GACb,OAAO5G,KAAK8E,aAAe,IAAM8B,EAGnC,eAAerG,EAAKsG,GAClB,OAAO,IAAMA,EAAQtG,EAQvB,OAAOoF,EAAGC,EAAGiB,EAAQ,GACnB,IAAIC,EAAkBD,EAAQ7G,KAAK+G,eAAenB,EAAGiB,GAASjB,EAC9D5F,KAAKyF,SAAS7E,UAAU+E,KAAK3F,KAAKgH,eAAeF,MAOnD,OAAOD,EAAO1C,EAAM8C,GAAO,GACzB,IAAIC,EAAe,IAAML,EAAQ1C,EAK7BgD,MAAMD,KACRA,EAAe,KAIjB,IAAIE,EAAapH,KAAKgH,eAAe,IAAME,GAEtCD,IACHjH,KAAKqF,MAAQrF,KAAKqF,MAAQrF,KAAKmF,OAEjCnF,KAAKyF,SAAS7E,UAAUZ,KAAK2F,EAAE3F,KAAKqF,UAAUrF,KAAK4F,EAAEwB,MAQvD,KAAK5G,EAAOqG,EAAO1C,GACjB,IAGI+C,EAAcE,EAHdC,EAAgBrH,KAAKyF,SAASjF,EAAQ,IACrClD,EAAGqI,EAAGC,GAAKyB,EAAcC,OAAOvH,MAAM,KAIvC8G,EAAQ,GACVK,EAAe,IAAML,EAAQ1C,EAC7BiD,EAAapH,KAAKgH,eAAe,IAAME,IAEvCE,EAAapH,KAAKgH,eAAe,GAGnChH,KAAKyF,SAASjF,EAAQ,SAAWmF,KAAK3F,KAAK4F,EAAEwB,KAG/C,SACEpH,KAAK0G,SAAW,EAAS,WACzB1G,KAAK0G,SAAS5C,aAAa,gBAAiB,KAC5C9D,KAAK0G,SAAS5C,aAAa,gBAAiB,OAC5C9D,KAAK0G,SAAS5C,aAAa,MAAO,SAClC9D,KAAK0G,SAAS5C,aAAa,OAAQ,UACnC9D,KAAK0G,SAAS5C,aAAa,KAAM9D,KAAKyF,SAAS8B,KAAK,MACpDvH,KAAKuF,KAAKd,YAAYzE,KAAK0G,UAC3B1G,KAAK0G,SAASc,eAMhB,SACExH,KAAKyF,SAAS7E,UAAUZ,KAAK2F,EAAE3F,KAAKqF,UAAUrF,KAAK8E,kBAAkB9E,KAAK8E,oBAC1E9E,KAAKuF,KAAKzB,aAAa,IAAK9D,KAAKyF,SAAS8B,KAAK,MAGjD,eACE,OAAOvH,KAAKmG,OAGd,iBAAiBH,GACfhG,KAAKmG,QAAUnG,KAAKmG,OACpBnG,KAAKuF,KAAK7B,UAAUuC,OAAO,EAAKF,IAAIL,YAAaM,ICzItC,MAAM,EAInB,YAAYzI,GAAS,OAAC2H,IAOpBlF,KAAKzC,QAAUA,EAKfyC,KAAKyH,YAASd,EAKd3G,KAAK0H,aAAUf,EAKf3G,KAAK2H,aAAUhB,EAEf3G,KAAKmF,MAnBkB,GAoBvBnF,KAAK4H,MAAQ,GACb5H,KAAK6H,YAAc3C,EACnBlF,KAAK8H,kBAAenB,EACpB3G,KAAK+H,SAAW,EAChB/H,KAAKgI,SAAW,EAMhBhI,KAAKiF,GAAK,EAMVjF,KAAK+E,aAAe,EAKpB/E,KAAKsF,eAAiB,EAMtBtF,KAAKiI,UAAY,EAMjBjI,KAAKkI,oBAAsB,EAQ3BlI,KAAKmI,OAAS,GAOdnI,KAAKoI,OAAS,EACdpI,KAAKqI,QAAU,EAGjB,iBACE,MAAO,CACLV,QAAS,WACTD,QAAS,YAQb,eACE,OAAO1H,KAAKiF,GAAKjF,KAAKiI,UASxB,cAAa,MAAC3D,EAAK,OAAEzE,GAAU,IAyB7B,OAxBAG,KAAKyH,OAAS,EAAS,OACvBzH,KAAK2H,QAAU,EAAS,KACxB3H,KAAK0H,QAAU,EAAS,KAExB1H,KAAK2H,QAAQ7D,aAAa,QAAS,EAAMiC,IAAI4B,SAC7C3H,KAAK0H,QAAQ5D,aAAa,QAAS,EAAMiC,IAAI2B,SAC7C1H,KAAK0H,QAAQ5D,aAAa,gBAAiB,sBAC3C9D,KAAK2H,QAAQ7D,aAAa,gBAAiB,sBAEtCQ,EAGHtE,KAAKsE,MAAQtE,KAAK8H,aAAexD,EAFjCtE,KAAKsI,sBAKHzI,IACFG,KAAKH,OAASA,GAGhBG,KAAKuI,eAELvI,KAAK0H,QAAQjD,YAAYzE,KAAK2H,SAC9B3H,KAAKyH,OAAOhD,YAAYzE,KAAK0H,SAEtB1H,KAAKyH,OAMd,sBACEzH,KAAK8H,aAAe9H,KAAKzC,QAAQiL,MAAMvH,UAAYjB,KAAKmF,MACxDnF,KAAKsE,MAAQtE,KAAK8H,aAOpB,YACE,OAAO9H,KAAKoI,OAOd,UAAU7H,GACRP,KAAKoI,OAAS7H,EACdP,KAAKyH,OAAOpD,MAAMC,MAAQ/D,EAAM,KAOlC,aACE,OAAOP,KAAKqI,QAOd,WAAW9H,GACTP,KAAKqI,QAAU9H,EACfP,KAAKyH,OAAOpD,MAAMxE,OAASU,EAAM,KAMnC,eACMP,KAAKzC,QAAQiL,MAAM7I,SACW,QAA5BK,KAAKzC,QAAQiL,MAAM/I,KACrBO,KAAKmF,MAAQnF,KAAKsE,MAAStE,KAAKzC,QAAQiL,MAAe,UAKzDxI,KAAKmF,MAAQnF,KAAKsE,OAAStE,KAAKzC,QAAQiL,MAAMvH,UAAY,GAM5D,MAAMqB,EAAMtC,KAAKzC,QAAQiL,MAAMlG,IACzBK,EAAM3C,KAAKzC,QAAQiL,MAAM7F,IACzB8F,EAAiB,CAAC,EAAG,GAAI,GAAI,GAAI,IAAK,IAAM,IAAK,IAAO,IAAM,IAAQ,IAAS,KACrF,IAAIC,EAAgBD,EAAeE,UAAUC,UAAYC,IAGvD,OAFSvG,EAAMK,EAAOkG,IAIxBC,EAAWL,EAAeC,GAEtBpG,EAAMwG,EAAW,GAAKJ,EAAgBD,EAAevH,OAAS,IAChE4H,EAAWL,EAAeC,EAAgB,IAG5C1I,KAAK4H,MAAQkB,EAGf,eAGE,OAFa9I,KAAKzC,QAAQiL,MAAMO,uBAG9B,IAAK,MACH/I,KAAK+H,SAAW/H,KAAKzC,QAAQiL,MAAMQ,iCACnChJ,KAAKgI,SAAWhI,KAAKzC,QAAQiL,MAAM7F,IACnC3C,KAAKiJ,gBACL,MACF,IAAK,OACHjJ,KAAK+H,SAAW/H,KAAKzC,QAAQiL,MAAMQ,iCACnChJ,KAAKkJ,iBACL,MACF,QACA,IAAK,OACElJ,KAAKzC,QAAQiL,MAAM1H,UAMtBd,KAAKmJ,wBALLnJ,KAAK+H,SAAW/H,KAAKzC,QAAQiL,MAAMlG,IACnCtC,KAAKgI,SAAWhI,KAAKzC,QAAQiL,MAAM7F,IAEnC3C,KAAKoJ,mBASb,iBACE,IAAIC,EAAQrJ,KAAKzC,QAAQiL,MAAMzG,eAAe4G,UAAUlG,IAAKrC,GACpD,IAAI,EAAK,CACd0E,aAAc9E,KAAKH,OACnBsF,MAAOnF,KAAKmF,MACZvG,IAAKwB,EACL4E,MAAOhF,KAAKzC,QAAQiL,MAAMc,aAAalJ,MAI3C,MAAMmJ,EAAcvJ,KAAKzC,QAAQiL,MAAMvH,UACjCe,EAAShC,KAAKzC,QAAQiL,MAAMgB,YAElCxJ,KAAKzC,QAAQiL,MAAMzG,eAAe4G,UAAUxI,QAAS,CAACC,EAAMI,KAC1D6I,EAAM7I,GAAOiJ,OAAO,EAAGzJ,KAAKzC,QAAQiL,MAAMxH,cAAcZ,GAAM,GAAI4B,EAAO,MAI3E,IAAK,IAAIH,EAAa,EAAGA,EAAa0H,EAAa1H,IAAc,CAC/D,IAAIwE,EAAY,EAEhBrG,KAAKzC,QAAQiL,MAAMzG,eAAe4G,UAAUxI,QAAS,CAACC,EAAMI,KAC1D,IAAIkJ,EAAa1J,KAAKzC,QAAQiL,MAAMxH,cAAcZ,GAAMyB,GAErC,IAAfA,EACFwH,EAAM7I,GAAOmJ,OAAO3H,EAAOH,GAAawE,GAAW,GAEnDgD,EAAM7I,GAAOmJ,OAAO3H,EAAOH,GAAawE,GAG1CA,GAAaqD,IAIjBL,EAAMlJ,QAAQyJ,IACZA,EAAKC,SACL7J,KAAK2H,QAAQlD,YAAYmF,EAAKE,UAC9B9J,KAAKmI,OAAOyB,EAAKhL,KAAOgL,IAI5B,gBACE,MAAM3E,EAAuB,IAAlBjF,KAAK+H,SAAiB/H,KAAKH,OAASG,KAAK+H,SAAW,EAC/D,IAAIgC,EAAU/J,KAAKzC,QAAQiL,MAAMzG,eAAe4G,UAAUlG,IAAKrC,GACtD,IAAI,EAAI,CACb0E,aAAc9E,KAAKH,OACnBsF,MAAOnF,KAAKmF,MACZF,KACArG,IAAKwB,KAIT,MAAMmJ,EAAcvJ,KAAKzC,QAAQiL,MAAMvH,UACjCe,EAAShC,KAAKzC,QAAQiL,MAAMgB,YAElC,IAAK,IAAI3H,EAAa,EAAGA,EAAa0H,EAAa1H,IAAc,CAC/D,IAAIwE,EAAY,EAEhBrG,KAAKzC,QAAQiL,MAAMzG,eAAe4G,UAAUxI,QAAS,CAACC,EAAMI,KAC1D,MAAMwE,EAAQhF,KAAKzC,QAAQiL,MAAMc,aAAalJ,GAI9C,IAAIsJ,EAAa1J,KAAKzC,QAAQiL,MAAMxH,cAAcZ,GAAMyB,GAcxDkI,EAAQvJ,GAAOmD,IAAI+F,EAAY1H,EAAOH,GAAawE,EAAWrB,GAC9DqB,GAAaqD,IAQjBK,EAAQ5J,QAAQ6J,IACdhK,KAAK2H,QAAQlD,YAAYuF,EAAOF,UAChC9J,KAAKmI,OAAO6B,EAAOpL,KAAOoL,IAO9B,mBACE,OAAOjM,OAAOgF,QAAQ/C,KAAKmI,QAAQ5F,OAAO,EAAE3E,EAAMqM,KAAWA,EAAMC,UAAUzH,IAAI,EAAE7E,KAAUA,GAO/F,kBAAkBgF,EAAiB,EAAGC,EAAgB7C,KAAKzC,QAAQiL,MAAMvH,UAAWb,GAGlF,OAFaJ,KAAKzC,QAAQiL,MAAMO,uBAG9B,IAAK,MACH,OAAO/I,KAAKzC,QAAQiL,MAAMQ,+BAA+BpG,EAAgBA,EAAiBC,EAAe7C,KAAKmK,cAEhH,QACA,IAAK,OACH,OAAK/J,EAMEJ,KAAKzC,QAAQiL,MAAM4B,oBAAoBhK,EAAMwC,EAAgBC,EAAezC,GAL1EM,KAAK4B,OAAOtC,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAKqK,oBAAoBjK,IAAOqC,IAAIrC,GAC/FJ,KAAKzC,QAAQiL,MAAM4B,oBAAoBhK,EAAMwC,EAAgBC,MAS9E,uBACE7C,KAAKzC,QAAQiL,MAAMzG,eAAe5B,QAASvC,IACzC,MAAM0M,EAAUtK,KAAKzC,QAAQiL,MAAM+B,WAAW3M,GACxC4M,EAAUxK,KAAKzC,QAAQiL,MAAMiC,WAAW7M,GACxC0C,EAASN,KAAKzC,QAAQiL,MAAMxH,cAAcpD,GAIhD,IAAIqH,EAAKjF,KAAKH,QAAU2K,EAAUF,GAC9BvF,EAAeuF,EAAUrF,EAK7B,MAAMM,EAAO,IAAI,EAAK,CACpBT,aAAc9E,KAAKH,OACnBuF,SAAUpF,KAAKzC,QAAQiL,MAAM1H,UAC7BwB,IAAKkI,EACLxF,MAAOhF,KAAKzC,QAAQiL,MAAMc,aAAa1L,GACvCmH,eACAE,KACAC,OAAQlF,KAAK6H,YACb1C,MAAOnF,KAAKmF,QAGdI,EAAKkE,OAAO,EAAGnJ,EAAO,IAEtBA,EAAOH,QAAS,CAACuK,EAAQlK,KACT,IAAVA,EACF+E,EAAKoE,OAAOe,GAAQ,GAEpBnF,EAAKoE,OAAOe,KAIhB1K,KAAK2H,QAAQlD,YAAYc,EAAKoF,UAE9B3K,KAAKmI,OAAOvK,GAAQ2H,IAQxB,iBACEvF,KAAKzC,QAAQiL,MAAMzG,eAAe5B,QAASvC,IAIzC,MAAM0C,EAASN,KAAKzC,QAAQiL,MAAMxH,cAAcpD,GAK1CoH,EAAQhF,KAAKzC,QAAQiL,MAAMc,aAAa1L,GAKxCgN,EAAYtK,EAAO,GAEzBN,KAAKiF,GAAKjF,KAAKH,QAAUG,KAAK+H,SAAW/H,KAAKgI,UAC9ChI,KAAK+E,aAAe/E,KAAKgI,SAAWhI,KAAKiF,GAKzC,MAAMM,EAAO,IAAI,EAAK,CACpBT,aAAc9E,KAAKH,OACnByC,IAAKtC,KAAK+H,SACVpF,IAAK3C,KAAKgI,SACVhD,QACAD,aAAc/E,KAAK+E,aACnBE,GAAIjF,KAAKiF,GACTC,OAAQlF,KAAK6H,YACb1C,MAAOnF,KAAKmF,QAGdI,EAAKkE,OAAO,EAAGmB,GAEftK,EAAOH,QAAS,CAACuK,EAAQlK,KACT,IAAVA,EACF+E,EAAKoE,OAAOe,GAAQ,GAEpBnF,EAAKoE,OAAOe,KAIhB1K,KAAK2H,QAAQlD,YAAYc,EAAKoF,UAE9B3K,KAAKmI,OAAOvK,GAAQ2H,IAIxB,OAAOsF,GACL7K,KAAK2H,QAAQtD,MAAM+B,oBAAsBpG,KAAKzC,QAAQ0M,MAAMa,iBAAiBD,OAO/E,WAAWC,GACT9K,KAAK2H,QAAQtD,MAAM+B,oBAAsB0E,KACzC9K,KAAKsE,MAAQtE,KAAK8H,aAAegD,EAGnC,WACE,OAAO9K,KAAKmF,MAOd,gBAAgB4F,EAAQC,EAAQ5K,GAQ9B,IAAIkC,EAAK2C,EAAIF,EAEb,GALAiG,ECneG,SAAoBC,EAAQC,GACjC,IAAIC,EAAQzK,KAAK0K,MAAMH,IAAW,EAC9BI,EAAW3K,KAAK4K,IAAI,GAAIH,GACxBI,EAAS7K,KAAK8K,MAAMP,EAASI,GAAYA,EAW7C,OAPIJ,EAASM,EAASL,IAEpBG,EAAW3K,KAAK4K,IAAI,GAAIH,EAAQ,GAChCI,EAAS7K,KAAK8K,MAAMP,EAASI,GAAYA,GAIpCE,EDqdI,CAAmBP,GAASD,EAASC,GAAU,GAKnDhL,KAAKzC,QAAQiL,MAAM1H,UAqBjB,CACL,MAAMmJ,EAAQjK,KAAKmI,OAAO/H,GAC1BkC,EAAM2H,EAAM3H,IAKZ,IACImJ,EAAkBT,GALtB/F,EAAKgF,EAAMhF,IAMPyG,EAAQD,GALZ1G,EAAekF,EAAMlF,cAQjBkD,EALQjI,KAAKH,QAAUkL,EAASC,GAKZ/F,EAExBgF,EAAM3E,eAAiB0F,EAEvBf,EAAM1E,KAAKlB,MAAM+B,oBAAsB6B,iBAAyByD,WArChC,CAKhC,GAJApJ,EAAMtC,KAAK+H,SACX9C,EAAKjF,KAAKiF,IAGLjF,KAAK+E,eAAiBiG,EAGzB,OAFAhL,KAAKiI,UAAY3F,EAAMyI,OACvB/K,KAAK0H,QAAQrD,MAAM+B,oBAAsBpG,KAAKiI,cAIhD,IAAI0D,EAAQ3L,KAAKH,QAAUkL,EAASC,GAChCS,EAAkBT,EAAS/F,EAC3ByG,EAAQD,EAAkBzL,KAAK+E,aAEnC/E,KAAKiI,UAAY0D,EAAQ1G,EACzBjF,KAAKkI,oBAAgC,IAAVwD,EAAcD,EAAkBzL,KAAK+E,aAAgB,EAChF/E,KAAKsF,eAAiB0F,EAEtBhL,KAAK0H,QAAQrD,MAAM+B,oBAAsBpG,KAAKiI,yBAAyByD,QA0B3E,wBAAwBE,GAAkB,GACR,QAA5B5L,KAAKzC,QAAQiL,MAAM/I,KACrBO,KAAK6L,gBAAgBD,GACgB,SAA5B5L,KAAKzC,QAAQiL,MAAM/I,MAC5BO,KAAK8L,gBAAgBF,GAIzB,gBAAgBA,GAAkB,GAChC,MAAMrC,EAAcvJ,KAAKzC,QAAQiL,MAAMvH,UACjCe,EAAShC,KAAKzC,QAAQiL,MAAMgB,YAElC,IAAIuC,EAAe/L,KAAKzC,QAAQiL,MAAMwD,mBAEtC,GAAIJ,GAAmBG,EAAc,CACnC,IAAK,IAAI1O,EAAI,EAAG4O,EAAYF,EAAa7K,OAAQ7D,EAAI4O,EAAW5O,IACnC,IAAvB0O,EAAa1O,GAAG,GAClB2C,KAAKmI,OAAO4D,EAAa1O,GAAG,IAAI6O,KAAKH,EAAa1O,GAAG,GAAI0O,EAAa1O,GAAG,GAAI0O,EAAa1O,GAAG,IAAI,GAEjG2C,KAAKmI,OAAO4D,EAAa1O,GAAG,IAAI6O,KAAKH,EAAa1O,GAAG,GAAI0O,EAAa1O,GAAG,GAAI0O,EAAa1O,GAAG,IAKjG,YADA2C,KAAKzC,QAAQiL,MAAM2D,0BAIrB,IAAIrM,EAAQE,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAKqK,oBAAoBjK,IAAOuI,UAE7F,IAAK,IAAI9G,EAAa,EAAGA,EAAa0H,EAAa1H,IAAc,CAC/D,IAAIwE,EAAY,EACZ+F,EAAoBpM,KAAKmK,aAAakC,OAAQ,CAAC9L,EAAKH,IAC/CG,EAAMP,KAAKzC,QAAQiL,MAAMxH,cAAcZ,GAAMyB,GACnD,GAEH,IAAK,IAAIxE,EAAI,EAAG4O,EAAYnM,EAAMoB,OAAQ7D,EAAI4O,EAAW5O,IAAK,CAC5D,IAAIkJ,EAAWvE,EAAOH,GAAcuK,EAChC1C,EAAa1J,KAAKzC,QAAQiL,MAAMxH,cAAclB,EAAMzC,IAAIwE,GAE5D7B,KAAKzC,QAAQiL,MAAM8D,uBAAuB,CAACxM,EAAMzC,GAAIwE,EAAY0E,EAAUF,IAExD,IAAfxE,EACF7B,KAAKmI,OAAOrI,EAAMzC,IAAI6O,KAAKrK,EAAY0E,EAAUF,GAAW,GAE5DrG,KAAKmI,OAAOrI,EAAMzC,IAAI6O,KAAKrK,EAAY0E,EAAUF,GAGnDA,GAAaqD,GAIjB3L,OAAOgF,QAAQ/C,KAAKmI,QAAQ5F,OAAO,EAAEnC,EAAMwJ,KAAU5J,KAAKqK,oBAAoBjK,IAAOD,QAAQ,EAAEC,EAAMwJ,MACnGA,EAAK2C,WAQT,gBAAgBX,GAAkB,GAChC,MAAMrC,EAAcvJ,KAAKzC,QAAQiL,MAAMvH,UACjCe,EAAShC,KAAKzC,QAAQiL,MAAMgB,YAElC,IAAIuC,EAAe/L,KAAKzC,QAAQiL,MAAMwD,mBAEtC,GAAIJ,GAAmBG,EAAc,CACnC,IAAK,IAAI1O,EAAI,EAAG4O,EAAYF,EAAa7K,OAAQ7D,EAAI4O,EAAW5O,IAC9D2C,KAAKmI,OAAO4D,EAAa1O,GAAG,IAAI6O,KAAKH,EAAa1O,GAAG,GAAI0O,EAAa1O,GAAG,GAAI0O,EAAa1O,GAAG,IAI/F,YADA2C,KAAKzC,QAAQiL,MAAM2D,0BAIrB,IAAIrM,EAAQE,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAKqK,oBAAoBjK,IAAOuI,UAE7F,IAAK,IAAI9G,EAAa,EAAGA,EAAa0H,EAAa1H,IAAc,CAC/D,IAAIwE,EAAY,EAEZ+F,EAAoBpM,KAAKmK,aAAakC,OAAQ,CAAC9L,EAAKH,IAC/CG,EAAMP,KAAKzC,QAAQiL,MAAMxH,cAAcZ,GAAMyB,GACnD,GAEH,IAAK,IAAIxE,EAAI,EAAG4O,EAAYnM,EAAMoB,OAAQ7D,EAAI4O,EAAW5O,IAAK,CAC5D,IAAIkJ,EAAWvE,EAAOH,GAAcuK,EAChC1C,EAAa1J,KAAKzC,QAAQiL,MAAMxH,cAAclB,EAAMzC,IAAIwE,GAG5D7B,KAAKzC,QAAQiL,MAAM8D,uBAAuB,CAACxM,EAAMzC,GAAIwE,EAAY0E,EAAUF,IAC3ErG,KAAKmI,OAAOrI,EAAMzC,IAAI6O,KAAKrK,EAAY0E,EAAUF,GAEjDA,GAAaqD,IAKnB,oBAAoB9L,GAClB,OAAQoC,KAAKmI,OAAOvK,GAAMsM,SAG5B,qBAAqBtM,EAAMoI,GACzBhG,KAAKmI,OAAOvK,GAAM4O,iBAAiBxG,IEpnBxB,MAAM,EAKnB,YAAYzI,GACVyC,KAAKzC,QAAUA,EACfyC,KAAKyM,MAAQ,CACXvG,aAASS,EACTc,YAAQd,EAER+F,cAAU/F,EACVgG,oBAAgBhG,EAChBiG,eAAWjG,EACXkG,qBAAiBlG,EACjBmG,gBAAYnG,GAGd3G,KAAK+M,wBAAqBpG,EAC1B3G,KAAKgN,cAAgB,IACrBhN,KAAKiN,qBAAuB,IAC5BjN,KAAKkN,mBAAqB,EAC1BlN,KAAKmN,YAAc,GAKnBnN,KAAKoN,6BAA0BzG,EAK/B3G,KAAKqN,gBAAa1G,EAKlB3G,KAAKsN,sBAAmB3G,EAKxB3G,KAAKuN,iBAAkB,EAKvBvN,KAAKwN,mBAAoB,EAKzBxN,KAAKyN,oBAAqB,EAK1BzN,KAAK0N,mBAAgB/G,EAKrB3G,KAAK2N,cAAgB,EACrB3N,KAAK4N,eAAiB,EAMtB5N,KAAK6N,YAAc,KAEnB7N,KAAKqF,MAAQ,EAEbrF,KAAK8N,MAAQ,IAAI,EAAM9N,KAAKzC,QAAS,CACnC2H,OAAQ,EACR6I,SAAS,IAIb,iBACE,MAAO,CACL7H,QAAS,aACTwG,SAAU,mBACVC,eAAgB,0BAChBC,UAAW,oBACXC,gBAAiB,2BACjBC,WAAY,sBAQhB,WAwBE,OAvBA9M,KAAKyM,MAAMvG,QAAU,EAAS,MAAO,EAAQH,IAAIG,SACjDlG,KAAKyM,MAAMC,SAAW,EAAS,MAAO,EAAQ3G,IAAI2G,UAClD1M,KAAKyM,MAAMK,WAAa,EAAS,MAAO,EAAQ/G,IAAI+G,YACpD9M,KAAKyM,MAAMG,UAAY,EAAS,MAAO,EAAQ7G,IAAI6G,WACnD5M,KAAKyM,MAAME,eAAiB,EAAS,MAAO,EAAQ5G,IAAI4G,gBACxD3M,KAAKyM,MAAMI,gBAAkB,EAAS,MAAO,EAAQ9G,IAAI8G,iBAEzD7M,KAAKyM,MAAMC,SAASjI,YAAYzE,KAAKyM,MAAME,gBAC3C3M,KAAKyM,MAAMG,UAAUnI,YAAYzE,KAAKyM,MAAMI,iBAE5C7M,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMC,UAC1C1M,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMK,YAC1C9M,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMG,WAK1CoB,WAAW,KACThO,KAAK6N,YAAc7N,KAAKyM,MAAMvG,QAAQ+H,yBACrC,KAEHjO,KAAKkO,aAEElO,KAAKyM,MAAMvG,QAMpB,YACMlG,KAAKyM,MAAMhF,QACbzH,KAAKyM,MAAMhF,OAAO0G,SAGpBnO,KAAKyM,MAAMhF,OAASzH,KAAK8N,MAAMM,aAAa,CAC1C9J,MAAOtE,KAAKyM,MAAMvG,QAAQmI,YAC1BxO,OAAQG,KAAKyM,MAAMvG,QAAQoI,eAG7BtO,KAAK8N,MAAMS,eAEXvO,KAAKwO,qBAELxO,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMhF,QAO5C,mBACE,OAAOzH,KAAK+M,oBAAsB/M,KAAKyM,MAAMvG,QAAQmI,YAOvD,YACE,OAAOrO,KAAKyO,aAAezO,KAAK2N,cAAgB3N,KAAK4N,eAMvD,cAAcrN,GACZP,KAAK2N,cAAgBpN,EACrBP,KAAKyM,MAAMC,SAASrI,MAAMC,MAAQ/D,EAAM,KACxCP,KAAKyM,MAAMK,WAAWzI,MAAMqK,KAAOnO,EAAMP,KAAKmN,YAAc,KAM9D,eAAe5M,GACbP,KAAK4N,eAAiBrN,EACtBP,KAAKyM,MAAMG,UAAUvI,MAAMC,MAAQ/D,EAAM,KAO3C,UAAUjC,GACR,MAAMqQ,EAAiB3O,KAAKzC,QAAQ0M,MAAM0E,eAE1C3O,KAAK4O,UAAYD,EACjB3O,KAAK6O,WAAa7O,KAAKyO,aAAeE,EAAiBrQ,EAEvD0B,KAAKgN,cAAgB1O,EACrB0B,KAAK8O,YAAcxQ,EAGrB,gBAAgBA,GACd0B,KAAKyM,MAAMK,WAAWzI,MAAMC,MAAShG,EAAyB,EAAjB0B,KAAKmN,YAAiB,KAMrE,qBACE,IAAI4B,EAAO/O,KAAKyM,MAAMvG,QAAQ+H,wBAC9BjO,KAAK+M,mBAAqBgC,EAAKzK,MAC/BtE,KAAKsN,iBAAmByB,EAAKL,KAE7B1O,KAAKsE,MAAQtE,KAAKzC,QAAQ0M,MAAM+E,gBAEhChP,KAAKiN,qBAAuBjN,KAAKoN,wBAA0BpN,KAAKsE,MAChEtE,KAAKkN,mBAAqBlN,KAAKyO,aAAezO,KAAKiN,qBAEnDjN,KAAKiP,aAAajP,KAAKkN,oBACvBlN,KAAKkP,oBAAoBlP,KAAKkN,oBAC9BlN,KAAKzC,QAAQ0M,MAAMkF,WAOrB,oBACE,OAAOnP,KAAK2N,cAMd,2BACE,OAAO,EAMT,2BACE,OAAO3N,KAAKyO,aAAezO,KAAKiN,qBAAuBjN,KAAK4N,eAM9D,4BACE,OAAO5N,KAAKiN,qBAMd,4BACE,OAAOjN,KAAKyO,aAAezO,KAAKiN,qBAAuBjN,KAAKoP,cAO9D,aAAaC,GAEX,MAAM/K,EAAQtE,KAAKsE,MACbgL,EAAUtP,KAAKyO,aAAenK,EAC9BiL,EAAUvP,KAAKwP,qBAErB,IAAI3E,EAAU7K,KAAKkN,mBAAqBmC,EAEpCxE,EAAU0E,EACZ1E,EAAU0E,EACD1E,EAAUyE,IACnBzE,EAAUyE,GAEZtP,KAAK4O,UAAY/D,EACjB7K,KAAK6O,WAAa7O,KAAKyO,aAAezO,KAAKoN,wBAA0BvC,EAGvE,aACE,IAAI4E,GAAkB,EACtB,IACE,IAAIC,EAAO3R,OAAOC,eAAe,GAAI,UAAW,CAC9CE,IAAK,WACHuR,GAAkB,KAGtBxS,OAAO0S,iBAAiB,cAAe,KAAMD,GAC7CzS,OAAO2S,oBAAoB,cAAe,KAAMF,GAChD,MAAOG,IAGT7P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,YAAchL,IAChD3E,KAAK8P,kBAAkBnL,MACtB8K,GAAkB,CAAEM,SAAS,IAEhC9S,OAAO0S,iBAAiB,YAAchL,IACpC3E,KAAKgQ,kBAAkBrL,MACtB8K,GAAkB,CAAEM,SAAS,IAEhC9S,OAAO0S,iBAAiB,UAAYhL,IAClC3E,KAAKiQ,gBAAgBtL,MACpB8K,GAAkB,CAAEM,SAAS,IAEhC/P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,aAAehL,IACjD3E,KAAK8P,kBAAkBnL,MACtB8K,GAAkB,CAAEM,SAAS,IAEhC/P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,YAAchL,IAChD3E,KAAKgQ,kBAAkBrL,MACtB8K,GAAkB,CAAEM,SAAS,IAEhC/P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,WAAahL,IAC/C3E,KAAKiQ,gBAAgBtL,MACpB8K,GAAkB,CAAEM,SAAS,IAOlC,kBAAkBpL,GAChB,MAAM,OAACuL,GAAUvL,EAIX6I,IAAsB0C,EAAOC,YAAY,EAAQpK,IAAI4G,kBACrDc,IAAuByC,EAAOC,YAAY,EAAQpK,IAAI8G,mBAK5D,GAHA7M,KAAKoN,wBAA0BpN,KAAKsE,MACpCtE,KAAKqN,WAAa,EAAe1I,GAE7B6I,GAAqBC,EAIvB,OAHAzN,KAAKwN,kBAAoBA,EACzBxN,KAAKyN,mBAAqBA,OAC1BzN,KAAKuN,iBAAkB,GAKzBvN,KAAKuN,iBAAkB,EAOzB,kBAAkB5I,GACZ3E,KAAKuN,gBACPvN,KAAKoQ,gBAAgBzL,GACZ3E,KAAKwN,kBACdxN,KAAKqQ,cAAc1L,EAAO,QACjB3E,KAAKyN,oBACdzN,KAAKqQ,cAAc1L,EAAO,SAI9B,kBACM3E,KAAKuN,gBACPvN,KAAKsQ,gBACItQ,KAAKwN,kBACdxN,KAAKuQ,oBACIvQ,KAAKyN,oBACdzN,KAAKwQ,qBAIT,gBACExQ,KAAKuN,iBAAkB,EACvBvN,KAAKkN,mBAAqBlN,KAAKoP,cAyBjC,oBACEpP,KAAKwN,mBAAoB,EACzBxN,KAAKkN,mBAAqBlN,KAAKoP,cAGjC,qBACEpP,KAAKyN,oBAAqB,EAC1BzN,KAAKkN,mBAAqBlN,KAAKoP,cAMjC,gBAAgBzK,GACd,IAAI8L,EAAQ,EAAe9L,GAAS3E,KAAKqN,WAIjBrN,KAAKoP,cAG7BpP,KAAKiP,aAAawB,GAIlBzQ,KAAKkP,sBAEDlP,KAAK0Q,OACPC,aAAa3Q,KAAK0Q,OAGpB1Q,KAAK0Q,MAAQ1C,WAAW,KACtBhO,KAAKzC,QAAQ0M,MAAMkF,UAAS,IAC3B,IAQL,oBAAoByB,EAAY,KAAMC,GAAY,GAMhD,MACMC,GAFe3J,MAAM4J,SAASH,IAA0B5Q,KAAKoP,cAAjBwB,GACH5Q,KAAKyO,aACPzO,KAAKzC,QAAQ0M,MAAM3F,MAEhEtE,KAAKzC,QAAQ0M,MAAM+G,OAAOF,EAAaD,GAQzC,cAAclM,EAAOsM,GACnB,IAeIC,EAfArM,EAAQ,EAAeF,GACvB8L,EAAQ5L,EAAQ7E,KAAKqN,WAErB8D,EAAYnR,KAAKqF,MAAQR,EAAQ,QAAU,OAE/C,GAAIA,EAAQ7E,KAAK6N,YAAYuD,OAASvM,EAAQ7E,KAAK6N,YAAYa,KAC7D,OAGF,IAAK+B,GAASzQ,KAAKqF,QAAUR,EAC3B,OAOF,GAJA7E,KAAKqF,MAAQR,EAAQ,EAIR,SAAToM,EAAgB,CAIlB,GAHAR,IAAiB,GACjBS,EAAiBxQ,KAAK4B,IAAI,EAAGtC,KAAKkN,mBAAqBuD,IAElCzQ,KAAKqR,qBACxB,OAGFrR,KAAK4O,UAAYsC,EAEjBlR,KAAK8O,YAAe9O,KAAKyO,aAAeyC,EAAiBlR,KAAK4N,mBAEzD,CAGL,IAFAsD,EAAiBxQ,KAAK4B,IAAI,EAAGtC,KAAKyO,aAAezO,KAAKkN,oBAAsBlN,KAAKoN,wBAA0BqD,KAEtFzQ,KAAKsR,sBACxB,OAGFtR,KAAK6O,WAAaqC,EAClBlR,KAAK8O,YAAe9O,KAAKyO,aAAeyC,EAAiBlR,KAAK2N,cAGhE,MAAM4D,EAA4B,SAATN,EACvBjR,KAAKyO,aAAeyC,EAAiBlR,KAAK4N,eAC1C5N,KAAKyO,aAAezO,KAAK2N,cAAgBuD,EAErCpG,EAAU9K,KAAKiN,qBAAuBsE,EAAmBvR,KAAKzC,QAAQ0M,MAAMuH,aAElFxR,KAAKzC,QAAQ0M,MAAMwH,MAAM3G,EAASqG,GAClCnR,KAAKkP,oBAA6B,SAAT+B,EAAkBC,EAAiBlR,KAAK2N,eAAe,GAE5E3N,KAAK0Q,OACPC,aAAa3Q,KAAK0Q,OAGpB1Q,KAAK0Q,MAAQ1C,WAAW,KACtBhO,KAAKzC,QAAQ0M,MAAMkF,YAClB,IAOL,WAAWvR,EAAMoI,GACfhG,KAAK8N,MAAM4D,qBAAqB9T,EAAMoI,GAEN,QAA5BhG,KAAKzC,QAAQiL,MAAM/I,MACrBO,KAAK8N,MAAM6D,yBAAwB,GACnC3R,KAAKmP,YACgC,SAA5BnP,KAAKzC,QAAQiL,MAAM/I,KAC5BO,KAAK8N,MAAM6D,yBAAwB,GAEnC3R,KAAKmP,WAOT,WACkC,SAA5BnP,KAAKzC,QAAQiL,MAAM/I,OAChBO,KAAKzC,QAAQiL,MAAM1H,UAGtBd,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAKzC,QAAQ0M,MAAM2H,eAAexR,IAAOD,QAASC,IACjGJ,KAAK8N,MAAM+D,gBAAgB7R,KAAK8N,MAAMgE,kBAAkB1R,QAAOuG,EAAWvG,KAH5EJ,KAAK8N,MAAM+D,gBAAgB7R,KAAK8N,MAAMgE,uBCrhB/B,MAAM,EAInB,YAAYvU,GACVyC,KAAKzC,QAAUA,EACfyC,KAAKyM,MAAQ,CACXvG,aAAUS,EACVjH,WAAOiH,EACPrG,YAAQqG,GAGV3G,KAAKoI,OAAS,EACdpI,KAAK+R,QAAU,GAOjB,iBACE,MAAO,CACL7L,QAAS,aACT8L,OAAQ,qBACRtS,MAAO,oBACPY,OAAQ,qBACRhC,MAAO,0BACP2T,WAAY,iCAIhB,SAQE,OAPAjS,KAAKyM,MAAMvG,QAAU,EAAS,MAAO,EAAQH,IAAIG,SACjDlG,KAAKyM,MAAM/M,MAAQ,EAAS,MAAO,EAAQqG,IAAIrG,OAC/CM,KAAKyM,MAAMnM,OAAS,EAAS,MAAO,EAAQyF,IAAIzF,QAEhDN,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAM/M,OAC1CM,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMnM,QAEnCN,KAAKyM,MAAMvG,QAGpB,OACElG,KAAKyM,MAAMvG,QAAQxC,UAAUC,IAAI,EAAQoC,IAAIiM,QAG/C,OACEhS,KAAKyM,MAAMvG,QAAQxC,UAAUyK,OAAO,EAAQpI,IAAIiM,QAGlD,KAAKE,EAAe5R,GACbN,KAAKoI,SACRpI,KAAKoI,OAASpI,KAAKyM,MAAMvG,QAAQmI,aAGnC,IAIIK,EAAOwD,GADO,GAHRxR,KAAK4B,OAAOhC,EAAOmC,IAAInE,GAASA,EAAMA,QAC1B0B,KAAKzC,QAAQ0M,MAAM6D,MAAM7I,GAAKjF,KAAKzC,QAAQ0M,MAAM6D,MAAM/I,aAK7D,MACd2J,GAAc1O,KAAKoI,QAGjBsG,EAAO1O,KAAKoI,OAAS,KACvBsG,EAAOwD,EAAgB,IAGrBxD,EAAO1O,KAAKoI,OAASpI,KAAKzC,QAAQ0M,MAAM+C,gBAC1C0B,GAAc1O,KAAKoI,QAiBrBpI,KAAKyM,MAAMvG,QAAQ7B,MAAMqK,QAAUA,MAGrC,QACE1O,KAAKyM,MAAM/M,MAAM6E,YAAc,GAC/BvE,KAAKyM,MAAMnM,OAAOkE,UAAY,GAOhC,WAAWlE,GACTN,KAAKmS,QAEL,MAAMC,EAAapS,KAAK+R,QAExB/R,KAAK+R,QAAU,GAEX/R,KAAKqS,oBACP1B,aAAa3Q,KAAKqS,oBAGpB,IAAIC,EAAO,EAEX,IAAK,IAAIjV,EAAI,EAAG4O,EAAY3L,EAAOY,OAAQ7D,EAAI4O,EAAW5O,IACxDiV,GAAQhS,EAAOjD,GAAGiB,MAGhBgC,EAAOY,OAAS,EAClBlB,KAAKqS,mBAAqBrE,WAAW,KACnC1N,EAAOH,QAAS,EAAEvC,OAAMU,SAAQkC,KAC9BR,KAAKuS,WAAWvS,KAAKzC,QAAQiL,MAAM3H,MAAMjD,GAAOoC,KAAKzC,QAAQiL,MAAMjJ,OAAO3B,GAAOU,EAAO8T,EAAW5R,GAAQA,EAAOF,KAGpF,QAA5BN,KAAKzC,QAAQiL,MAAM/I,MAAkBa,EAAOY,OAAS,GACvDlB,KAAKuS,WAAW,MAAO,OAAQD,EAAM,KAAMhS,EAAOY,OAAQZ,GAAQ,IAEnE,MAGDA,EAAOH,QAAS,EAAEvC,OAAMU,SAAQkC,KAC9BR,KAAKuS,WAAWvS,KAAKzC,QAAQiL,MAAM3H,MAAMjD,GAAOoC,KAAKzC,QAAQiL,MAAMjJ,OAAO3B,GAAOU,EAAO8T,EAAW5R,GAAQA,EAAOF,KAGpF,QAA5BN,KAAKzC,QAAQiL,MAAM/I,MAAkBa,EAAOY,OAAS,GACvDlB,KAAKuS,WAAW,MAAO,OAAQD,EAAM,KAAMhS,EAAOY,OAAQZ,GAAQ,IAO1E,WAAWZ,EAAOsF,EAAO1G,EAAO+H,EAAW7F,EAAQ,EAAGgS,EAAKC,GAAO,GAChE,MAAMC,EAAO,EAAS,MAAO,EAAQ3M,IAAIzH,OACnCqU,EAAU,EAAS,KAMzB,GAJIF,GACFC,EAAKhP,UAAUC,IAAI,OAGW,SAA5B3D,KAAKzC,QAAQiL,MAAM/I,KAAgB,CACrC,IAAIoH,EAAQ2L,EAAInG,OAAO,CAACuG,EAAKxO,IAAQwO,GAAOxO,EAAI9F,MAAO,GACnDuU,EAAUnS,KAAKoS,KAAMxU,EAAQuI,EAAS,KAKtCM,MAAM0L,KACRA,EAAU,GAGZ,IAAIE,EAAY,EAAS,OAAQ,YAEjCA,EAAUxO,YAAcsO,EAAU,IAElCH,EAAKjO,YAAYsO,GAGnB,IAAIC,EAAU,EAAS,OAAQ,EAAQjN,IAAIkM,YAE3Ce,EAAQzO,YAAc7E,EAEtBgT,EAAKjO,YAAYuO,GACjBN,EAAKjO,YAAYkO,GAEjBA,EAAQtO,MAAMW,MAAQA,EAEtB,IAAIiO,GF9HkBhI,EE8HkB3M,EF7HtC6I,MAAM4J,SAAS9F,EAAQ,KAClB,GAGFA,EAAOiI,WAAWC,QAAQ,wBAAyB,MALrD,IAAmBlI,EEgItB+C,WAAW,KACT,EAAmB2E,EAASM,EAAiB5M,IAC5C,GAAK7F,GAGRR,KAAKyM,MAAMnM,OAAOmE,YAAYiO,GAC9B1S,KAAK+R,QAAQnR,KAAKqS,GAGpB,UAAUG,GACRpT,KAAKyM,MAAM/M,MAAM8E,UAAY4O,EAM/B,SAASC,GACP,MAAMC,EAAS,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OACvFC,EAAO,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OACxD,IAAIC,EAAQH,EAAGI,WACXC,EAAOL,EAAGM,cACVC,EAAUP,EAAGQ,SACbC,EAAMT,EAAGU,UACTrF,EAAO,EAAS,OAAQ,QACxB0C,EAAQ,EAAS,QAEjB4C,EAAU,GAEThU,KAAKzC,QAAQiL,MAAM7I,SAItBqU,EAAUV,EAAOE,GAAS,IAC1BpC,EAAM7M,YAAcmP,IAJpBM,KAAeT,EAAKK,OAAaE,IACjC1C,EAAM7M,YAAc+O,EAAOE,GAAS,IAAME,GAM5C1T,KAAKyM,MAAM/M,MAAM8E,UAAY,GAC7BxE,KAAKyM,MAAM/M,MAAM+E,YAAYiK,GAC7B1O,KAAKyM,MAAM/M,MAAM+E,YAAY2M,GAI7B,EAAmB1C,EAAMsF,EAAShU,KAAKiU,UAAW,OAClDjU,KAAKiU,UAAYD,GC1NN,MAAM,EACnB,YAAYzW,GACVyC,KAAKzC,QAAUA,EACfyC,KAAKyM,MAAQ,CACXvG,aAASS,GAEX3G,KAAKkU,SAAW,GAQlB,iBACE,MAAO,CACLhO,QAAS,aACT8L,OAAQ,qBACRmC,QAAS,sBACTC,cAAe,+BAInB,SAGE,OAFApU,KAAKyM,MAAMvG,QAAU,EAAS,MAAO,EAAQH,IAAIG,SACjDlG,KAAKyM,MAAMvG,QAAQ7B,MAAMxE,UAAYG,KAAKzC,QAAQiL,MAAM3I,WACjDG,KAAKyM,MAAMvG,QAGpB,OACElG,KAAKyM,MAAMvG,QAAQxC,UAAUC,IAAI,EAAQoC,IAAIiM,QAG/C,OACEhS,KAAKyM,MAAMvG,QAAQxC,UAAUyK,OAAO,EAAQpI,IAAIiM,QAGlD,KAAKqC,GACHrU,KAAKsU,OACLtU,KAAKyM,MAAMvG,QAAQ7B,MAAMqK,QAAU2F,MAGrC,iBAAiBzW,GACXoC,KAAKkU,SAAStW,IAChBoC,KAAKkU,SAAStW,GAAM8F,UAAUuC,OAAO,EAAQF,IAAIqO,eAQrD,WAAW9T,GACT,GAAgC,SAA5BN,KAAKzC,QAAQiL,MAAM/I,KAQrB,YAPI1B,OAAOqD,KAAKpB,KAAKkU,UAAUhT,SAC7BnD,OAAOuC,OAAON,KAAKkU,UAAU/T,QAASiD,IACpCA,EAAG+K,WAGLnO,KAAKkU,SAAW,KAKfnW,OAAOqD,KAAKpB,KAAKkU,UAAUhT,QAC9BZ,EAAOH,QAAS,EAAEvC,WAChB,MAAM8U,EAAO,EAAS,MAAO,EAAQ3M,IAAIoO,SAEzCzB,EAAKrO,MAAMkQ,YAAcvU,KAAKzC,QAAQiL,MAAMjJ,OAAO3B,GACnDoC,KAAKyM,MAAMvG,QAAQzB,YAAYiO,GAC/B1S,KAAKkU,SAAStW,GAAQ8U,IAO1B,MAAM,MAAC5E,GAAS9N,KAAKzC,QAAQ0M,MAE7B3J,EAAOH,QAAS,EAAEvC,OAAMU,YACtB,MAAMoU,EAAO1S,KAAKkU,SAAStW,GAGrB4W,GADgBlW,EADFwP,EAAMxI,gBAEIwI,EAAM2G,SAGpC/B,EAAKrO,MAAM+B,yBAA2BoO,UC1E7B,MAAM,EAInB,YAAYjX,GACVyC,KAAKzC,QAAUA,EACfyC,KAAKyM,MAAQ,CACXvG,aAASS,EACT+N,cAAU/N,EACVc,YAAQd,EACRgO,gBAAYhO,EACZiO,UAAMjO,EACNkO,UAAW,GACXC,YAAQnO,EACRoO,YAAa,GACbC,cAAUrO,EACVsO,iBAAatO,EACbuO,kBAAcvO,GAIhB3G,KAAKmV,QAAU,IAAI,EAAQnV,KAAKzC,SAChCyC,KAAKmU,QAAU,IAAI,EAAQnU,KAAKzC,SAChCyC,KAAK8N,MAAQ,IAAI,EAAM9N,KAAKzC,QAAS,CACnC2H,OAAQ,IAGVlF,KAAKsN,sBAAmB3G,EACxB3G,KAAK8K,QAAU,EACf9K,KAAKoV,YAAc,EAInBpV,KAAKqV,gBAAkB,GACvBrV,KAAKsV,uBAAyB,GAC9BtV,KAAKuV,sBAAwB,EAC7BvV,KAAKwV,0BAA2B,EAOhCxV,KAAKyV,cAAgB,IAAIC,IACzB1V,KAAK2V,sBAAwB,GAC7B3V,KAAK4V,4BAAyBjP,EAC9B3G,KAAK6V,4BAAyBlP,EAM9B3G,KAAK8V,MAAQ,GAEb9V,KAAK+V,mBAAgBpP,EACrB3G,KAAKgW,kBAAerP,EACpB3G,KAAKiW,wBAAqBtP,EAG5B,kBAIE,OAHK3G,KAAKgW,eACRhW,KAAKgW,aAAehW,KAAKsE,OAAStE,KAAKzC,QAAQiL,MAAMvH,UAAY,IAE5DjB,KAAKgW,aAGd,sBACE,OAAOtV,KAAK4B,IAAI,GAAmE,EAA/D5B,KAAKoS,KAAK9S,KAAKgN,cAAgBhN,KAAKzC,QAAQiL,MAAMvH,YAGxE,mBACE,OAAOjB,KAAK+V,cAMd,yBAKE,MAAMG,EAAuBlW,KAAKgN,cAAgBhN,KAAKsE,MACjD6R,EAAgBnW,KAAKgN,cAAgBkJ,EACrCE,EAAsBpW,KAAKgP,gBAAkBmH,EAE7CE,EAAwBrW,KAAK8K,QAAUsL,EAE7CpW,KAAKwR,aAAe6E,EAKtB,iBAAiB/X,GACf0B,KAAK+V,cAAgBzX,EACrB0B,KAAKyR,MAAMnT,GAOb,iBACE,MAAO,CACL4H,QAAS,WACTwO,SAAU,qBACVE,KAAM,UACN0B,YAAa,mBACbC,kBAAmB,2BACnBC,YAAa,mBACbC,kBAAmB,2BACnBC,iBAAkB,0BAClBC,kBAAmB,2BACnBC,WAAY,0BACZ5B,SAAU,qBACVC,YAAa,yBACbC,aAAc,2BAIlB,YACE,OAAOlV,KAAK8N,MAAM3I,MAGpB,YACE,OAAOnF,KAAK8N,MAAMlG,MAGpB,eACE,OAAO5H,KAAK8N,MAAM/F,SAGpB,aACE,OAAO/H,KAAK8N,MAAMjO,OAOpB,YACE,OAAOG,KAAK8N,MAAMxJ,MAOpB,qBACE,OAAOtE,KAAKoV,YAAcpV,KAAK8K,QAOjC,oBACE,OAAI9K,KAAK8V,MAAM9I,cACNhN,KAAK8V,MAAM9I,eAGpBhN,KAAK8V,MAAM9I,cAAgBhN,KAAKyM,MAAMvG,QAAQmI,YACvCrO,KAAK8V,MAAM9I,eAOpB,qBACE,OAAIhN,KAAK8V,MAAMe,eACN7W,KAAK8V,MAAMe,gBAGpB7W,KAAK8V,MAAMe,eAAiB7W,KAAKyM,MAAMvG,QAAQoI,aACxCtO,KAAK8V,MAAMe,gBAOpB,WAaE,OAZA7W,KAAKyM,MAAMvG,QAAU,EAAS,MAAO,EAAMH,IAAIG,SAC/ClG,KAAKyM,MAAMiI,SAAW,EAAS,MAAO,EAAM3O,IAAI2O,UAChD1U,KAAKyM,MAAMkI,WAAa3U,KAAKmU,QAAQxJ,SAErC3K,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMiI,UAC1C1U,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMkI,YAC1C3U,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKmV,QAAQxK,UAE5C3K,KAAKyM,MAAMvG,QAAQxC,UAAUC,IAAI,EAAMoC,IAAIG,QAAU,KAAOlG,KAAKzC,QAAQiL,MAAM/I,MAE/EO,KAAKkO,aAEElO,KAAKyM,MAAMvG,QAMpB,eACElG,KAAK8W,yBAED9W,KAAKyM,MAAMhF,QACbzH,KAAKyM,MAAMhF,OAAO0G,SAMpBnO,KAAKyM,MAAMhF,OAASzH,KAAK8N,MAAMM,aAAa,CAC1C9J,MAAOtE,KAAKyM,MAAMiI,SAASrG,YAC3BxO,OAAQG,KAAKzC,QAAQiL,MAAM3I,SAE7BG,KAAKyM,MAAMiI,SAASjQ,YAAYzE,KAAKyM,MAAMhF,QAK3CzH,KAAK+W,yBAIL/W,KAAK8N,MAAMS,eACXvO,KAAKgX,aACLhX,KAAKiX,eACLjX,KAAKkX,iBAGP,aACE,MAAM9W,EAAO,EAAS,MAAO,EAAM2F,IAAIuQ,aAIvC,OAHAtW,KAAKyM,MAAMmI,KAAKnQ,YAAYrE,GAC5BJ,KAAKyM,MAAMoI,UAAUjU,KAAKR,GAEnBA,EAGT,cAAckC,EAAKK,EAAKwU,EAAYlS,EAAImS,GACtC,IAAIC,EAAW/U,EAAMK,EACjBkG,EAAOwO,EAAWF,EAClBG,EAAW5W,KAAK0K,MAAMiM,IAAa,EACnChM,EAAW3K,KAAK4K,IAAI,GAAIgM,GAAY,EAIpCC,GAFJ1O,EAAOnI,KAAKoS,KAAKjK,EAAOwC,GAAYA,GAER8L,EAAalS,EAMzC,OAJIsS,EAAiBvX,KAAKH,SACxBgJ,GAAe0O,EAAiBvX,KAAKH,QAAU,GAG1CgJ,EAGT,iBAAiBvK,EAAOV,EAAM4Z,GAC5B,IAAI7E,EAAU,EAAS,OAAQ,EAAM5M,IAAIyQ,aACrCiB,EJ1PD,SAAkBxM,GACvB,GAAIA,EAAS,IACX,OAAOA,EACF,GAAIA,EAAS,IAAM,CACtB,IAAIyM,EAAYhX,KAAK8K,MAAMP,EAAS,KAChCyD,EAAOzD,EAAqB,IAAZyM,EAEpB,OAAa,IAAThJ,EACKgJ,EAAY,OACVhJ,GAAQ,IACVgJ,EAAY,IAAMhJ,EAElBgJ,EAAY,KAAOhJ,EAIzB,OAAIzD,EAAS,IACTvK,KAAK8K,MAAMP,EAAS,KAAQ,IAE9BvK,KAAK8K,MAAMP,EAAS,KAAW,IIuO3B,CAAiBvK,KAAKC,MAAMrC,IAevC,MAbgC,SAA5B0B,KAAKzC,QAAQiL,MAAM/I,OACrBgY,GAAQ,KAGV9E,EAAQpO,YAAckT,EACtB9E,EAAQgF,QAAQ/Z,KAAOA,EAEnB4Z,EACF7E,EAAQjP,UAAUC,IAAI,EAAMoC,IAAI4Q,mBAEhChE,EAAQjP,UAAUC,IAAI,EAAMoC,IAAI2Q,kBAG3B/D,EAMT,aV/PK,IAAsBzC,EAAQ0H,EUgQ5B5X,KAAKyM,MAAMmI,OACd5U,KAAKyM,MAAMmI,KAAO,EAAS,MAAO,EAAM7O,IAAI6O,MAC5C5U,KAAKyM,MAAMmI,KAAKvQ,MAAMxE,UAAYG,KAAKzC,QAAQiL,MAAM3I,WACrDG,KAAKyM,MAAMoI,UAAY,GVnQA3E,EUoQNlQ,KAAKyM,MAAMhF,OVpQGmQ,EUoQK5X,KAAKyM,MAAMmI,KVnQnD1E,EAAO2H,WAAWC,aAAaF,EAAS1H,IUsQtC,IAOI6H,EAAaC,EAAUC,EAAWC,EAPlCrY,EAASG,KAAKH,OACdyC,EAAMtC,KAAKmY,qBACXxV,EAAO3C,KAAKzC,QAAQiL,MAAM1H,UAA6Cd,KAAK8N,MAAM3F,OAAO,GAAK7C,eAAxDtF,KAAK8N,MAAMxI,gBAAkB,EACnEL,EAAKpF,GAAUyC,EAAMK,GACrByV,EAAa,EACbxQ,EAAQ5H,KAAKqY,cAAc/V,EAAKK,EAAKyV,EAAYnT,GAIrD,GAAIjF,KAAKzC,QAAQiL,MAAM1H,UAAU,CAK/B,IAAIsW,EAAUnS,GADd+S,EAAWnY,IAHXoY,EAAYjY,KAAKmY,mBAAmB,OACpCD,EAAYlY,KAAKsY,mBAAmB,QAKpCP,EAAc/X,KAAKqY,cAAcJ,EAAWC,EAAWE,EAAYJ,EAAUZ,GAG/C,SAA5BpX,KAAKzC,QAAQiL,MAAM/I,OACrBmI,EAAQ,GACRwQ,EAAa,EAEbnT,EAAKpF,GADLyC,EAAM,MAIJtC,KAAKyM,MAAMoI,UAAU3T,QACvBlB,KAAKyM,MAAMoI,UAAU1U,QAASC,IAC5BA,EAAKsD,UAAUC,IAAI,EAAMoC,IAAIwQ,qBAIjC,IAAK,IAAIgC,EAAI,EAAGA,GAAKH,EAAYG,IAAK,CACpC,IACInY,EADAwF,EAAI2S,EAAI3Q,EAeZ,GAXExH,EADEJ,KAAKyM,MAAMoI,UAAU3T,QAAUlB,KAAKyM,MAAMoI,UAAU0D,GAC/CvY,KAAKyM,MAAMoI,UAAU0D,GAErBvY,KAAKwY,aAGJ,IAAND,GACFnY,EAAKsD,UAAUC,IAAI,gBAGRiC,EAAIX,EAEJjF,KAAKH,OAChB,SAGFO,EAAKsD,UAAUyK,OAAO,EAAMpI,IAAIwQ,mBAChCnW,EAAKiE,MAAMoU,UAAY7S,EAAIX,MAE3B7E,EAAKoE,UAAY,GAGjB,IAAImO,EAAU3S,KAAK0Y,iBAAiB9S,EAAIjD,EAAK,KAG7C,GAFAvC,EAAKqE,YAAYkO,GAEboF,EAAY,CACdpF,EAAQtO,MAAMW,MAAQhF,KAAKzC,QAAQiL,MAAMc,aAAa,KACtD,IACIqP,EAAW3Y,KAAK0Y,iBAAkBH,EAAIR,EAAcG,EAAY,KAAK,GACzES,EAAStU,MAAMW,MAAQhF,KAAKzC,QAAQiL,MAAMc,aAAa,KACvDlJ,EAAKqE,YAAYkU,IAIjB3Y,KAAKzC,QAAQiL,MAAM1H,WACrBd,KAAK4Y,2BAST,wBAAwBC,GACtB,IAAIC,EAAepY,KAAKC,OAAQX,KAAK+Y,oBAAsB/Y,KAAKgZ,eAAmBhZ,KAAK6V,wBAA0B7V,KAAK6V,wBACnHoD,EAAS,GAEb,IAAK,IAAI5b,EAAI,EAAGA,EAAIyb,EAAe,EAAGzb,IAAI,CACxC,IACI6b,GADaL,EAAgBxb,EAAI2C,KAAK6V,yBACc,EAA9B7V,KAAK6V,uBAA6BxY,IAAO,EACnE4b,EAAOrY,KAAKsY,GAGd,OAAOD,EAAOE,KAAKD,KAAWA,GAGhC,SAASL,GACP,IAAIO,EAASpZ,KAAK2V,sBAAsBkD,GACpCQ,EAAY,mBACZC,EAAOT,EAAgB7Y,KAAKuZ,WAAavZ,KAAKoV,YAE5B,IAAlByD,IACFQ,EAAY,IAGVR,IAAkB7Y,KAAKzC,QAAQiL,MAAMvH,UAAY,IACnDoY,EAAY,qBAGdD,EAAO/U,MAAM+B,wBAA2BkT,OAAaD,EAEjDrZ,KAAKwZ,wBAAwBX,GAC/BO,EAAO1V,UAAUC,IAAI,SAErByV,EAAO1V,UAAUyK,OAAO,SAK5B,SAAS9N,EAAMoZ,EAAaC,GAC1B,GAAI1Z,KAAKwZ,wBAAwBC,GAC/B,OAGF,MAAMpG,EAAK,IAAIsG,KAAKtZ,GACd+Y,EAAS,EAAS,QAEpBpZ,KAAKzC,QAAQiL,MAAM7I,QACrByZ,EAAO7U,YAAc8O,EAAGuG,mBAAmB,QAAS,CAClDpG,MAAO,UAGT4F,EAAO7U,YAAc8O,EAAGuG,mBAAmB,QAAS,CAClD9F,IAAK,UACLN,MAAO,UAMXxT,KAAKyM,MAAMqI,OAAOrQ,YAAY2U,GAC9BpZ,KAAKyM,MAAMsI,YAAYnU,KAAKwY,GAC5BpZ,KAAKyV,cAAc9R,IAAI8V,GACvBzZ,KAAK2V,sBAAsB8D,GAAeL,EAC1CpZ,KAAK6Z,SAASJ,GAGhB,0BACE,OAAO/Y,KAAK8K,MAAMxL,KAAKgN,cAAgBhN,KAAKuZ,YAe9C,sBACE,OAAOvZ,KAAK4C,eAAiB5C,KAAK+Y,oBAGpC,qBAIE,OAHK/Y,KAAK4V,yBACR5V,KAAK4V,uBAAyBlV,KAAK8K,MAAMxL,KAAKgN,eAAiBhN,KAAKqV,gBAAkBrV,KAAKsV,0BAEtFtV,KAAK4V,uBAGd,iBACE,OAAO5V,KAAKmF,MAAQnF,KAAK8K,QAG3B,mBAIE,IAAIgP,EAAqB9Z,KAAKzC,QAAQiL,MAAMtI,MAAMuB,MAAMzB,KAAK4C,eAAgB5C,KAAK+Z,gBAAkB,GAChGC,EAAuB,IAAItE,IAE/B,IAAK1V,KAAK6V,uBAAuB,CAC/B,IAAIoE,EAAiBja,KAAK+Z,gBAAkB/Z,KAAK4C,eACjD5C,KAAK6V,uBAAyBnV,KAAKoS,KAAKmH,EAAiBja,KAAKgZ,gBAGhE,IAAIU,EAAe,EAEnBI,EAAmB3Z,QAAQ,CAACE,EAAMG,KAChC,MAAMiZ,EAAczZ,KAAK4C,eAAiBpC,EAM1C,GAAIiZ,EAAczZ,KAAK6V,wBAA2B,EAAlD,CAYA,GALAmE,EAAqBrW,IAAI8V,GAKrBzZ,KAAKyV,cAAcyE,IAAIT,GAGzB,OAFAzZ,KAAK6Z,SAASJ,QACdC,IAOF1Z,KAAKma,SAAS9Z,EAAMoZ,EAAaC,GACjCA,OAMF1Z,KAAKyV,cAActV,QAAS0Y,IACrBmB,EAAqBE,IAAIrB,IAC5B7Y,KAAKoa,WAAWvB,KAKtB,WAAWA,GACJ7Y,KAAK2V,sBAAsBkD,KAIhC7Y,KAAKyV,cAAcoD,GAAiB,KACpC7Y,KAAKyV,cAAc4E,OAAOxB,GAC1B7Y,KAAK2V,sBAAsBkD,GAAe1K,SAC1CnO,KAAK2V,sBAAsBkD,GAAiB,MAO9C,eVpgBK,IAAqB3I,EAAQ0H,EUqgBhC5X,KAAKyM,MAAMqI,OAAS,EAAS,UVrgBL5E,EUygBRlQ,KAAKyM,MAAMhF,OVzgBKmQ,EUygBG5X,KAAKyM,MAAMqI,OVxgBhD5E,EAAO2H,WAAWC,aAAaF,EAAS1H,EAAOoK,aU+gB/C,OAAOC,EAAU1J,GACf7Q,KAAKoV,aAA0B,EAAZmF,EACnBva,KAAK8N,MAAMkD,OAAOhR,KAAKoV,aACvBpV,KAAKmV,QAAQqF,OACbxa,KAAKmU,QAAQqG,OACbxa,KAAKya,sBACLza,KAAK0a,mBAED1a,KAAK2a,KACPhK,aAAa3Q,KAAK2a,KAGpB3a,KAAK2a,IAAM3M,WAAW,KACpB,MAAM4M,EAAY5a,KAAKzC,QAAQiL,MAAMtI,MAAMF,KAAK+Z,kBAAoB/Z,KAAKzC,QAAQiL,MAAMtI,MAAMF,KAAK+Z,gBAAkB,GAEpH/Z,KAAKzC,QAAQsd,OAAOC,UAAU9a,KAAKzC,QAAQiL,MAAMtI,MAAMF,KAAK4C,gBAAiBgY,IAC5E,IAOL,MAAM9P,EAASqG,GACbnR,KAAK8N,MAAMiN,WAAWjQ,EAASqG,GAE/BnR,KAAK8K,QAAUA,EAOjB,qBACE,OAAOpK,KAAKoS,MAAyB,EAApB9S,KAAKoV,YAAkBpV,KAAK8N,MAAMjF,KAAO7I,KAAK8K,SAQjE,eAAe1K,GACb,OAAOJ,KAAK8N,MAAMzD,oBAAoBjK,GAGxC,oBACE,MAAM+E,EAAQnF,KAAK8N,MAAMjF,KACzB,OAAOnI,KAAKC,MAAMX,KAAKgN,cAAgB7H,EAAQnF,KAAK8K,SAOtD,mBAAmB1K,GACjB,OAAOJ,KAAK8N,MAAMgE,kBAAkB9R,KAAK4C,eAAgB5C,KAAK6C,cAAgB,EAAGzC,GAOnF,mBAAmBA,GACjB,MAAM4a,EAAmBta,KAAK4B,IAAI,EAAGtC,KAAK4C,eAAgB,GAE1D,OAAKxC,EAMEJ,KAAKzC,QAAQiL,MAAMyS,oBAAoB7a,EAAM4a,EAAmBhb,KAAK6C,cAAgB,GALnFnC,KAAKiC,OAAO3C,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAK4R,eAAexR,IAAOqC,IAAIrC,GAC1FJ,KAAKzC,QAAQiL,MAAMyS,oBAAoB7a,EAAM4a,EAAkBhb,KAAK6C,cAAgB,KAUjG,WACkC,SAA5B7C,KAAKzC,QAAQiL,MAAM/I,OAChBO,KAAKzC,QAAQiL,MAAM1H,UAGtBd,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAK4R,eAAexR,IAAOD,QAASC,IACnFJ,KAAK8N,MAAM+D,gBAAgB7R,KAAKmY,mBAAmB/X,GAAOJ,KAAKsY,mBAAmBlY,GAAOA,KAH3FJ,KAAK8N,MAAM+D,gBAAgB7R,KAAKmY,qBAAsBnY,KAAKsY,uBAW3DtY,KAAKyM,MAAMmI,OAET5U,KAAKkb,KACPvK,aAAa3Q,KAAKkb,KAGpBlb,KAAKkb,IAAMlN,WAAW,KACpBhO,KAAKgX,cACJ,KAOP,yBACE,IAAIjI,EAAO/O,KAAKyM,MAAMvG,QAAQ+H,wBAE9BjO,KAAKsN,iBAAmByB,EAAKL,KAG/B,aACE,IAAIe,GAAkB,EACtB,IACE,IAAIC,EAAO3R,OAAOC,eAAe,GAAI,UAAW,CAC9CE,IAAK,WACHuR,GAAkB,KAGtBxS,OAAO0S,iBAAiB,cAAe,KAAMD,GAC7CzS,OAAO2S,oBAAoB,cAAe,KAAMF,GAChD,MAAOG,IAET7P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,YAAchL,IAChD3E,KAAKmb,UAAUxW,MACd8K,GAAkB,CAAEM,SAAS,IAEhC/P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,aAAehL,IACjD3E,KAAKob,WAAWzW,MACf8K,GAAkB,CAAEM,SAAS,IAEhC/P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,YAAchL,IAChD3E,KAAKmb,UAAUxW,MACd8K,GAAkB,CAAEM,SAAS,IAEhC/P,KAAKyM,MAAMvG,QAAQyJ,iBAAiB,cAAgBhL,IAClD3E,KAAKob,WAAWzW,MACf8K,GAAkB,CAAEM,SAAS,IAOlC,UAAUpL,GACR,IACI0W,EADI,EAAe1W,GACH3E,KAAKsN,iBAErBgO,EAAiBtb,KAAK8N,MAAM3I,MAAQnF,KAAK8K,QACzCyQ,EAAevb,KAAKoV,YAAckG,EAClCzZ,EAAanB,KAAKC,OAAO0a,EAAYE,GAAgBvb,KAAK8N,MAAM3I,MAAQnF,KAAK8K,SAAW,EAEhE,IAAxB9K,KAAK4C,iBACPf,GAA0B,GAG5B,IAAI2Z,EAAoB3Z,EAAa7B,KAAK4C,eAK1C,GAAI4Y,IAAsBxb,KAAKiW,mBAC7B,OAQEvV,KAAK+a,IAAIF,GAIbvb,KAAKiW,mBAAqBuF,EAE1B,IAAI3Q,GAAWhJ,EAAa,GAAKyZ,EAAiBC,EAkBjD,GAhB2B,IAAxBvb,KAAK4C,iBACPiI,EAAUhJ,EAAayZ,EAAiBC,GAK3Bvb,KAAKuZ,WAUf1O,EAAU,GAAKA,EAAU7K,KAAKgN,cAChC,OAGHhN,KAAKmV,QAAQb,OAEmB,QAA5BtU,KAAKzC,QAAQiL,MAAM/I,KACrBO,KAAK0b,aAAa7Z,EAAY0Z,GAE9Bvb,KAAKmU,QAAQjI,KAAKrB,GAGpB,MAAMvK,EAASN,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAK4R,eAAexR,IAAOqC,IAAKrC,IACvF,CACLxC,KAAMwC,EACN9B,MAAO0B,KAAKzC,QAAQiL,MAAMxH,cAAcZ,GAAMob,MAO9Clb,EAAOY,OACTlB,KAAKmU,QAAQwH,WAAWrb,GAExBN,KAAKmV,QAAQqF,OAGf,MAAMna,EAAOL,KAAKzC,QAAQiL,MAAMtI,MAAMsb,GAKjCnb,IAILL,KAAKmV,QAAQ7U,OAASA,EACtBN,KAAKmV,QAAQjJ,KAAKrB,EAASvK,GAC3BN,KAAKmV,QAAQ9U,KAAO,IAAIsZ,KAAKtZ,IAG/B,aACEL,KAAKmV,QAAQqF,OACbxa,KAAKmU,QAAQqG,OACbxa,KAAK4b,eAOP,WAAWhe,EAAMoI,GACfhG,KAAK8N,MAAM4D,qBAAqB9T,EAAMoI,GACtChG,KAAKmU,QAAQ3H,iBAAiB5O,GAEE,QAA5BoC,KAAKzC,QAAQiL,MAAM/I,MACrBO,KAAK8N,MAAM6D,0BACX3R,KAAKmP,YACgC,SAA5BnP,KAAKzC,QAAQiL,MAAM/I,KAC5BO,KAAK8N,MAAM6D,0BAEX3R,KAAKmP,WAIT,2BACEnP,KAAKzC,QAAQiL,MAAMzG,eAAe5B,QAAQC,IACxCJ,KAAKyM,MAAMmI,KAAKiH,gCAAgCzb,OAAUD,QAASiD,IACjEA,EAAGM,UAAUuC,OAAO,EAAMF,IAAI0Q,mBAAoBzW,KAAK8N,MAAMzD,oBAAoBjK,QAKvF,aAAaI,EAAO+a,GAClBvb,KAAKyM,MAAMuI,SAAS3Q,MAAMyX,QAAU,IACpC,IAAIlN,EAAYpO,EAAQR,KAAKuZ,WAAagC,EAAgBvb,KAAKuZ,WAAa,EAEvD,IAAjBgC,IACF3M,GAAwB5O,KAAKuZ,YAG/B,IAAIwC,EAASnN,EAAY5O,KAAKuZ,WAC1B1K,EAAanO,KAAK4B,IAAI,EAAKtC,KAAK+Y,oBAAsBvY,GAAUR,KAAKuZ,WAAagC,EAGtFvb,KAAKyM,MAAMwI,YAAYnR,aAAa,QAASpD,KAAK4B,IAAI,EAAGsM,IACzD5O,KAAKyM,MAAMyI,aAAapR,aAAa,IAAKiY,GAC1C/b,KAAKyM,MAAMyI,aAAapR,aAAa,QAASpD,KAAK4B,IAAI,EAAGuM,IAG5D,sBACE7O,KAAKyM,MAAMuI,SAAS3Q,MAAMyX,QAAU,IAGtC,iBACE9b,KAAKyM,MAAMuI,SAAW,EAAS,KAC/BhV,KAAKyM,MAAMuI,SAASlR,aAAa,QAAS,EAAMiC,IAAIiP,UAGpDhV,KAAKyM,MAAMwI,YAAc,EAAS,QAClCjV,KAAKyM,MAAMwI,YAAYnR,aAAa,QAAS,EAAMiC,IAAIkP,aACvDjV,KAAKyM,MAAMyI,aAAe,EAAS,QACnClV,KAAKyM,MAAMyI,aAAapR,aAAa,QAAS,EAAMiC,IAAImP,cAIxDlV,KAAKyM,MAAMwI,YAAYnR,aAAa,IAAK,GACzC9D,KAAKyM,MAAMyI,aAAapR,aAAa,IAAK9D,KAAKgN,cAH5B,GAInBhN,KAAKyM,MAAMwI,YAAYnR,aAAa,IAAK,GACzC9D,KAAKyM,MAAMyI,aAAapR,aAAa,IAAK,GAC1C9D,KAAKyM,MAAMwI,YAAYnR,aAAa,QANjB,GAOnB9D,KAAKyM,MAAMyI,aAAapR,aAAa,QAPlB,GAQnB9D,KAAKyM,MAAMwI,YAAYnR,aAAa,SAAU9D,KAAK6W,gBACnD7W,KAAKyM,MAAMyI,aAAapR,aAAa,SAAU9D,KAAK6W,gBAEpD7W,KAAKyM,MAAMuI,SAASvQ,YAAYzE,KAAKyM,MAAMwI,aAC3CjV,KAAKyM,MAAMuI,SAASvQ,YAAYzE,KAAKyM,MAAMyI,cAC3ClV,KAAK8N,MAAMrG,OAAOhD,YAAYzE,KAAKyM,MAAMuI,UAG3C,eACEhV,KAAKyM,MAAMuI,SAAS3Q,MAAMyX,QAAU,EAGtC,UACE9b,KAAKyM,MAAMhF,OAAO0G,SAElBnO,KAAK4V,4BAAyBjP,EAC9B3G,KAAK6V,4BAAyBlP,EAE1B3G,KAAKyM,MAAMuI,UACbhV,KAAKyM,MAAMuI,SAAS7G,SAGlBnO,KAAKyM,MAAMqI,QACb9U,KAAKyM,MAAMqI,OAAO3G,SAGpBnO,KAAK8K,QAAU,EACf9K,KAAKoV,YAAc,GC/3BR,MAAM,EAInB,YAAY7X,GACVyC,KAAKzC,QAAUA,EACfyC,KAAKyM,MAAQ,CACXvG,aAASS,GAGX3G,KAAKgc,QAAU,GAGjB,iBACE,MAAO,CACL9V,QAAS,YACTwM,KAAM,kBACNuJ,WAAY,0BACZC,aAAc,4BACdC,YAAa,2BACbC,SAAU,uBAQd,SA+CE,OA9CApc,KAAKyM,MAAMvG,QAAU,EAAS,MAAO,EAAOH,IAAIG,SAK7BnI,OAAOgF,QAAQ/C,KAAKzC,QAAQiL,MAAM3H,OAAO4B,IAAI,EAAE7E,EAAM8B,MAC/D,CAAC9B,OAAM8B,WAGLS,QAAQ,EAAEvC,OAAM8B,YACzB,IAAIgT,EAAO,EAAS,MAAO,CAAC,EAAO3M,IAAI2M,KAAM,EAAO3M,IAAIoW,cACtDC,EAAW,EAAS,OAAQ,EAAOrW,IAAIqW,UAEzC1J,EAAKjO,YAAY2X,GACjB1J,EAAKjO,YAAYpB,SAASgZ,eAAe3c,IAEzCM,KAAKgc,QAAQpe,GAAQ8U,EAErB1S,KAAKsc,iBAAkB,EAEvB5J,EAAK/C,iBAAiB,QAAS,KACxB3P,KAAKsc,iBACRtc,KAAKuc,YAAY3e,KAIrB8U,EAAK/C,iBAAiB,YAAa,KACjC3P,KAAKwc,UAAU5e,KAGjB8U,EAAK/C,iBAAiB,aAAc,KAClC3P,KAAKwc,UAAU5e,KAGjB8U,EAAK/C,iBAAiB,UAAW,KAC/B3P,KAAKyc,QAAQ7e,KAGf8U,EAAK/C,iBAAiB,WAAY,KAChC3P,KAAKyc,QAAQ7e,KAGfoC,KAAKiG,OAAOrI,GAAM,GAElBoC,KAAKyM,MAAMvG,QAAQzB,YAAYiO,KAE1B1S,KAAKyM,MAAMvG,QAGpB,UAAUtI,GACRoC,KAAK0c,OAAS1O,WAAW,KACvBhO,KAAKsc,iBAAkB,EAEvBtc,KAAK2c,uBAAuB/e,IAC3B,KAGL,uBAAuBgf,GACrB7e,OAAOgF,QAAQ/C,KAAKgc,SAAS7b,QAAQ,EAAEvC,EAAMwF,GAAK5C,KAC1C5C,IAASgf,GACX5c,KAAKiG,OAAOrI,GAAM,GAElBoC,KAAKzC,QAAQ0M,MAAM4S,WAAWjf,GAAM,GACpCoC,KAAKzC,QAAQuf,QAAQD,WAAWjf,GAAM,KAEtCoC,KAAKiG,OAAOrI,GAAM,GAElBoC,KAAKzC,QAAQ0M,MAAM4S,WAAWjf,GAAM,GACpCoC,KAAKzC,QAAQuf,QAAQD,WAAWjf,GAAM,MAO9C,QAAQA,GACDoC,KAAK0c,SAIV1O,WAAW,KACThO,KAAKsc,iBAAkB,GACtB,KAEH3L,aAAa3Q,KAAK0c,SAQpB,YAAY9e,GACV,IAAImf,EAAyH,IAAhH/c,KAAKzC,QAAQiL,MAAMzG,eAAeQ,OAAOnC,GAAQJ,KAAKzC,QAAQ0M,MAAM6D,MAAMzD,oBAAoBjK,IAAOc,OAElH,GAAKlB,KAAKgc,QAAQpe,GAAM8F,UAAUoC,SAAS,EAAOC,IAAIoW,aAE/C,CACL,GAAIY,EAMF,OALA/c,KAAKgc,QAAQpe,GAAM8F,UAAUC,IAAI,EAAOoC,IAAIkW,iBAC5CjO,WAAW,KACThO,KAAKgc,QAAQpe,GAAM8F,UAAUyK,OAAO,EAAOpI,IAAIkW,aAC9C,KAKLjc,KAAKiG,OAAOrI,GAAM,QAXlBoC,KAAKiG,OAAOrI,GAAM,GAcpBoC,KAAKzC,QAAQ0M,MAAM4S,WAAWjf,GAC9BoC,KAAKzC,QAAQuf,QAAQD,WAAWjf,GAGlC,OAAOA,EAAMoI,GAAS,GACpB,MAAMoW,EAAWpc,KAAKgc,QAAQpe,GAAMof,kBAAkB,EAAOjX,IAAIqW,YAEjEpc,KAAKgc,QAAQpe,GAAM8F,UAAUuC,OAAO,EAAOF,IAAIoW,YAAanW,GAE5DoW,EAAS/X,MAAM4Y,gBAAkBjX,EAAShG,KAAKzC,QAAQiL,MAAMjJ,OAAO3B,GAAQ,WCpJjE,MAAM,EACnB,YAAYL,GACVyC,KAAKzC,QAAUA,EACfyC,KAAKyM,MAAQ,CACXvG,aAASS,EACTjH,WAAOiH,EACPzG,WAAOyG,EACPuW,cAAe,GACfC,gBAAiB,IAQrB,iBACE,MAAO,CACLjX,QAAS,YACTxG,MAAO,mBACPQ,MAAO,mBACPkd,aAAc,2BACdC,oBAAqB,oCACrBC,eAAgB,qBAChBC,mBAAoB,0BACpBC,0BAA2B,oCAI/B,SAuDE,OAtDAxd,KAAKyM,MAAMvG,QAAU,EAAS,MAAO,EAAOH,IAAIG,SAChDlG,KAAKyM,MAAM/M,MAAQ,EAAS,MAAO,EAAOqG,IAAIrG,OAC9CM,KAAKyM,MAAMvM,MAAQ,EAAS,MAAO,EAAO6F,IAAI7F,OAE9CF,KAAKyM,MAAM/M,MAAM6E,YAAcvE,KAAKzC,QAAQiL,MAAM9I,OAAS,WAC3DM,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAM/M,OAEtCM,KAAKzC,QAAQkgB,aACfzd,KAAK0d,uBAGH1d,KAAKzC,QAAQogB,mBACf,CACE,CACEle,KAAM,OACNme,KAAM,i7BAIR,CACEne,KAAM,OACNme,KAAM,sYAIR,CACEne,KAAM,MACNme,KAAM,oVAORzd,QAAQ,EAAEV,OAAMme,WAChB,MAAMC,EAAW,EAAS,OAAQ,EAAO9X,IAAIqX,cAEzC3d,IAASO,KAAKzC,QAAQiL,MAAM/I,MAC9Boe,EAASna,UAAUC,IAAI,EAAOoC,IAAIsX,qBAGpCQ,EAASrZ,UAAYoZ,EACrBC,EAASlO,iBAAiB,QAAS,KACjC3P,KAAK8d,oBAAoBre,EAAMoe,KAGjC7d,KAAKyM,MAAMyQ,cAActc,KAAKid,GAE9B7d,KAAKyM,MAAMvG,QAAQzB,YAAYoZ,KAInC7d,KAAKyM,MAAMvG,QAAQzB,YAAYzE,KAAKyM,MAAMvM,OAEnCF,KAAKyM,MAAMvG,QAMpB,uBACE,MAAM6X,EAAU,EAAS,OAAQ,EAAOhY,IAAIuX,gBAE5C,CACE,CACE5d,MAAO,MACPse,oBAAqB,QAEvB,CACEte,MAAO,QACPse,oBAAqB,gBAEvB7d,QAAQ,EAAET,QAAOse,uBAAsBxd,KACvC,MAAMyd,EAAc,EAAS,OAAQ,EAAOlY,IAAIwX,oBAElC,IAAV/c,GACFyd,EAAYva,UAAUC,IAAI,EAAOoC,IAAIyX,2BAGvCS,EAAYzZ,UAAY9E,EACxBue,EAAYtO,iBAAiB,QAAS,KACpC3P,KAAKke,sBAAsBF,EAAqBC,KAElDF,EAAQtZ,YAAYwZ,GAEpBje,KAAKyM,MAAM0Q,gBAAgBvc,KAAKqd,KAGlCje,KAAKyM,MAAMvG,QAAQzB,YAAYsZ,GAGjC,oBAAoBte,EAAMoe,GACxB7d,KAAKzC,QAAQiL,MAAM/I,KAAOA,EAC1BO,KAAKzC,QAAQiL,MAAM2D,0BACnBnM,KAAKzC,QAAQ0M,MAAMkU,UACnBne,KAAKzC,QAAQ0M,MAAMsE,eACnBvO,KAAKzC,QAAQuf,QAAQsB,YACrBpe,KAAKzC,QAAQuf,QAAQ5N,sBAErBlP,KAAKyM,MAAMyQ,cAAc/c,QAAQiD,GAAMA,EAAGM,UAAUyK,OAAO,EAAOpI,IAAIsX,sBAEtEQ,EAASna,UAAUC,IAAI,EAAOoC,IAAIsX,qBAQpC,sBAAsBW,EAAqBD,GACzC/d,KAAKzC,QAAQ8gB,YAAYL,GAEzBhe,KAAKzC,QAAQ0M,MAAMkU,UACnBne,KAAKzC,QAAQ0M,MAAMsE,eACnBvO,KAAKzC,QAAQuf,QAAQsB,YACrBpe,KAAKzC,QAAQuf,QAAQ5N,sBAErBlP,KAAKyM,MAAM0Q,gBAAgBhd,QAAQiD,GAAMA,EAAGM,UAAUyK,OAAO,EAAOpI,IAAIyX,4BAExEO,EAAQra,UAAUC,IAAI,EAAOoC,IAAIyX,2BAGnC,UAAUc,EAAmBC,GAC3Bve,KAAK2a,IAAM3M,WAAW,KACpB,IAAIwQ,EAAW,IAAK7E,KAAK2E,GAAoB1E,mBAAmB,QAAS,CACvE9F,IAAK,UACLN,MAAO,QACPE,KAAM,YAEJkH,EAAY,IAAKjB,KAAK4E,GAAqB3E,mBAAmB,QAAS,CACzE9F,IAAK,UACLN,MAAO,QACPE,KAAM,YAGR1T,KAAKyM,MAAMvM,MAAMsE,aAAega,OAAc5D,KAE7C,KCzKP,sCAQe,MAAM,EAgBnB,aAAY,SAAC6D,EAAQ,KAAEC,EAAI,YAAEjB,EAAW,OAAEle,EAAM,OAAEC,EAAM,KAAEC,EAAI,MAAEC,EAAK,QAAEC,EAAO,OAAEC,EAAM,OAAEC,EAAS,IAAG,WAAE8e,GAAa,EAAI,kBAAEhB,GAAoB,IAC3I3d,KAAKgE,OAASX,SAASub,eAAeH,GAKtCze,KAAK6e,aAKL7e,KAAK0e,KAAOA,EAAOA,EAAKpX,OAAS,KACjCtH,KAAKyd,YAAcA,EAAcA,EAAYnW,OAAS,KACtDtH,KAAKT,OAASA,EACdS,KAAKP,KAAOA,EACZO,KAAKN,MAAQA,EACbM,KAAKR,OAASA,EACdQ,KAAKL,QAAUA,EACfK,KAAKJ,OAASA,EACdI,KAAKH,OAASA,EACdG,KAAK2e,WAAaA,EAClB3e,KAAK2d,kBAAoBA,EAEzB3d,KAAKqe,cAKLre,KAAK8c,QAAU,IAAI,EAAQ9c,MAK3BA,KAAKiK,MAAQ,IAAI,EAAMjK,MAKvBA,KAAK8U,OAAS,IAAI,EAAO9U,MAKzBA,KAAK6a,OAAS,IAAI,EAAO7a,MAKzBA,KAAK8e,YAKL9e,KAAKiK,MAAMsE,eACXvO,KAAK8c,QAAQsB,YASf,iBACE,MAAO,CACLW,iBAAmB,kBAQvB,YAAYf,EAAsB,QAKhChe,KAAKL,QAAkC,gBAAxBqe,EAKfhe,KAAKwI,MAAQ,IAAInJ,EAAMW,KAAKge,GAAsBhe,KAAKT,OAAQS,KAAKR,OAAQQ,KAAKP,KAAMO,KAAKN,MAAOM,KAAKL,QAASK,KAAKJ,OAAQI,KAAKH,QAMrI,aAIE,GAFoBwD,SAASub,eADL,sBAItB,OAGF,MAAMva,EAAQhB,SAASE,cAAc,SAC/Byb,EAAO3b,SAAS2Z,cAAc,QAEpC3Y,EAAM4a,GAVkB,qBAWxB5a,EAAME,YAAc,IAEpBya,EAAKva,YAAYJ,GAMnB,YACErE,KAAKgE,OAAOS,YAAYzE,KAAK6a,OAAOlQ,UACpC3K,KAAKgE,OAAOS,YAAYzE,KAAKiK,MAAMiV,YACnClf,KAAKgE,OAAOS,YAAYzE,KAAK8c,QAAQoC,YAEjClf,KAAK2e,YACP3e,KAAKgE,OAAOS,YAAYzE,KAAK8U,OAAOnK,UAQxC,kBACE3K,KAAKgE,OAAON,UAAUuC,OAAO,EAAQF,IAAIgZ,uB","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Graphon\"] = factory();\n\telse\n\t\troot[\"Graphon\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = \":root{--color-bg:#fff;--color-gray:#939ca1;--gray-line:rgba(24,45,59,0.1);--button-bg:#fff;--button-color:#000;--button-border:#e6e6e6;--button-bg-current:#e3f3ff;--button-border-current:#c5e2fa;--minimap-overlays-color:rgba(245,244,245,0.65);--minimap-scaler-bg:rgba(137,138,152,0.7);--minimap-scaler-bg--hover:#898a98;@custom-media --mobile (max-width: 1000px)}.tg--night-mode{--color-bg:#2b3037;--color-gray:rgba(217,242,255,0.27);--gray-line:hsla(0,0%,100%,0.1);--button-color:#fff;--button-bg:#293039;--button-border:hsla(0,0%,100%,0.2);--button-border-current:rgba(195,214,231,0.26);--button-bg-current:rgba(131,145,163,0.11);--minimap-overlays-color:rgba(38,41,43,0.62);--minimap-scaler-bg:rgba(109,146,185,0.4);--minimap-scaler-bg--hover:rgba(109,146,185,0.7)}.tg-chart{position:relative;font-size:14px;font-family:Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(255,255,255,0);-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}.tg-chart__viewport{display:block;overflow-x:hidden}.tg-chart svg{width:100%;height:100%;vertical-align:bottom}.tg-header{margin-bottom:20px;padding:0 0 15px;display:flex;flex-wrap:wrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media (--mobile){.tg-header{font-size:15px}}.tg-header__title{flex-basis:100%;margin:0 0 15px;font-weight:600;font-size:18px}.tg-header__dates{margin-top:auto;font-size:15px;margin-bottom:auto}@media (--mobile){.tg-header__dates{font-size:13px}}.tg-header__type-switcher{display:inline-flex;background:#fff;background:var(--button-bg);border:1px solid #e6e6e6;border:1px solid var(--button-border);box-sizing:border-box;box-shadow:0 1px 1px 0 rgba(0,0,0,.03);border-radius:2px;height:34px;line-height:32px;padding:0 9px;font-size:14px;font-weight:500;cursor:pointer;z-index:99;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(255,255,255,0);-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}.tg-header__type-switcher:hover{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border-color:#d8d8d8}.tg-header__type-switcher{width:34px;margin-right:5px}.tg-header__type-switcher--current{background:#e3f3ff;background:var(--button-bg-current);border:1px solid #c5e2fa;border:1px solid var(--button-border-current);border-radius:2px}.tg-header__type-switcher--current:hover{border-color:#add6f8}.tg-header__type-switcher svg{fill:currentColor;margin:auto}.tg-header__type-switcher:last-of-type{margin-right:auto}.tg-header__details{margin-right:15px}.tg-header__details-item{display:inline-flex;background:#fff;background:var(--button-bg);border:1px solid #e6e6e6;border:1px solid var(--button-border);box-sizing:border-box;box-shadow:0 1px 1px 0 rgba(0,0,0,.03);border-radius:2px;height:34px;line-height:32px;padding:0 9px;font-size:14px;font-weight:500;cursor:pointer;z-index:99;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(255,255,255,0);-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}.tg-header__details-item:hover{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border-color:#d8d8d8}.tg-header__details-item{min-width:70px;justify-content:center}.tg-header__details-item--current{background:#e3f3ff;background:var(--button-bg-current);border:1px solid #c5e2fa;border:1px solid var(--button-border-current);border-radius:2px}.tg-header__details-item--current:hover{border-color:#add6f8}.tg-header__details-item svg{fill:currentColor}.tg-header__details-item:first-of-type:not(.tg-header__details-item--current){border-right:0;min-width:69px}.tg-header__details-item--current+.tg-header__details-item{border-left:0;min-width:69px}.tg-header__details-item:not(:last-of-type){border-radius:2px 0 0 2px}.tg-header__details-item:not(:first-of-type){border-radius:0 2px 2px 0}.tg-legend{font-family:Helvetica Neue,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif;display:flex;flex-direction:column;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;align-items:flex-start}.tg-legend__item{padding:5px 0;box-shadow:none;display:flex;align-items:center;cursor:pointer;color:#818181}.tg-legend__item:hover{color:#666}.tg-legend__item--wobble{-webkit-animation:wobble .3s ease-out!important;animation:wobble .3s ease-out!important}.tg-legend__checkbox{display:inline-flex;background:#fff;background:var(--button-bg);border:1px solid #e6e6e6;border:1px solid var(--button-border);box-sizing:border-box;box-shadow:0 1px 1px 0 rgba(0,0,0,.03);border-radius:2px;height:34px;line-height:32px;padding:0 9px;font-size:14px;font-weight:500;cursor:pointer;z-index:99;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(255,255,255,0);-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}.tg-legend__checkbox:hover{box-shadow:0 1px 1px 0 rgba(0,0,0,.08);border-color:#d8d8d8}.tg-legend__checkbox{position:relative;width:24px;height:24px;margin:auto 7px auto 0;border:0}.tg-legend__checkbox--current{background:#e3f3ff;background:var(--button-bg-current);border:1px solid #c5e2fa;border:1px solid var(--button-border-current);border-radius:2px}.tg-legend__checkbox--current:hover{border-color:#add6f8}.tg-legend__checkbox svg{fill:currentColor}.tg-legend__checkbox:before{content:\\\"\\\";position:absolute;left:6px;top:6px;display:inline-block;width:11px;height:6px;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);opacity:0}.tg-legend__item:hover .tg-legend__checkbox{opacity:.9}@-webkit-keyframes wobble{0%{opacity:.5;transform:scale(.95)}25%{opacity:1}75%{opacity:.5;transform:scale(1.05)}to{opacity:1}}@keyframes wobble{0%{opacity:.5;transform:scale(.95)}25%{opacity:1}75%{opacity:.5;transform:scale(1.05)}to{opacity:1}}.tg-legend__item--enabled{color:#000}.tg-legend__item--enabled .tg-legend__checkbox:before{opacity:1;-webkit-animation:rolling .2s ease;animation:rolling .2s ease;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes rolling{0%{transform:rotate(-45deg) scale(1.4);opacity:0}to{transform:rotate(-45deg) scale(1);opacity:1}}@keyframes rolling{0%{transform:rotate(-45deg) scale(1.4);opacity:0}to{transform:rotate(-45deg) scale(1);opacity:1}}.tg-minimap{position:relative;height:60px;margin:10px 0 20px;cursor:pointer;border-radius:3px;-webkit-tap-highlight-color:rgba(255,255,255,0);-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;border:1px solid rgba(24,45,59,.1);border:1px solid var(--gray-line);box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;//border:1px solid #ebebeb}.tg-minimap svg{border-radius:3px;overflow:hidden;height:100%!important;width:100%!important}.tg-minimap__left,.tg-minimap__right{position:absolute;top:0;bottom:0;width:20%;background:rgba(245,244,245,.65);background:var(--minimap-overlays-color);z-index:2;cursor:default;will-change:width}.tg-minimap__left{left:0;border-radius:3px 0 0 3px}.tg-minimap__center{position:absolute;top:-2px;bottom:-2px;width:10px;border-top:2px solid rgba(137,138,152,.7);border-top:2px solid var(--minimap-scaler-bg);border-bottom:2px solid rgba(137,138,152,.7);border-bottom:2px solid var(--minimap-scaler-bg)}.tg-minimap__right{right:0;border-radius:0 3px 3px 0}.tg-minimap__left-scaler,.tg-minimap__right-scaler{position:absolute;height:calc(100% + 4px);top:-2px;z-index:2;cursor:col-resize}.tg-minimap__left-scaler{right:0}.tg-minimap__right-scaler{left:0}.tg-minimap__left-scaler:before,.tg-minimap__right-scaler:before{content:\\\"\\\";position:absolute;height:100%;width:14px;background:rgba(137,138,152,.7);background:var(--minimap-scaler-bg);box-sizing:border-box}.tg-minimap__left-scaler:after,.tg-minimap__right-scaler:after{content:\\\"\\\";position:absolute;height:15px;width:2px;border-radius:5px;background:#fff;top:50%;transform:translateY(-50%)}.tg-minimap__right-scaler:after{left:-6px}.tg-minimap__left-scaler:after{right:-8px}.tg-minimap__left-scaler:before{right:-14px;border-radius:3px 0 0 3px;border-right:0}.tg-minimap__right-scaler:before{left:-12px;border-radius:0 3px 3px 0;border-left:0}.tg-minimap__left-scaler:hover:before,.tg-minimap__right-scaler:hover:before{background:#898a98;background:var(--minimap-scaler-bg--hover)}.tg-chart g,.tg-minimap g{transform-origin:bottom left;will-change:transform}.tg-chart .oy-group,.tg-minimap .oy-group{transition:transform .3s ease;will-change:transform;shape-rendering:optimizespeed}.tg-chart path.scaled{transition:transform .4s ease,opacity .3s ease;will-change:transform,opacity}.tg-chart path,.tg-minimap path{transform-origin:bottom left;transition:opacity .3s ease;will-change:opacity;shape-rendering:optimizespeed}.tg-chart--line path{shape-rendering:geometricprecision}.tg-chart .tg-graph--hidden,.tg-minimap .tg-graph--hidden{opacity:0}.tg-bar{will-change:opacity,transform;transition:opacity .35s ease,transform .3s ease}.tg-bar--hidden{opacity:0}.tg-chart .tg-bar--hidden{transform:matrix(1,0,0,.1,0,50)}.tg-minimap .tg-bar{transition:none!important}.tg-bar rect{will-change:height,y;shape-rendering:optimizespeed}.tg-chart__overlays{will-change:opacity;transition:opacity .25s ease}.tg-chart__overlay-left,.tg-chart__overlay-right{fill:#fff;opacity:.5;will-change:width,x}.tg-area{will-change:opacity,transform!important;transition:all .17s ease!important}.tg-area--hidden{transform:scaleY(0)!important}.tg-chart footer{margin-top:10px;height:18px;color:#939ca1;color:var(--color-gray);font-size:12px;font-family:Roboto,Helvetica Neue,-apple-system,BlinkMacSystemFont,Segoe UI,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif;line-height:1em;position:relative}.tg-chart time{position:absolute;display:block;white-space:nowrap;transition:opacity .25s ease;will-change:opacity,transform;-webkit-animation:fade-in .25s ease;animation:fade-in .25s ease}@-webkit-keyframes fade-in{0%{opacity:0}to{opacity:1}}@keyframes fade-in{0%{opacity:0}to{opacity:1}}.tg-chart time.hided{opacity:0}.tg-pointer{position:absolute;top:0;left:0;opacity:0;will-change:opacity,left}.tg-pointer--showed{opacity:1}.tg-pointer:before{content:\\\"\\\";position:absolute;top:0;left:0;bottom:0;width:1px;background:rgba(170,181,191,.33)}.tg-chart--area .tg-pointer:before{background-color:hsla(0,0%,100%,.2)}.tg-pointer__pointer{display:inline-block;width:10px;height:10px;border:3px solid #1f2938;background:#fff;border-radius:50%;position:absolute;left:-5px;bottom:0;margin-bottom:-5px;box-sizing:border-box;z-index:2;will-change:transform}.tg-pointer__pointer--hidden{display:none}.tg-grid{top:0;color:#939ca1;color:var(--color-gray);font-size:12px;font-family:Roboto,Helvetica Neue,-apple-system,BlinkMacSystemFont,Segoe UI,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif}.tg-grid,.tg-grid__section{position:absolute;right:0;left:0}.tg-grid__section{bottom:0;padding-bottom:5px;border-bottom:1px solid rgba(24,45,59,.1);border-bottom:1px solid var(--gray-line);transition:transform .28s ease,opacity .35s ease,bottom .28s ease;will-change:transfrom,opacity}.tg-grid__counter{transition:opacity .3s ease;will-change:opacity}.tg-grid__counter--hidden{opacity:0}.tg-chart--line .tg-grid__counter{display:inline-block;background:#fff;background:var(--color-bg);color:#939ca1;color:var(--color-gray);border-radius:2px;padding:2px 4px;margin:0 -2px}.tg-grid__counter--second{float:right}.tg-grid__section--hidden{opacity:0;transform:translateY(-50px);visibility:hidden}@-webkit-keyframes jump-in{0%{transform:translateY(-30px);opacity:0}to{transform:none;opacity:1}}@keyframes jump-in{0%{transform:translateY(-30px);opacity:0}to{transform:none;opacity:1}}.tg-tooltip{position:absolute;background:#fff;border-radius:10px;box-shadow:0 1px 4px 0 rgba(0,0,0,.13);top:20px;padding:10px 15px;z-index:3;transition:left .3s ease,opacity .4s ease;will-change:left,opacity;opacity:0;min-width:180px;font-size:13px;font-family:Roboto,Helvetica Neue,-apple-system,BlinkMacSystemFont,Segoe UI,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,sans-serif;line-height:18px}.tg-tooltip--showed{opacity:1}.tg-tooltip__title{display:block;min-height:1.1em;font-weight:500;white-space:nowrap}.tg-tooltip__title .left{position:relative;margin-right:5px;display:inline-block;vertical-align:top}.tg-tooltip__title .left span{right:auto;left:0}.tg-tooltip__values{display:flex;flex-direction:column}.tg-tooltip__values-item{display:flex;margin-top:5px}.tg-tooltip__values-item:first-of-type{margin-top:7px}.tg-tooltip__values-item-title{display:inline-block;padding-right:20px}.tg-tooltip .percents{display:inline-block;font-weight:500;min-width:26px;text-align:right;margin-right:10px}.tg-tooltip__values-item b{display:block;margin-left:auto;white-space:nowrap;position:relative;font-weight:700}.counter-prev{-webkit-animation:exit .4s ease;animation:exit .4s ease;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.counter-cur,.counter-prev{position:absolute;will-change:transform,opacity;right:0;height:1em}.counter-cur{-webkit-animation:enter .4s ease;animation:enter .4s ease;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.counter-prev.top{-webkit-animation:exitTop .3s ease;animation:exitTop .3s ease;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.counter-cur.top{-webkit-animation:enterTop .3s ease;animation:enterTop .3s ease;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes exit{0%{transform:none;opacity:1}to{transform:translateY(-1px) scale(1.35);opacity:0}}@keyframes exit{0%{transform:none;opacity:1}to{transform:translateY(-1px) scale(1.35);opacity:0}}@-webkit-keyframes enter{0%{transform:scale(.85) translateX(-2px);opacity:0}80%{transform:scale(1.05);opacity:1}to{transform:none}}@keyframes enter{0%{transform:scale(.85) translateX(-2px);opacity:0}80%{transform:scale(1.05);opacity:1}to{transform:none}}@-webkit-keyframes exitTop{0%{transform:none;opacity:1}to{transform:translateY(-5px);opacity:0}}@keyframes exitTop{0%{transform:none;opacity:1}to{transform:translateY(-5px);opacity:0}}@-webkit-keyframes enterTop{0%{transform:translateY(5px);opacity:0}to{transform:none;opacity:1}}@keyframes enterTop{0%{transform:translateY(5px);opacity:0}to{transform:none;opacity:1}}.tg--night-mode{background:#2b3037;color:#fff}.tg--night-mode .tg-legend__item{border-color:#384757}.tg--night-mode .tg-tooltip{background:#1c2533;color:#fff;box-shadow:none}.tg--night-mode .tg-tooltip__title{color:#fff}.tg--night-mode .tg-pointer__pointer{background:#2b3037}.tg--night-mode .tg-chart__overlays rect{fill:#2b3037}.tg--night-mode .tg-grid__section{border-color:rgba(24,45,59,.1);border-color:var(--gray-line)}.tg--night-mode .tg-chart footer,.tg--night-mode .tg-grid{color:#939ca1;color:var(--color-gray)}.tg--night-mode .all b{color:#fff!important}\"","/**\n * This class stores the sate of application\n * @todo add cache to all getters\n */\nexport default class State {\n  /**\n   * @param {string} chartsData - input data in csv format\n   * @param {string[]} colors - colors list for each line\n   * @param {string[]} titles - titles list for each line\n   * @param {string} type - graph type - line, area, bar\n   * @param {string} title - graph title\n   * @param {boolean} byMonth - grouped by month\n   * @param {number} height - chart height\n   */\n  constructor(chartsData, colors, titles, type, title, byMonth, scaled, height){\n    const lines = chartsData.split('\\n');\n\n    this.columns = [];\n    this.dates = [];\n    this.type = type;\n    this.title = title;\n    this.byMonth = byMonth;\n    this.height = height;\n\n    lines.forEach((line) => {\n      let [date, ...values] = line.split(',');\n\n      values.forEach((val, index) => {\n        val = parseFloat(val);\n        val = Math.round(val * 100) / 100;\n\n        if (this.columns[index]){\n          this.columns[index].push(val);\n        } else {\n          this.columns[index] = [val];\n        }\n      });\n\n      this.dates.push(date);\n    });\n\n    this.colors = colors;\n    this.names = titles;\n    this.isYScaled = scaled || false;\n\n    /**\n     * Cache\n     */\n    this._cache = {\n      /**\n       * @todo maybe array copying worst than slice\n       */\n      getLinePoints: {},\n      dates: this.columns[0],\n      daysCount: this.columns[0].length\n    };\n\n    this._recalculatedPoints = [];\n  }\n\n  /**\n   * Column with dates is 0-index column, so shift it\n   * First element in arrays is column name (\"x\") so slice it\n   * @return {number[]} - array of dates in milliseconds\n   */\n  // get dates(){\n  //   return this._cache.dates;\n  // }\n\n  /**\n   * Return available line names\n   * @return {string[]} - array of graph names\n   */\n  get linesAvailable(){\n    return Object.keys(this.names);\n  }\n\n  /**\n   * Returns numbers of days at the input data\n   * @return {number}\n   */\n  get daysCount(){\n    return this._cache.daysCount;\n  }\n\n  /**\n   * Returns values of line by line name\n   * @param {string} lineName - \"y0\", \"y1\" etc\n   * @return {number[]}\n   */\n  getLinePoints(lineName){\n    if (this._cache.getLinePoints[lineName]){\n      return this._cache.getLinePoints[lineName];\n    }\n\n    this._cache.getLinePoints[lineName] = this.getColumnByName(lineName);\n\n\n    return this._cache.getLinePoints[lineName];\n  }\n\n  /**\n   * Return column by name\n   * @param {string} name - \"y0\", \"y1\" etc\n   * @return {array}\n   */\n  getColumnByName(name){\n    return this.columns[name];\n  }\n\n  /**\n   * Return N points from passed position\n   * @param {string} lineName - \"y0\", \"y1\", ...etc\n   * @param {number} from - start position\n   * @param {number} count - how many items requested\n   * @return {number[]}\n   */\n  getPointsSlice(lineName, from, count){\n    return this.getLinePoints(lineName).slice(from, from + count);\n  }\n\n  /**\n   * Returns color of line by line name\n   * @param {string} lineName - \"y0\", \"y1\" etc\n   * @return {string} - hex color like \"#333333\"\n   */\n  getLineColor(lineName){\n    return this.colors[lineName];\n  }\n\n  /**\n   * Returns chart type by name\n   * @param {string} chartName - \"y0\", \"y1\" etc\n   * @return {string} - \"line\", \"bar\", \"area\"\n   */\n  getChartType(chartName){\n    return this.types[chartName];\n  }\n\n  /**\n   * Detect type of charts\n   * @return {string}\n   */\n  getCommonChartsType(){\n    return this.type;\n  }\n\n  /**\n   * Return value of same point of previous chart\n   * @param currentChartNumber\n   * @param pointIndex\n   */\n  getPrevChartValueForPoint(currentChartNumber, pointIndex){\n    let prevChartKey = this.linesAvailable[currentChartNumber - 1];\n    return this.getLinePoints(prevChartKey)[pointIndex];\n  }\n\n  /**\n   * Return a stack value for each point\n   */\n  getStacks(){\n    if (this._cache.stacks){\n      return this._cache.stacks;\n    }\n\n    let from = 0;\n    let to = this.daysCount;\n    let stacks = [];\n\n    for (let pointIndex = from; pointIndex < to; pointIndex++){\n      let stackValue = this.getStackForPoint(pointIndex);\n\n      stacks.push(stackValue);\n    }\n\n    this._cache.stacks = stacks;\n\n    return this._cache.stacks;\n  }\n\n  /**\n   * Return accumulated stack value for point\n   * @param {number} pointIndex\n   * @param {string[]} skipLines - line numbers to skip (it may be hidden)\n   * @return {number}\n   */\n  getStackForPoint(pointIndex, skipLines = []){\n    let stackValue = 0;\n\n    this.linesAvailable.forEach(line => {\n      if (skipLines.includes(line)){\n        return;\n      }\n\n      stackValue += this.getLinePoints(line)[pointIndex];\n    });\n\n    return stackValue;\n  }\n\n  /**\n   *\n   * @param from\n   * @param to\n   * @param {string[]} skipLines - line numbers to skip (it may be hidden)\n   * @return {number}\n   */\n  getMaximumAccumulatedByColumns(from = 0, to = this.daysCount, skipLines = []){\n    let max = 0;\n\n    for (let pointIndex = from; pointIndex < to; pointIndex++){\n      let stackValue = this.getStackForPoint(pointIndex, skipLines);\n\n      if (max < stackValue){\n        max = stackValue;\n      }\n    }\n\n    return max;\n  }\n\n  /**\n   * Returns chart type by name\n   * @param {string} chartName - \"y0\", \"y1\" etc\n   * @return {string} - \"line\", \"bar\", \"area\"\n   */\n  getOhterTypes(chartName){\n    return Object.keys(this.types).filter(type => type !== chartName);\n  }\n\n  /**\n   * Return maximum value from all charts\n   * @return {number}\n   */\n  get max(){\n    const maxPerLines = this.linesAvailable.map( name => {\n      return Math.max(...this.getLinePoints(name));\n    });\n\n    return Math.max(...maxPerLines);\n  }\n\n  /**\n   * Return maximum value for passed line\n   * @return {number}\n   */\n  maxForLine(name){\n    return Math.max(...this.getLinePoints(name));\n  }\n\n  /**\n   * Return minimum value from all charts\n   * @return {number}\n   */\n  get min(){\n    const minPerLines = this.linesAvailable.map( name => {\n      return Math.min(...this.getLinePoints(name));\n    });\n\n    return Math.min(...minPerLines);\n  }\n\n  /**\n   * Return minimum value for passed line\n   * @return {number}\n   */\n  minForLine(name){\n    return Math.min(...this.getLinePoints(name));\n  }\n\n  /**\n   * Return max value for line with start point and next N visible\n   */\n  getMaxForLineSliced(line, leftPointIndex, pointsVisible){\n    return Math.max(...this.getPointsSlice(line, leftPointIndex, pointsVisible));\n  }\n\n  /**\n   * Return min value for line with start point and next N visible\n   */\n  getMinForLineSliced(line, leftPointIndex, pointsVisible){\n    return Math.min(...this.getPointsSlice(line, leftPointIndex, pointsVisible));\n  }\n\n  /**\n   * Array of available colors\n   * @return {string[]}\n   */\n  get colorsList(){\n    return Object.entries(this.colors).map(([name, value]) => value);\n  }\n\n  /**\n   * Array of available chart names\n   * @return {string[]}\n   */\n  get namesList(){\n    return Object.entries(this.names).map(([name, value]) => value);\n  }\n\n  /**\n   * Stores previously calculated values to prevent do the same both for chart and for mini map\n   * @type {Array}\n   */\n  saveRecalculatedValues(values){\n    this._recalculatedPoints.push(values);\n  }\n\n  /**\n   * Dealloc used values\n   * @type {Array}\n   */\n  clearRecalculatedValues(){\n    this._recalculatedPoints = [];\n  }\n\n  get recalculatedValues(){\n    return this._recalculatedPoints;\n  }\n\n}\n","/**\n * Create HTML element\n * @param {string} tagName - HTML element tag name\n * @param {string[]|string} classNames - array of CSS classes\n * @param attributes - any attributes\n * @return {HTMLElement}\n */\nexport function make(tagName, classNames = undefined, attributes = {}) {\n  const svgNamespace = 'http://www.w3.org/2000/svg';\n  const svgElements = ['svg', 'path', 'rect', 'circle', 'text', 'g', 'animate'];\n  const isSvg = svgElements.includes(tagName);\n  const el = !isSvg ? document.createElement(tagName) : document.createElementNS(svgNamespace, tagName);\n\n  if (Array.isArray(classNames) && classNames.length) {\n    el.classList.add(...classNames);\n  } else if (classNames) {\n    el.className = classNames;\n  }\n\n  if (attributes && Object.keys(attributes).length) {\n    for (let attrName in attributes) {\n      if (attributes.hasOwnProperty(attrName)) {\n        el.setAttribute(attrName, attributes[attrName]);\n      }\n    }\n  }\n\n  return el;\n}\n\n/**\n * Inserts one element after another\n */\nexport function insertAfter(target, element) {\n  target.parentNode.insertBefore(element, target.nextSibling);\n}\n\n/**\n * Insert one element before another\n */\nexport function insertBefore(target, element) {\n  target.parentNode.insertBefore(element, target);\n}\n\nexport function animateCounter(holder, val, prevVal, animateType = 'default'){\n  let prev = make('span', ['counter-prev', animateType]);\n  let cur = make('span', ['counter-cur', animateType]);\n\n  holder.style.width = val.length * 7 + 'px';\n\n  prev.textContent = prevVal;\n  cur.textContent = val;\n\n  holder.innerHTML = '';\n  holder.appendChild(prev);\n\n  holder.appendChild(cur);\n\n}","/**\n * Return pageX for passed Event\n * @param {MouseEvent|TouchEvent} event\n */\nexport function getPageX(event) {\n  if (event.touches){\n    return event.touches[0].pageX;\n  }\n\n  return event.pageX;\n}","import * as Dom from \"../utils/dom\";\n\n/**\n * Helper for creating an SVG path\n */\nexport default class Path {\n  constructor({canvasHeight, zeroShifting, color, kY, stroke, stepX, max, min, isScaled}){\n    this.canvasHeight = canvasHeight;\n    this.zeroShifting = zeroShifting;\n    this.kY = kY;\n    this.stepX = stepX;\n    this.prevX = 0;\n    this.max = max;\n    this.min = min;\n\n    // here will be stored current minimum value for 2-y axis charts\n    this.currentMinimum = 0;\n\n    this.path = Dom.make('path', null, {\n      'stroke-width' : stroke,\n      stroke : color,\n      fill : 'transparent',\n      'stroke-linecap' : 'round',\n      'stroke-linejoin' : 'round',\n      'vector-effect': 'non-scaling-stroke',\n    });\n\n    if (isScaled){\n      this.path.classList.add('scaled');\n    }\n\n    this.pathData = '';\n  }\n\n  /**\n   * CSS classes map\n   * @return {{graphHidden: string}}\n   */\n  static get CSS(){\n    return {\n      graphHidden: 'tg-graph--hidden',\n    }\n  }\n\n  /**\n   * Compute Y value with scaling\n   */\n  y(val){\n    return Math.round(this.canvasHeight - val * this.kY + this.zeroShifting);\n  }\n\n  /**\n   * Compute X value with scaling\n   */\n  x(val){\n    return val;\n  }\n\n  /**\n   * Go to passed coords\n   * @param {number} x\n   * @param {number} y\n   */\n  moveTo(x, y){\n    this.pathData += `M ${this.x(x)} ${this.y(y)}`;\n  }\n\n  /**\n   * Continue line to the next value\n   * @param {number} y\n   */\n  stepTo(y, skipStep){\n    if (!skipStep){\n      this.prevX = this.prevX + this.stepX;\n    }\n    this.pathData += ` L ${this.x(this.prevX)} ${this.y(y)}`;\n  }\n\n  /**\n   * Append a line\n   */\n  render(){\n    this.path.setAttribute('d', this.pathData);\n    return this.path;\n  }\n\n  get isHidden(){\n    return this.path.classList.contains(Path.CSS.graphHidden);\n  }\n\n  toggleVisibility(status){\n    this.path.classList.toggle(Path.CSS.graphHidden, status);\n  }\n}\n","import * as Dom from \"../utils/dom\";\n\n/**\n * Helper for creating an Bar charts\n */\nexport default class Bar {\n  constructor({canvasHeight, kY, stepX, key}){\n    this.canvasHeight = canvasHeight;\n    this.kY = kY;\n    this.key = key;\n\n    this.prevX = 0;\n    this.stepX = stepX;\n\n    this.wrapper = Dom.make('g');\n    this.wrapper.setAttribute('class', Bar.CSS.wrapper);\n    this.wrapper.setAttribute('vector-effect', 'non-scaling-stroke');\n    this.hidden = false;\n    this.wrapper.style.transform = `translateX(-${this.stepX / 2}px)`\n\n  }\n\n  getAll(){\n    return this.wrapper;\n  }\n\n  /**\n   * CSS classes map\n   * @return {{graphHidden: string}}\n   */\n  static get CSS(){\n    return {\n      wrapper: 'tg-bar',\n      graphHidden: 'tg-bar--hidden',\n    }\n  }\n\n  /**\n   * Compute Y value with scaling\n   */\n  y(val){\n    return this.canvasHeight - val * this.kY;\n  }\n\n  /**\n   * Compute X value with scaling\n   */\n  x(val){\n    return val;\n  }\n\n  /**\n   * Continue line to the next value\n   * @param {number} y\n   */\n  add(y, stackValue, prevValue, color){\n    let stackScaled = stackValue * this.kY;\n    let heightPrev = prevValue * this.kY;\n    let height = stackScaled - heightPrev;\n\n    const bar = Dom.make('rect');\n    bar.setAttribute('width', this.stepX);\n    bar.setAttribute('height', height);\n    bar.setAttribute('x', this.prevX);\n    bar.setAttribute('y', this.y(stackValue - prevValue));\n    bar.setAttribute('fill', color);\n\n    this.prevX = this.prevX + this.stepX;\n    // bar.setAttribute('stroke', color);\n    // bar.setAttribute('opacity', 0.6);\n\n\n    this.wrapper.appendChild(bar);\n  }\n\n  move(index, newStack, prevValue) {\n    let bar = this.wrapper.children[index];\n    let stackScaled = newStack * this.kY;\n    let heightPrev = prevValue * this.kY;\n    let height = stackScaled - heightPrev;\n\n    bar.setAttribute('height', height);\n    bar.setAttribute('y', this.y(newStack - prevValue));\n  }\n\n\n  get isHidden(){\n    return this.hidden;\n  }\n\n  toggleVisibility(status){\n    this.hidden = !this.hidden;\n    this.wrapper.classList.toggle(Bar.CSS.graphHidden, status);\n  }\n}","import * as Dom from \"../utils/dom\";\n\n/**\n * Helper for creating an Bar charts\n */\nexport default class Area {\n  constructor({canvasHeight, stepX, key, color}){\n    this.canvasHeight = canvasHeight;\n    this.key = key;\n    this.color = color;\n\n    this.prevX = 0;\n    this.stepX = stepX;\n    this.hidden = false;\n\n\n    this.path = this.createPath();\n    this.morphing = undefined;\n\n    this.pathData = [];\n  }\n\n  createPath(){\n    let path = Dom.make('path', null, {\n      fill : this.color,\n      'vector-effect': 'non-scaling-stroke',\n    });\n\n    path.classList.add(Area.CSS.path);\n\n    return path;\n  }\n\n  getAll(){\n    return this.path;\n  }\n\n  /**\n   * CSS classes map\n   * @return {{graphHidden: string}}\n   */\n  static get CSS(){\n    return {\n      path: 'tg-area',\n      graphHidden: 'tg-area--hidden',\n    }\n  }\n\n  /**\n   * Compute Y value with scaling\n   */\n  y(val){\n    return this.canvasHeight - val;\n  }\n\n  /**\n   * Compute X value with scaling\n   */\n  x(val){\n    return val;\n  }\n\n  percentToValue(per){\n    return this.canvasHeight / 100 * per;\n  }\n\n  valueToPercent(val, total){\n    return 100 / total * val;\n  }\n\n  /**\n   * Go to passed coords\n   * @param {number} x\n   * @param {number} y\n   */\n  moveTo(x, y, total = 0){\n    let valueInPercents = total ? this.valueToPercent(y, total) : y;\n    this.pathData.push(`M ${x} ${this.percentToValue(valueInPercents)}`);\n  }\n\n  /**\n   * Continue line to the next value\n   * @param {number} total - this value is 100% for all charts\n   */\n  stepTo(total, prev, skip = false){\n    let prevPercents = 100 / total * prev;\n\n    /**\n     * Case for empty (zero) value\n     */\n    if (isNaN(prevPercents)){\n      prevPercents = 100;\n    }\n\n\n    let percentage = this.percentToValue(100 - prevPercents);\n    // console.log('current per %o | 100% is %o | prev percents is %o | -->', curPercents, total, prevPercents, percentage);\n    if (!skip) {\n      this.prevX = this.prevX + this.stepX;\n    }\n    this.pathData.push(`L ${this.x(this.prevX)} ${this.y(percentage)}`);\n  }\n\n  /**\n   * Recalculate Y coordinate\n   * @param {number} y\n   * @param {number} total - this value is 100% for all charts\n   */\n  move(index, total, prev){\n    let pointToChange = this.pathData[index + 1]; // +1 to skip M value\n    let [l, x, y] = pointToChange.trim().split(' ');\n\n    let prevPercents, percentage;\n\n    if (total > 0){\n      prevPercents = 100 / total * prev;\n      percentage = this.percentToValue(100 - prevPercents);\n    } else {\n      percentage = this.percentToValue(0 );\n    }\n\n    this.pathData[index + 1] = ` L ${x} ${this.y(percentage)}`;\n  }\n\n  update(){\n    this.morphing = Dom.make('animate');\n    this.morphing.setAttribute('attributeName', 'd');\n    this.morphing.setAttribute('attributeType', 'XML');\n    this.morphing.setAttribute('dur', '170ms');\n    this.morphing.setAttribute('fill', 'freeze');\n    this.morphing.setAttribute('to', this.pathData.join(' '));\n    this.path.appendChild(this.morphing);\n    this.morphing.beginElement();\n  }\n\n  /**\n   * Append a line\n   */\n  finish(){\n    this.pathData.push(`L ${this.x(this.prevX)} ${this.canvasHeight} 0 ${this.canvasHeight} 0 0`);\n    this.path.setAttribute('d', this.pathData.join(' '));\n  }\n\n  get isHidden(){\n    return this.hidden;\n  }\n\n  toggleVisibility(status){\n    this.hidden = !this.hidden;\n    this.path.classList.toggle(Area.CSS.graphHidden, status);\n  }\n}","import * as Dom from '../utils/dom';\nimport Path from './path';\nimport Bar from './bar';\nimport Area from './area';\nimport * as Numbers from \"../utils/numbers\";\n\nimport log from '../utils/log.js';\n\n\n/**\n * Working with svg paths for charts\n */\nexport default class Graph {\n  /**\n   * @param {Graphon} modules\n   */\n  constructor(modules, {stroke}){\n    /**\n     * Width of date label is used for default stepX value in 1:1 scale\n     * @type {number}\n     */\n    const dateLabelWidth = 45;\n\n    this.modules = modules;\n\n    /**\n     * @todo move to this.nodes\n     */\n    this.canvas = undefined;\n\n    /**\n     * Transformations on OY\n     */\n    this.oyGroup = undefined;\n\n    /**\n     * Transformations on OX\n     */\n    this.oxGroup = undefined;\n\n    this.stepX = dateLabelWidth;\n    this.stepY = 10;\n    this.strokeWidth = stroke;\n    this.initialWidth = undefined;\n    this.maxPoint = 0;//\n    this.minPoint = 0;\n\n    /**\n     * [ canvas height / (Max - Min) ]\n     * Ratio from 1:1 scale to fit min (on zero-axis) and max (on top Y axis)\n     */\n    this.kY = 1;\n\n    /**\n     * [ min point * kY ]\n     * On how much we should move down chart to make min-point hit zero-axis\n     */\n    this.zeroShifting = 0;\n\n    /**\n     * What point is currently fit zero-axis;\n     */\n    this.currentMinimum = 0;\n\n    /**\n     * [ new kY / original kY ]\n     * How much the original kY is changed to fit new min & max points\n     */\n    this.oyScaling = 1;\n\n    /**\n     * [ original shift / new shift ]\n     * How much the original zero axis shifting is changed to fit new min & max points\n     */\n    this.zeroShiftingScaling = 1;\n\n\n\n    /**\n     * List of drawn charts\n     * @type {object} name -> Path\n     */\n    this.charts = {};\n\n    /**\n     * Cache for canvas width and height values\n     * @type {number}\n     * @private\n     */\n    this._width = 0;\n    this._height = 0;\n  }\n\n  static get CSS(){\n    return {\n      oxGroup: 'ox-group',\n      oyGroup: 'oy-group',\n    }\n  }\n\n  /**\n   * How much the original ratio of height to max-min is changed to fit new min & max points\n   * @return {number}\n   */\n  get kYScaled(){\n    return this.kY * this.oyScaling;\n  }\n\n  /**\n   * Prepares the SVG element\n   * @param {number} [width] - strict canvas width\n   * @param {number} [height] - strict canvas height\n   * @return {SVGElement}\n   */\n  renderCanvas({width, height} = {}){\n    this.canvas = Dom.make('svg');\n    this.oxGroup = Dom.make('g');\n    this.oyGroup = Dom.make('g');\n\n    this.oxGroup.setAttribute('class', Graph.CSS.oxGroup);\n    this.oyGroup.setAttribute('class', Graph.CSS.oyGroup);\n    this.oyGroup.setAttribute('vector-effect', 'non-scaling-stroke');\n    this.oxGroup.setAttribute('vector-effect', 'non-scaling-stroke');\n\n    if (!width){\n      this.computeInitialWidth();\n    } else {\n      this.width = this.initialWidth = width;\n    }\n\n    if (height){\n      this.height = height;\n    }\n\n    this.computeSteps();\n\n    this.oyGroup.appendChild(this.oxGroup);\n    this.canvas.appendChild(this.oyGroup);\n\n    return this.canvas;\n  }\n\n  /**\n   * Compute and set initial canvas width\n   */\n  computeInitialWidth(){\n    this.initialWidth = this.modules.state.daysCount * this.stepX;\n    this.width = this.initialWidth;\n  }\n\n  /**\n   * Return total (big) chart width\n   * @return {number}\n   */\n  get width(){\n    return this._width;\n  }\n\n  /**\n   * Set canvas width\n   * @param {number} val\n   */\n  set width(val){\n    this._width = val;\n    this.canvas.style.width = val + 'px';\n  }\n\n  /**\n   * Return chart height\n   * @return {number}\n   */\n  get height(){\n    return this._height;\n  }\n\n  /**\n   * Set canvas height\n   * @param {number} val\n   */\n  set height(val){\n    this._height = val;\n    this.canvas.style.height = val + 'px';\n  }\n\n  /**\n   * Calculates stepX by canvas width and total points count\n   */\n  computeSteps(){\n    if (this.modules.state.byMonth){\n      if (this.modules.state.type === 'bar'){\n        this.stepX = this.width / (this.modules.state.daysCount);\n      } else {\n        this.stepX = this.width / (this.modules.state.daysCount - 1);\n      }\n    } else {\n      this.stepX = this.width / (this.modules.state.daysCount - 1);\n    }\n\n    /**\n     * All lines maximum value\n     */\n    const max = this.modules.state.max;\n    const min = this.modules.state.min;\n    const stepsAvailable = [5, 10, 25, 50, 100, 1000, 500, 10000, 5000, 100000, 1000000, 10000000];\n    let newStepYIndex = stepsAvailable.reverse().findIndex( (step) => {\n      let c = (max - min) > step;\n\n      return c;\n    }),\n    newStepY = stepsAvailable[newStepYIndex];\n\n    if (max / newStepY < 3 && newStepYIndex < stepsAvailable.length - 1){\n      newStepY = stepsAvailable[newStepYIndex + 1];\n    }\n\n    this.stepY = newStepY;\n  }\n\n  renderCharts(){\n    const type = this.modules.state.getCommonChartsType();\n\n    switch (type){\n      case 'bar':\n        this.maxPoint = this.modules.state.getMaximumAccumulatedByColumns(); // 20% for padding top\n        this.minPoint = this.modules.state.min;\n        this.drawBarCharts();\n        break;\n      case 'area':\n        this.maxPoint = this.modules.state.getMaximumAccumulatedByColumns(); // 20% for padding top\n        this.drawAreaCharts();\n        break;\n      default:\n      case 'line':\n        if (!this.modules.state.isYScaled) {\n          this.maxPoint = this.modules.state.max;\n          this.minPoint = this.modules.state.min;\n\n          this.drawLineCharts();\n        } else {\n          this.drawScaledLineCharts();\n        }\n\n        break;\n    }\n  }\n\n  drawAreaCharts(){\n    let areas = this.modules.state.linesAvailable.reverse().map( line => {\n      return new Area({\n        canvasHeight: this.height,\n        stepX: this.stepX,\n        key: line,\n        color: this.modules.state.getLineColor(line)\n      });\n    });\n\n    const pointsCount = this.modules.state.daysCount;\n    const stacks = this.modules.state.getStacks();\n\n    this.modules.state.linesAvailable.reverse().forEach( (line, index) => {\n      areas[index].moveTo(0, this.modules.state.getLinePoints(line)[0], stacks[0]);\n    });\n\n\n    for (let pointIndex = 0; pointIndex < pointsCount; pointIndex++) {\n      let prevValue = 0;\n\n      this.modules.state.linesAvailable.reverse().forEach( (line, index) => {\n        let pointValue = this.modules.state.getLinePoints(line)[pointIndex];\n\n        if (pointIndex === 0){\n          areas[index].stepTo(stacks[pointIndex], prevValue, true);\n        } else {\n          areas[index].stepTo(stacks[pointIndex], prevValue);\n        }\n\n        prevValue += pointValue;\n      });\n    }\n\n    areas.forEach(area => {\n      area.finish();\n      this.oxGroup.appendChild(area.getAll());\n      this.charts[area.key] = area;\n    });\n  }\n\n  drawBarCharts(){\n    const kY = this.maxPoint !== 0 ? this.height / this.maxPoint : 1;\n    let barmens = this.modules.state.linesAvailable.reverse().map( line => {\n      return new Bar({\n        canvasHeight: this.height,\n        stepX: this.stepX,\n        kY,\n        key: line\n      });\n    });\n\n    const pointsCount = this.modules.state.daysCount;\n    const stacks = this.modules.state.getStacks();\n\n    for (let pointIndex = 0; pointIndex < pointsCount; pointIndex++) {\n      let prevValue = 0;\n\n      this.modules.state.linesAvailable.reverse().forEach( (line, index) => {\n        const color = this.modules.state.getLineColor(line);\n\n\n\n        let pointValue = this.modules.state.getLinePoints(line)[pointIndex];\n\n        // const editorLabelStyle = `line-height: 1em;\n        //     color: #fff;\n        //     display: inline-block;\n        //     font-size: 12px;\n        //     line-height: 1em;\n        //     background-color: ${color};\n        //     padding: 4px 9px;\n        //     border-radius: 30px;\n        //     margin: 4px 5px 4px 0;`;\n        // console.log(`%c${pointValue}`, editorLabelStyle);\n\n\n        barmens[index].add(pointValue, stacks[pointIndex], prevValue, color);\n        prevValue += pointValue;\n      });\n\n\n\n      // console.log('%o -> stack %o', pointIndex, stackValue);\n    }\n\n    barmens.forEach(barmen => {\n      this.oxGroup.appendChild(barmen.getAll());\n      this.charts[barmen.key] = barmen;\n    });\n  }\n\n  /**\n   * Return names of hidden charts\n   */\n  get hiddenCharts(){\n    return Object.entries(this.charts).filter(([name, chart]) => chart.isHidden).map(([name]) => name);\n  }\n\n  /**\n   * Return max visible point\n   * If line passed, check for that. Otherwise, return maximum between all\n   */\n  getMaxFromVisible(leftPointIndex = 0, pointsVisible = this.modules.state.daysCount, line = undefined){\n    const type = this.modules.state.getCommonChartsType();\n\n    switch (type) {\n      case 'bar':\n        return this.modules.state.getMaximumAccumulatedByColumns(leftPointIndex, leftPointIndex + pointsVisible, this.hiddenCharts);\n        break;\n      default:\n      case 'line':\n        if (!line) {\n          return Math.max(...this.modules.state.linesAvailable.filter(line => this.checkPathVisibility(line)).map(line => {\n            return this.modules.state.getMaxForLineSliced(line, leftPointIndex, pointsVisible);\n          }));\n        }\n\n        return this.modules.state.getMaxForLineSliced(line, leftPointIndex, pointsVisible, line);\n        break;\n    }\n  }\n\n  drawScaledLineCharts(){\n    this.modules.state.linesAvailable.forEach( name => {\n      const lineMin = this.modules.state.minForLine(name);\n      const lineMax = this.modules.state.maxForLine(name);\n      const values = this.modules.state.getLinePoints(name);\n\n      // console.log('[%o] min %o max %o', name, lineMin, lineMax);\n\n      let kY = this.height / (lineMax - lineMin);\n      let zeroShifting = lineMin * kY;\n\n      /**\n       * Create a Path instance\n       */\n      const path = new Path({\n        canvasHeight: this.height,\n        isScaled: this.modules.state.isYScaled,\n        max: lineMax,\n        color: this.modules.state.getLineColor(name),\n        zeroShifting,\n        kY,\n        stroke: this.strokeWidth,\n        stepX: this.stepX,\n      });\n\n      path.moveTo(0, values[0]);\n\n      values.forEach( (column, index )=> {\n        if (index === 0){\n          path.stepTo(column, true);\n        } else {\n          path.stepTo(column);\n        }\n      });\n\n      this.oxGroup.appendChild(path.render());\n\n      this.charts[name] = path;\n\n    });\n  }\n\n  /**\n   * Create a 'line' charts\n   */\n  drawLineCharts(){\n    this.modules.state.linesAvailable.forEach( name => {\n      /**\n       * Array of chart Y values\n       */\n      const values = this.modules.state.getLinePoints(name);\n\n      /**\n       * Color of drawing line\n       */\n      const color = this.modules.state.getLineColor(name);\n\n      /**\n       * Point to from which we will start drawing\n       */\n      const leftPoint = values[0];\n\n      this.kY = this.height / (this.maxPoint - this.minPoint);\n      this.zeroShifting = this.minPoint * this.kY;\n\n      /**\n       * Create a Path instance\n       */\n      const path = new Path({\n        canvasHeight: this.height,\n        max: this.maxPoint,\n        min: this.minPoint,\n        color,\n        zeroShifting: this.zeroShifting,\n        kY: this.kY,\n        stroke: this.strokeWidth,\n        stepX: this.stepX,\n      });\n\n      path.moveTo(0, leftPoint);\n\n      values.forEach( (column, index )=> {\n        if (index === 0){\n          path.stepTo(column, true);\n        } else {\n          path.stepTo(column);\n        }\n      });\n\n      this.oxGroup.appendChild(path.render());\n\n      this.charts[name] = path;\n    });\n  }\n\n  scroll(newLeft){\n    this.oxGroup.style.transform = `matrix(${this.modules.chart.scaling},0,0,1,${newLeft},0)`;\n  }\n\n  /**\n   * Scale left legend\n   * @param {number} scaling\n   */\n  scaleLines(scaling){\n    this.oxGroup.style.transform = `scaleX(${scaling})`;\n    this.width = this.initialWidth * scaling;\n  }\n\n  get step(){\n    return this.stepX;\n  }\n\n  /**\n   * Scale path on OY\n   * @param {number} newMax - new max value\n   */\n  scaleToMaxPoint(newMax, newMin, line){\n    // console.log('newMax, newMin, line', newMax, newMin, line);\n    // newMax = Numbers.round(newMax);\n    // console.warn('min', newMin, Numbers.roundToMin(newMin, (newMax - newMin) / 5));\n\n    newMin = Numbers.roundToMin(newMin, (newMax - newMin) / 5);\n\n\n    let max, kY, zeroShifting;\n\n    if (!this.modules.state.isYScaled){\n      max = this.maxPoint;\n      kY = this.kY;\n\n      // area and bars\n      if (!this.zeroShifting || !newMin){\n        this.oyScaling = max / newMax;\n        this.oyGroup.style.transform = `scaleY(${this.oyScaling})`;\n        return;\n      }\n\n      let newKY = this.height / (newMax - newMin);\n      let newZeroShifting = newMin * kY;\n      let shift = newZeroShifting - this.zeroShifting;\n\n      this.oyScaling = newKY / kY;\n      this.zeroShiftingScaling = shift !== 0 ? newZeroShifting / this.zeroShifting  : 1;\n      this.currentMinimum = newMin;\n\n      this.oyGroup.style.transform = `scaleY(${this.oyScaling}) translateY(${shift}px)`;\n\n    } else {\n      const chart = this.charts[line];\n      max = chart.max;\n      kY = chart.kY;\n      zeroShifting = chart.zeroShifting;\n\n\n      let newKY = this.height / (newMax - newMin);\n      let newZeroShifting = newMin * kY;\n      let shift = newZeroShifting - zeroShifting;\n\n      // need to store somewhere\n      let oyScaling = newKY / kY;\n      let zeroShiftingScaling = shift !== 0 ? newZeroShifting / zeroShifting  : 1;\n      chart.currentMinimum = newMin;\n\n      chart.path.style.transform = `scaleY(${oyScaling}) translateY(${shift}px)`;\n      // chart.path.setAttribute('transform', `scale(1 ${oyScaling}) translate(0, ${shift})`);\n    }\n  }\n\n  /**\n   * Change bars height and Y to fit hidden charts place\n   */\n  recalculatePointsHeight(useRecalculated = false){\n    if (this.modules.state.type === 'bar'){\n      this.recalculateBars(useRecalculated);\n    } else if (this.modules.state.type === 'area') {\n      this.recalculateArea(useRecalculated);\n    }\n  }\n\n  recalculateArea(useRecalculated = false){\n    const pointsCount = this.modules.state.daysCount;\n    const stacks = this.modules.state.getStacks();\n\n    let recalculated = this.modules.state.recalculatedValues;\n\n    if (useRecalculated && recalculated) {\n      for (let i = 0, lenCached = recalculated.length; i < lenCached; i++) {\n        if (recalculated[i][1] === 0){\n          this.charts[recalculated[i][0]].move(recalculated[i][1], recalculated[i][2], recalculated[i][3], true);\n        } else {\n          this.charts[recalculated[i][0]].move(recalculated[i][1], recalculated[i][2], recalculated[i][3]);\n        }\n      }\n\n      this.modules.state.clearRecalculatedValues();\n      return;\n    }\n\n    let lines = this.modules.state.linesAvailable.filter(line => this.checkPathVisibility(line)).reverse();\n\n    for (let pointIndex = 0; pointIndex < pointsCount; pointIndex++) {\n      let prevValue = 0;\n      let hiddenPointsValue = this.hiddenCharts.reduce( (val, line) => {\n        return val + this.modules.state.getLinePoints(line)[pointIndex];\n      }, 0);\n\n      for (let i = 0, lenCached = lines.length; i < lenCached; i++) {\n        let newStack = stacks[pointIndex] - hiddenPointsValue;\n        let pointValue = this.modules.state.getLinePoints(lines[i])[pointIndex];\n\n        this.modules.state.saveRecalculatedValues([lines[i], pointIndex, newStack, prevValue]);\n\n        if (pointIndex === 0){\n          this.charts[lines[i]].move(pointIndex, newStack, prevValue, true);\n        } else {\n          this.charts[lines[i]].move(pointIndex, newStack, prevValue);\n        }\n\n        prevValue += pointValue;\n      }\n    }\n\n    Object.entries(this.charts).filter(([line, area]) => this.checkPathVisibility(line)).forEach(([line, area]) => {\n      area.update();\n    });\n  }\n\n  /**\n   * Changes bars heights to correspond hidden charts\n   * @param {boolean} useRecalculated - pass true to use saved value (minimap can use values from main Chart)\n   */\n  recalculateBars(useRecalculated = false){\n    const pointsCount = this.modules.state.daysCount;\n    const stacks = this.modules.state.getStacks();\n\n    let recalculated = this.modules.state.recalculatedValues;\n\n    if (useRecalculated && recalculated) {\n      for (let i = 0, lenCached = recalculated.length; i < lenCached; i++) {\n        this.charts[recalculated[i][0]].move(recalculated[i][1], recalculated[i][2], recalculated[i][3]);\n      }\n\n      this.modules.state.clearRecalculatedValues();\n      return;\n    }\n\n    let lines = this.modules.state.linesAvailable.filter(line => this.checkPathVisibility(line)).reverse();\n\n    for (let pointIndex = 0; pointIndex < pointsCount; pointIndex++) {\n      let prevValue = 0;\n\n      let hiddenPointsValue = this.hiddenCharts.reduce( (val, line) => {\n        return val + this.modules.state.getLinePoints(line)[pointIndex];\n      }, 0);\n\n      for (let i = 0, lenCached = lines.length; i < lenCached; i++) {\n        let newStack = stacks[pointIndex] - hiddenPointsValue;\n        let pointValue = this.modules.state.getLinePoints(lines[i])[pointIndex];\n\n\n        this.modules.state.saveRecalculatedValues([lines[i], pointIndex, newStack, prevValue]);\n        this.charts[lines[i]].move(pointIndex, newStack, prevValue);\n\n        prevValue += pointValue;\n      }\n    }\n  }\n\n  checkPathVisibility(name){\n    return !this.charts[name].isHidden;\n  }\n\n  togglePathVisibility(name, status){\n    this.charts[name].toggleVisibility(status);\n  }\n}\n","export function round(number) {\n  let zeros = Math.log10(number) >> 0;\n  let rounding = Math.pow(10, zeros);\n\n  return Math.round(number / rounding) * rounding;\n}\n\nexport function roundToMin(number, maxSlicing) {\n  let zeros = Math.log10(number) >> 0;\n  let rounding = Math.pow(10, zeros);\n  let result = Math.floor(number / rounding) * rounding;\n\n  // console.log(number, ' -> zeros', zeros, 'r' , rounding, maxSlicing);\n\n  if (number - result > maxSlicing){\n    // let old  =result;\n    rounding = Math.pow(10, zeros - 1);\n    result = Math.floor(number / rounding) * rounding;\n    // console.warn('descreasing', old, result)\n  }\n\n  return result;\n}\n\nexport function beautify(number) {\n  if (number < 1000) {\n    return number\n  } else if (number < 10000){\n      let thousands = Math.floor(number / 1000);\n      let left = number - thousands * 1000;\n\n      if (left === 0){\n        return thousands + ' 000';\n      } else if (left >= 100){\n        return thousands + ' ' + left;\n      } else if (left > 10) {\n        return thousands + ' 0' + left;\n      } else {\n        return thousands + ' 0' + left;\n      }\n  } else if (number < 1000000) {\n      return Math.floor(number / 1000) + 'k';\n  } else {\n    return Math.floor(number / 1000000) + 'M';\n  }\n}\n\n/**\n * 1000 -> 1 000\n * @param {number} number\n * @return {string}\n */\nexport function addSpaces(number) {\n  if (isNaN(parseInt(number, 10))){\n    return '';\n  }\n\n  return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ' ');\n}\n","import * as Dom from '../utils/dom.js';\nimport * as Event from '../utils/event.js';\nimport debounce from '../utils/debounce.js';\nimport Graph from './graph.js';\nimport log from '../utils/log.js';\n\n\n/**\n * Module for working with Chart Mini map\n * - Render UI\n * - Render graphs\n * - Scaling\n * - Scrolling\n */\nexport default class Minimap {\n  /**\n   * Graphon\n   * @param modules\n   */\n  constructor(modules){\n    this.modules = modules;\n    this.nodes = {\n      wrapper: undefined,\n      canvas: undefined,\n\n      leftZone: undefined,\n      leftZoneScaler: undefined,\n      rightZone: undefined,\n      rightZoneScaler: undefined,\n      centerZone: undefined\n    };\n\n    this.wrapperWidthCached = undefined;\n    this.viewportWidth = 100;\n    this.viewportWidthInitial = 100;\n    this.viewportOffsetLeft = 0;\n    this.scalerWidth = 14;\n\n    /**\n     * Remember width on touch start\n     */\n    this.viewportWidthBeforeDrag = undefined;\n\n    /**\n     * Clicked pageX\n     */\n    this.moveStartX = undefined;\n\n    /**\n     * Clicked layerX\n     */\n    this.wrapperLeftCoord = undefined;\n\n    /**\n     * Indicator that viewport zone is dragged\n     */\n    this.viewportPressed = false;\n\n    /**\n     * Indicator that left scaler zone is dragged\n     */\n    this.leftScalerClicked = false;\n\n    /**\n     * Indicator that right scaler zone is dragged\n     */\n    this.rightScalerClicked = false;\n\n    /**\n     * Scale debounce\n     */\n    this.scaleDebounce = undefined;\n\n    /**\n     * Cache for zones size\n     */\n    this.leftZoneWidth = 0;\n    this.rightZoneWidth = 0;\n\n    /**\n     * Wrapper rect cache\n     * @type {ClientRect}\n     */\n    this.wrapperRect = null;\n\n    this.prevX = 0;\n\n    this.graph = new Graph(this.modules, {\n      stroke: 1,\n      animate: true\n    });\n  }\n\n  static get CSS(){\n    return {\n      wrapper: 'tg-minimap',\n      leftZone: 'tg-minimap__left',\n      leftZoneScaler: 'tg-minimap__left-scaler',\n      rightZone: 'tg-minimap__right',\n      rightZoneScaler: 'tg-minimap__right-scaler',\n      centerZone: 'tg-minimap__center',\n    }\n  }\n\n  /**\n   * Prepares minimap UI\n   * @return {Element}\n   */\n  renderUi(){\n    this.nodes.wrapper = Dom.make('div', Minimap.CSS.wrapper);\n    this.nodes.leftZone = Dom.make('div', Minimap.CSS.leftZone);\n    this.nodes.centerZone = Dom.make('div', Minimap.CSS.centerZone);\n    this.nodes.rightZone = Dom.make('div', Minimap.CSS.rightZone);\n    this.nodes.leftZoneScaler = Dom.make('div', Minimap.CSS.leftZoneScaler);\n    this.nodes.rightZoneScaler = Dom.make('div', Minimap.CSS.rightZoneScaler);\n\n    this.nodes.leftZone.appendChild(this.nodes.leftZoneScaler);\n    this.nodes.rightZone.appendChild(this.nodes.rightZoneScaler);\n\n    this.nodes.wrapper.appendChild(this.nodes.leftZone);\n    this.nodes.wrapper.appendChild(this.nodes.centerZone);\n    this.nodes.wrapper.appendChild(this.nodes.rightZone);\n\n    /**\n     * Wait dom appending\n     */\n    setTimeout(() => {\n      this.wrapperRect = this.nodes.wrapper.getBoundingClientRect();\n    }, 100);\n\n    this.bindEvents();\n\n    return this.nodes.wrapper;\n  }\n\n  /**\n   * Fill UI with chart and set initial Position\n   */\n  renderMap(){\n    if (this.nodes.canvas){\n      this.nodes.canvas.remove();\n    }\n\n    this.nodes.canvas = this.graph.renderCanvas({\n      width: this.nodes.wrapper.offsetWidth,\n      height: this.nodes.wrapper.offsetHeight\n    });\n\n    this.graph.renderCharts();\n\n    this.setInitialPosition();\n\n    this.nodes.wrapper.appendChild(this.nodes.canvas);\n  }\n\n  /**\n   * Return width of a mini map\n   * @return {number}\n   */\n  get wrapperWidth(){\n    return this.wrapperWidthCached || this.nodes.wrapper.offsetWidth;\n  }\n\n  /**\n   * Compute current minimap width\n   * @return {number}\n   */\n  get width(){\n    return this.wrapperWidth - this.leftZoneWidth - this.rightZoneWidth;\n  }\n\n  /**\n   * Left zone width setter\n   */\n  set leftWidth(val){\n    this.leftZoneWidth = val;\n    this.nodes.leftZone.style.width = val + 'px';\n    this.nodes.centerZone.style.left = val + this.scalerWidth + 'px';\n  }\n\n  /**\n   * Right zone width setter\n   */\n  set rightWidth(val){\n    this.rightZoneWidth = val;\n    this.nodes.rightZone.style.width = val + 'px';\n  }\n\n  /**\n   * Set new with to the minimap's viewport\n   * @param {number} value\n   */\n  set width(value){\n    const scrollDistance = this.modules.chart.scrollDistance;\n\n    this.leftWidth = scrollDistance;\n    this.rightWidth = this.wrapperWidth - scrollDistance - value;\n\n    this.viewportWidth = value;\n    this.centerWidth = value;\n  }\n\n  set centerWidth(value){\n    this.nodes.centerZone.style.width = (value - this.scalerWidth*2) + 'px';\n  }\n\n  /**\n   * Initial width and offset\n   */\n  setInitialPosition(){\n    let rect = this.nodes.wrapper.getBoundingClientRect();\n    this.wrapperWidthCached = rect.width;\n    this.wrapperLeftCoord = rect.left;\n\n    this.width = this.modules.chart.minimalMapWidth;\n\n    this.viewportWidthInitial = this.viewportWidthBeforeDrag = this.width;\n    this.viewportOffsetLeft = this.wrapperWidth - this.viewportWidthInitial;\n    // this.viewportOffsetLeft = 0;\n    this.moveViewport(this.viewportOffsetLeft);\n    this.syncScrollWithChart(this.viewportOffsetLeft);\n    this.modules.chart.fitToMax();\n  }\n\n  /**\n   * Current scroll value\n   * @return {number}\n   */\n  get scrolledValue(){\n    return this.leftZoneWidth;\n  }\n\n  /**\n   * Value of left zone width minimum\n   */\n  get leftZoneMinimumWidth(){\n    return 0;\n  }\n\n  /**\n   * Value of left zone width maximum\n   */\n  get leftZoneMaximumWidth(){\n    return this.wrapperWidth - this.viewportWidthInitial - this.rightZoneWidth;\n  }\n\n  /**\n   * Value of right zone width minimum\n   */\n  get rightZoneMinimumWidth(){\n    return this.viewportWidthInitial;\n  }\n\n  /**\n   * Value of right zone width maximum\n   */\n  get rightZoneMaximumWidth(){\n    return this.wrapperWidth - this.viewportWidthInitial - this.scrolledValue;\n  }\n\n  /**\n   * Moves viewport from left for passed value\n   * @param {string} offsetLeft\n   */\n  moveViewport(offsetLeft){\n    // log({offsetLeft})\n    const width = this.width;\n    const maxLeft = this.wrapperWidth - width;\n    const minLeft = this.leftZoneMinimumWidth;\n\n    let newLeft = this.viewportOffsetLeft + offsetLeft;\n\n    if (newLeft < minLeft){\n      newLeft = minLeft;\n    } else if (newLeft > maxLeft){\n      newLeft = maxLeft;\n    }\n    this.leftWidth = newLeft;\n    this.rightWidth = this.wrapperWidth - this.viewportWidthBeforeDrag - newLeft;\n  }\n\n  bindEvents(){\n    let supportsPassive = false;\n    try {\n      let opts = Object.defineProperty({}, 'passive', {\n        get: function() {\n          supportsPassive = true;\n        }\n      });\n      window.addEventListener(\"testPassive\", null, opts);\n      window.removeEventListener(\"testPassive\", null, opts);\n    } catch (e) {}\n\n\n    this.nodes.wrapper.addEventListener('mousedown', (event) => {\n      this.viewportMousedown(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    window.addEventListener('mousemove', (event) => {\n      this.viewportMousemove(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    window.addEventListener('mouseup', (event) => {\n      this.viewportMouseup(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    this.nodes.wrapper.addEventListener('touchstart', (event) => {\n      this.viewportMousedown(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    this.nodes.wrapper.addEventListener('touchmove', (event) => {\n      this.viewportMousemove(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    this.nodes.wrapper.addEventListener('touchend', (event) => {\n      this.viewportMouseup(event);\n    }, supportsPassive ? { passive: true } : false);\n  }\n\n  /**\n   * Viewport under finger\n   * @param {MouseEvent|TouchEvent} event\n   */\n  viewportMousedown(event){\n    const {target} = event;\n\n    // event.preventDefault();\n\n    const leftScalerClicked = !!target.closest(`.${Minimap.CSS.leftZoneScaler}`);\n    const rightScalerClicked = !!target.closest(`.${Minimap.CSS.rightZoneScaler}`);\n\n    this.viewportWidthBeforeDrag = this.width;\n    this.moveStartX = Event.getPageX(event);\n\n    if (leftScalerClicked || rightScalerClicked){\n      this.leftScalerClicked = leftScalerClicked;\n      this.rightScalerClicked = rightScalerClicked;\n      this.viewportPressed = false;\n      return;\n    }\n\n\n    this.viewportPressed = true;\n  }\n\n  /**\n   * Viewport dragged\n   * @param {MouseEvent} event\n   */\n  viewportMousemove(event){\n    if (this.viewportPressed){\n      this.viewportDragged(event);\n    } else if (this.leftScalerClicked){\n      this.scalerDragged(event, 'left');\n    } else if (this.rightScalerClicked){\n      this.scalerDragged(event, 'right');\n    }\n  }\n\n  viewportMouseup(){\n    if (this.viewportPressed){\n      this.finishSliding();\n    } else if (this.leftScalerClicked){\n      this.finishLeftScaling();\n    } else if (this.rightScalerClicked){\n      this.finishRightScaling();\n    }\n  }\n\n  finishSliding(){\n    this.viewportPressed = false;\n    this.viewportOffsetLeft = this.scrolledValue;\n\n\n    // let start = null;\n    //\n    // // console.log('direction', direction);\n    //\n    // let step = (timestamp) => {\n    //   if (!start) start = timestamp;\n    //   var progress = timestamp - start;\n    //   let forTo = Math.min(progress / this.prevX, 500);\n    //\n    //   console.log('forTo', this.prevX, progress);\n    //\n    //   // console.log('progress', progress);\n    //   this.moveViewport(forTo * 5);\n    //   // element.style.transform = 'translateX(' + Math.min(progress / 10, 200) + 'px)';\n    //   if (progress < 100) {\n    //     window.requestAnimationFrame(step);\n    //   }\n    // }\n\n    // window.requestAnimationFrame(step);\n  }\n\n  finishLeftScaling(){\n    this.leftScalerClicked = false;\n    this.viewportOffsetLeft = this.scrolledValue;\n  }\n\n  finishRightScaling(){\n    this.rightScalerClicked = false;\n    this.viewportOffsetLeft = this.scrolledValue;\n  }\n\n  /**\n   * @param {MouseEvent} event\n   */\n  viewportDragged(event){\n    let delta = Event.getPageX(event) - this.moveStartX;\n\n    // let direction = this.prevX < delta ? 'right' : 'left';\n\n    let prevScrolledValue = this.scrolledValue;\n\n    // this.prevX = delta + 0;\n    this.moveViewport(delta);\n    // console.log('delta', delta);\n    // this.modules.chart.scrollByDelta((prevScrolledValue - delta) * this.modules.chart.width / this.wrapperWidth );\n\n    this.syncScrollWithChart();\n\n    if (this._ftmd){\n      clearTimeout(this._ftmd);\n    }\n\n    this._ftmd = setTimeout(() => {\n      this.modules.chart.fitToMax(true);\n    }, 50)\n\n  }\n\n  /**\n   * Sync scroll between minimap and chart\n   * @param {number} [newScroll] - pass scroll if you have\n   */\n  syncScrollWithChart(newScroll = null, fromScale = false){\n    // console.log('this.scrolledValue', this.scrolledValue);\n    /**\n     * How many percents of mini-map is scrolled\n     */\n    let scrolledValue = !isNaN(parseInt(newScroll)) ? newScroll : this.scrolledValue;\n    const minimapScrolledPortion = scrolledValue / this.wrapperWidth;\n    const chartScroll = minimapScrolledPortion * this.modules.chart.width;\n\n    this.modules.chart.scroll(chartScroll, fromScale);\n  }\n\n  /**\n   * Viewport side-scaler is moved\n   * @param {MouseEvent|TouchEvent} event\n   * @param {string} side  'left' or 'right'\n   */\n  scalerDragged(event, side){\n    let pageX = Event.getPageX(event);\n    let delta = pageX - this.moveStartX;\n\n    let direction = this.prevX < pageX ? 'right' : 'left';\n\n    if (pageX > this.wrapperRect.right || pageX < this.wrapperRect.left){\n      return;\n    }\n\n    if (!delta || this.prevX === pageX){\n      return;\n    }\n\n    this.prevX = pageX + 0;\n\n    let newScalerWidth;\n\n    if (side === 'left'){\n      delta = delta * -1;\n      newScalerWidth = Math.max(0, this.viewportOffsetLeft - delta);\n\n      if (newScalerWidth > this.leftZoneMaximumWidth) {\n        return;\n      }\n\n      this.leftWidth = newScalerWidth;\n\n      this.centerWidth = (this.wrapperWidth - newScalerWidth - this.rightZoneWidth)\n\n    } else {\n      newScalerWidth = Math.max(0, this.wrapperWidth - this.viewportOffsetLeft - (this.viewportWidthBeforeDrag + delta));\n\n      if (newScalerWidth > this.rightZoneMaximumWidth){\n        return;\n      }\n\n      this.rightWidth = newScalerWidth;\n      this.centerWidth = (this.wrapperWidth - newScalerWidth - this.leftZoneWidth)\n    }\n\n    const newViewportWidth = side === 'left' ?\n      this.wrapperWidth - newScalerWidth - this.rightZoneWidth :\n      this.wrapperWidth - this.leftZoneWidth - newScalerWidth;\n\n    const scaling = this.viewportWidthInitial / newViewportWidth * this.modules.chart.initialScale;\n\n    this.modules.chart.scale(scaling, direction);\n    this.syncScrollWithChart(side === 'left' ? newScalerWidth : this.leftZoneWidth, true);\n\n    if (this._ftmd){\n      clearTimeout(this._ftmd);\n    }\n\n    this._ftmd = setTimeout(() => {\n      this.modules.chart.fitToMax();\n    }, 20)\n  }\n\n  /**\n   * Toggle path visibility\n   * @param {string} name - graph name\n   */\n  togglePath(name, status){\n    this.graph.togglePathVisibility(name, status);\n\n    if (this.modules.state.type === 'bar'){\n      this.graph.recalculatePointsHeight(true);\n      this.fitToMax();\n    } else if (this.modules.state.type === 'area') {\n      this.graph.recalculatePointsHeight(true);\n    } else {\n      this.fitToMax();\n    }\n  }\n\n  /**\n   * Upscale or downscale graph to fit visible points\n   */\n  fitToMax(){\n    if (this.modules.state.type !== 'area'){\n      if (!this.modules.state.isYScaled){\n        this.graph.scaleToMaxPoint(this.graph.getMaxFromVisible());\n      } else {\n        this.modules.state.linesAvailable.filter(line => this.modules.chart.notHiddenGraph(line)).forEach((line) => {\n          this.graph.scaleToMaxPoint(this.graph.getMaxFromVisible(line), undefined, line);\n        })\n      }\n    }\n  }\n}","import * as Dom from '../utils/dom.js';\nimport * as Numbers from '../utils/numbers';\n\nexport default class Tooltip {\n  /**\n   * @param {Graphon} modules\n   */\n  constructor(modules){\n    this.modules = modules;\n    this.nodes = {\n      wrapper:  undefined,\n      title: undefined,\n      values: undefined\n    };\n\n    this._width = 0;\n    this._values = [];\n  }\n\n  /**\n   * CSS map\n   * @return {{wrapper: string, title: string, values: string, value: string}}\n   */\n  static get CSS(){\n    return {\n      wrapper: 'tg-tooltip',\n      showed: 'tg-tooltip--showed',\n      title: 'tg-tooltip__title',\n      values: 'tg-tooltip__values',\n      value: 'tg-tooltip__values-item',\n      valueTitle: 'tg-tooltip__values-item-title',\n    }\n  }\n\n  render(){\n    this.nodes.wrapper = Dom.make('div', Tooltip.CSS.wrapper);\n    this.nodes.title = Dom.make('div', Tooltip.CSS.title);\n    this.nodes.values = Dom.make('div', Tooltip.CSS.values);\n\n    this.nodes.wrapper.appendChild(this.nodes.title);\n    this.nodes.wrapper.appendChild(this.nodes.values);\n\n    return this.nodes.wrapper;\n  }\n\n  show(){\n    this.nodes.wrapper.classList.add(Tooltip.CSS.showed);\n  }\n\n  hide(){\n    this.nodes.wrapper.classList.remove(Tooltip.CSS.showed);\n  }\n\n  move(lineLeftCoord, values){\n    if (!this._width){\n      this._width = this.nodes.wrapper.offsetWidth;\n    }\n\n    let max = Math.max(...values.map(value => value.value));\n    let maxBottom = max * this.modules.chart.graph.kY - this.modules.chart.graph.zeroShifting;\n\n    let offsetLeft = -25;\n    let left = lineLeftCoord + offsetLeft;\n\n    if (maxBottom > 260) {\n      left = left - this._width;\n    }\n\n    if (left < this._width + 25){\n      left = lineLeftCoord + 25\n    }\n\n    if (left + this._width > this.modules.chart.viewportWidth){\n      left = left - this._width;\n    }\n\n    //\n    // if (left + this._width > this.modules.chart.viewportWidth){\n    //   left = this.modules.chart.viewportWidth - this._width - 30;\n    // }\n\n\n    // if (lineLeftCoord > this.modules.chart.viewportWidth - tooltipWidth / 1.3){\n    //   offsetLeft = -1.3 * tooltipWidth;\n    // } else if (lineLeftCoord > this.modules.chart.viewportWidth - tooltipWidth ){\n    //   offsetLeft = -0.8 * tooltipWidth;\n    // } else if (lineLeftCoord < 45){\n    //   offsetLeft = 20;\n    // }\n\n    this.nodes.wrapper.style.left = `${left}px`;\n  }\n\n  clear(){\n    this.nodes.title.textContent = '';\n    this.nodes.values.innerHTML = '';\n  }\n\n  /**\n   * Render values of current hovered points\n   * @param {{name: string, value: number}[]} values\n   */\n  set values(values){\n    this.clear();\n\n    const prevValues = this._values;\n\n    this._values = [];\n\n    if (this._setValuesDebounce){\n      clearTimeout(this._setValuesDebounce);\n    }\n\n    let summ = 0;\n\n    for (let i = 0, lenCached = values.length; i < lenCached; i++) {\n      summ += values[i].value;\n    }\n\n    if (values.length > 2){\n      this._setValuesDebounce = setTimeout(() => {\n        values.forEach( ({name, value}, index) => {\n          this.createItem(this.modules.state.names[name], this.modules.state.colors[name], value, prevValues[index], index, values)\n        });\n\n        if (this.modules.state.type === 'bar' && values.length > 1){\n          this.createItem('All', '#000', summ, null, values.length, values, true)\n        }\n      }, 150)\n\n    } else {\n        values.forEach( ({name, value}, index) => {\n          this.createItem(this.modules.state.names[name], this.modules.state.colors[name], value, prevValues[index], index, values)\n        });\n\n        if (this.modules.state.type === 'bar' && values.length > 1){\n          this.createItem('All', '#000', summ, null, values.length, values, true)\n          // this.createItem('All', '#fff', null, values.length, values, true)\n        }\n    }\n\n  }\n\n  createItem(title, color, value, prevValue, index = 0, all, isAll= false){\n    const item = Dom.make('div', Tooltip.CSS.value);\n    const counter = Dom.make('b');\n\n    if (isAll){\n      item.classList.add('all');\n    }\n\n    if (this.modules.state.type === 'area'){\n      let total = all.reduce((acc, cur) => acc += cur.value, 0);\n      let percent = Math.ceil((value / total) * 100);\n\n      /**\n       * Case for zero values\n       */\n      if (isNaN(percent)){\n        percent = 0;\n      }\n\n      let percentEl = Dom.make('span', 'percents');\n\n      percentEl.textContent = percent + '%';\n\n      item.appendChild(percentEl)\n    }\n\n    let titleEl = Dom.make('span', Tooltip.CSS.valueTitle);\n\n    titleEl.textContent = title;\n\n    item.appendChild(titleEl);\n    item.appendChild(counter);\n\n    counter.style.color = color;\n\n    let valueBeautified = Numbers.addSpaces(value);\n\n    setTimeout(() => {\n      Dom.animateCounter(counter, valueBeautified, prevValue);\n    }, 50 * index);\n\n\n    this.nodes.values.appendChild(item);\n    this._values.push(valueBeautified);\n  }\n\n  set title(string){\n    this.nodes.title.innerHTML = string;\n  }\n\n  /**\n   * @param {Date} dt\n   */\n  set date(dt){\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    const week = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n    let month = dt.getMonth();\n    let year = dt.getFullYear();\n    let weekday = dt.getDay();\n    let day = dt.getDate();\n    let left = Dom.make('span', 'left');\n    let right = Dom.make('span');\n\n    let newDate = ''\n\n    if (!this.modules.state.byMonth){\n      newDate =   `${week[weekday]}, ${day}`;\n      right.textContent = months[month] + ' ' + year;\n    } else {\n      newDate = months[month] + ' ';\n      right.textContent = year;\n    }\n\n    this.nodes.title.innerHTML = '';\n    this.nodes.title.appendChild(left);\n    this.nodes.title.appendChild(right);\n\n\n\n    Dom.animateCounter(left, newDate, this._prevDate, 'top' );\n    this._prevDate = newDate\n  }\n}","import * as Dom from \"../utils/dom\";\n\n/**\n * Line with current values pointers\n */\nexport default class Pointer {\n  constructor(modules){\n    this.modules = modules;\n    this.nodes = {\n      wrapper: undefined,\n    };\n    this.pointers = {};\n  }\n\n  /**\n   * CSS map\n   * @return {{wrapper: string, showed: string, pointer: string}}\n   * @constructor\n   */\n  static get CSS(){\n    return {\n      wrapper: 'tg-pointer',\n      showed: 'tg-pointer--showed',\n      pointer: 'tg-pointer__pointer',\n      pointerHidden: 'tg-pointer__pointer--hidden'\n    }\n  }\n\n  render(){\n    this.nodes.wrapper = Dom.make('div', Pointer.CSS.wrapper);\n    this.nodes.wrapper.style.height = `${this.modules.state.height}px`;\n    return this.nodes.wrapper;\n  }\n\n  show(){\n    this.nodes.wrapper.classList.add(Pointer.CSS.showed);\n  }\n\n  hide(){\n    this.nodes.wrapper.classList.remove(Pointer.CSS.showed);\n  }\n\n  move(leftPx){\n    this.show();\n    this.nodes.wrapper.style.left = `${leftPx}px`;\n  }\n\n  toggleVisibility(name){\n    if (this.pointers[name]) {\n      this.pointers[name].classList.toggle(Pointer.CSS.pointerHidden)\n    }\n  }\n\n  /**\n   * Show circles\n   * @param {{name: string, value: number}[]} values\n   */\n  showValues(values){\n    if (this.modules.state.type === 'area'){\n      if (Object.keys(this.pointers).length){\n        Object.values(this.pointers).forEach((el) => {\n          el.remove();\n        });\n\n        this.pointers = {};\n      }\n      return;\n    }\n\n    if (!Object.keys(this.pointers).length){\n      values.forEach( ({name}) => {\n        const item = Dom.make('div', Pointer.CSS.pointer);\n\n        item.style.borderColor = this.modules.state.colors[name];\n        this.nodes.wrapper.appendChild(item);\n        this.pointers[name] = item;\n      })\n    }\n\n    /**\n     * @type {Graph}\n     */\n    const {graph} = this.modules.chart;\n\n    values.forEach( ({name, value}) => {\n      const item = this.pointers[name];\n      const currentZero = graph.currentMinimum;\n      const valueFromZero = value - currentZero;\n      const coord = valueFromZero * graph.kYScaled;\n\n      // item.style.bottom = `${coord}px`;\n      item.style.transform = `translateY(-${coord}px)`;\n    })\n\n  }\n}","import * as Dom from '../utils/dom.js';\nimport Graph from './graph.js';\nimport Tooltip from \"./tooltip\";\nimport Pointer from \"./pointer\";\nimport * as Event from '../utils/event.js';\n\nimport log from '../utils/log.js';\nimport * as Numbers from \"../utils/numbers\";\nimport Bar from \"./bar\";\n\n/**\n * Module for working with main Chart zone\n * - Render UI\n * - Render axes\n * - Render graphs\n * - Toggle lines visibility\n */\nexport default class Chart {\n  /**\n   * @param {Graphon} modules\n   */\n  constructor(modules){\n    this.modules = modules;\n    this.nodes = {\n      wrapper: undefined,\n      viewport: undefined,\n      canvas: undefined,\n      cursorLine: undefined,\n      grid: undefined,\n      gridLines: [],\n      legend: undefined,\n      legendDates: [],\n      overlays: undefined,\n      overlayLeft: undefined,\n      overlayRight: undefined,\n\n    };\n\n    this.tooltip = new Tooltip(this.modules);\n    this.pointer = new Pointer(this.modules);\n    this.graph = new Graph(this.modules, {\n      stroke: 2\n    });\n\n    this.wrapperLeftCoord = undefined;\n    this.scaling = 1;\n    this.scrollValue = 0;\n\n\n\n    this.legendDateWidth = 40;\n    this.legendDateWidthMargins = 20 * 2;\n    this.legendDatesHidedTimes = 0;\n    this.legendDatesRecentlyHided = false;\n\n\n    /**\n     * Set will be store indexes of visible dates\n     * @type {Set<number>}\n     */\n    this.onscreenDates = new Set();\n    this.onscreenDatesElements = {}; // origin index -> element mapping\n    this._datesPerScreenInitial = undefined;\n    this._showEveryNDateInitial = undefined;\n\n    /**\n     * Any properties can be cached here\n     * @type {{}}\n     */\n    this.cache = {};\n\n    this._initialScale = undefined;\n    this._initialStep = undefined;\n    this._hoveredPointIndex = undefined;\n  }\n\n  get initialStep(){\n    if (!this._initialStep){\n      this._initialStep = this.width / (this.modules.state.daysCount - 1);\n    }\n    return this._initialStep;\n  }\n\n  get minimalMapWidth(){\n    return Math.max(80, Math.ceil(this.viewportWidth / this.modules.state.daysCount) * 4); // 4 dates minimum\n  }\n\n  get initialScale(){\n    return this._initialScale;\n  }\n\n  /**\n   * Get initial scaling corresponded with minimal minimap width\n   */\n  calculateInitialValues(){\n    /**\n     * Width of viewport when chart is not scaled\n     * @type {number}\n     */\n    const chartToViewportRatio = this.viewportWidth / this.width;\n    const originalWidth = this.viewportWidth * chartToViewportRatio;\n    const scaledViewportRatio = this.minimalMapWidth / originalWidth;\n\n    const originalScalingChange = this.scaling / scaledViewportRatio;\n\n    this.initialScale = originalScalingChange;\n\n    // log({scaling: this.scaling});\n  }\n\n  set initialScale(value){\n    this._initialScale = value;\n    this.scale(value);\n  }\n\n  /**\n   * CSS map\n   * @return {{wrapper: string, viewport: string, cursorLine: string}}\n   */\n  static get CSS(){\n    return {\n      wrapper: 'tg-chart',\n      viewport: 'tg-chart__viewport',\n      grid: 'tg-grid',\n      gridSection: 'tg-grid__section',\n      gridSectionHidden: 'tg-grid__section--hidden',\n      gridCounter: 'tg-grid__counter',\n      gridCounterHidden: 'tg-grid__counter--hidden',\n      gridCounterFirst: 'tg-grid__counter--first',\n      gridCounterSecond: 'tg-grid__counter--second',\n      dateHidden: 'tg-legend__date--hidden',\n      overlays: 'tg-chart__overlays',\n      overlayLeft: 'tg-chart__overlay-left',\n      overlayRight: 'tg-chart__overlay-right',\n    }\n  }\n\n  get stepX(){\n    return this.graph.stepX;\n  }\n\n  get stepY(){\n    return this.graph.stepY;\n  }\n\n  get maxPoint(){\n    return this.graph.maxPoint;\n  }\n\n  get height(){\n    return this.graph.height;\n  }\n\n  /**\n   * Total chart width\n   * @return {number}\n   */\n  get width(){\n    return this.graph.width;\n  }\n\n  /**\n   * Return current scroll distance\n   * @return {number}\n   */\n  get scrollDistance() {\n    return this.scrollValue * this.scaling;\n  }\n\n  /**\n   * Visible viewport width\n   * @return {number}\n   */\n  get viewportWidth(){\n    if (this.cache.viewportWidth){\n      return this.cache.viewportWidth;\n    }\n\n    this.cache.viewportWidth = this.nodes.wrapper.offsetWidth;\n    return this.cache.viewportWidth;\n  }\n\n  /**\n   * Visible viewport height\n   * @return {number}\n   */\n  get viewportHeight(){\n    if (this.cache.viewportHeight){\n      return this.cache.viewportHeight;\n    }\n\n    this.cache.viewportHeight = this.nodes.wrapper.offsetHeight;\n    return this.cache.viewportHeight;\n  }\n\n  /**\n   * Prepare UI\n   * @return {Element}\n   */\n  renderUi(){\n    this.nodes.wrapper = Dom.make('div', Chart.CSS.wrapper);\n    this.nodes.viewport = Dom.make('div', Chart.CSS.viewport);\n    this.nodes.cursorLine = this.pointer.render();\n\n    this.nodes.wrapper.appendChild(this.nodes.viewport);\n    this.nodes.wrapper.appendChild(this.nodes.cursorLine);\n    this.nodes.wrapper.appendChild(this.tooltip.render());\n\n    this.nodes.wrapper.classList.add(Chart.CSS.wrapper + '--' + this.modules.state.type);\n\n    this.bindEvents();\n\n    return this.nodes.wrapper;\n  }\n\n  /**\n   * Renders charts\n   */\n  renderCharts(){\n    this.calculateWrapperCoords();\n\n    if (this.nodes.canvas){\n      this.nodes.canvas.remove();\n    }\n\n    /**\n     * @todo pass height through the initial settings\n     */\n    this.nodes.canvas = this.graph.renderCanvas({\n      width: this.nodes.viewport.offsetWidth,\n      height: this.modules.state.height\n    });\n    this.nodes.viewport.appendChild(this.nodes.canvas);\n\n    /**\n     * Get initial scale\n     */\n    this.calculateInitialValues();\n\n\n\n    this.graph.renderCharts();\n    this.renderGrid();\n    this.renderLegend();\n    this.renderOverlays();\n  }\n\n  createLine(){\n    const line = Dom.make('div', Chart.CSS.gridSection);\n    this.nodes.grid.appendChild(line);\n    this.nodes.gridLines.push(line);\n\n    return line;\n  }\n\n  getLegendStep(max, min, stepsCount, kY, kYRatio){\n    let diffSize = max - min;\n    let step = diffSize / stepsCount;\n    let decimals = Math.log10(diffSize) >> 0;\n    let rounding = Math.pow(10, decimals) / 2;\n\n    step = Math.ceil(step / rounding) * rounding;\n\n    let possibleHeight = step * stepsCount * kY;\n\n    if (possibleHeight > this.height){\n      step = step / (possibleHeight / this.height >> 0);\n    }\n\n    return step;\n  }\n\n  getLegendCounter(value, name, isSecond){\n    let counter = Dom.make('span', Chart.CSS.gridCounter);\n    let text = Numbers.beautify(Math.round(value));\n\n    if (this.modules.state.type === 'area'){\n      text += '%';\n    }\n\n    counter.textContent = text;\n    counter.dataset.name = name;\n\n    if (isSecond){\n      counter.classList.add(Chart.CSS.gridCounterSecond);\n    } else {\n      counter.classList.add(Chart.CSS.gridCounterFirst);\n    }\n\n    return counter;\n  }\n\n  /**\n   * Render or updates a grid\n   */\n  renderGrid(){\n    if (!this.nodes.grid) {\n      this.nodes.grid = Dom.make('div', Chart.CSS.grid);\n      this.nodes.grid.style.height = `${this.modules.state.height}px`;\n      this.nodes.gridLines = [];\n      Dom.insertBefore(this.nodes.canvas, this.nodes.grid);\n    }\n\n    let height = this.height;\n    let max = this.getMaxVisiblePoint();\n    let min = !this.modules.state.isYScaled ? this.graph.currentMinimum || 0 : this.graph.charts['0'].currentMinimum;\n    let kY = height / (max - min);\n    let linesCount = 5;\n    let stepY = this.getLegendStep(max, min, linesCount, kY);\n\n    let stepYSecond, kYSecond, maxSecond, minSecond;\n\n    if (this.modules.state.isYScaled){\n      maxSecond = this.getMaxVisiblePoint('1');\n      minSecond = this.getMinVisiblePoint('1');\n\n      kYSecond = height / (maxSecond - minSecond);\n      let kYRatio = kY / kYSecond;\n\n      stepYSecond = this.getLegendStep(maxSecond, minSecond, linesCount, kYSecond, kYRatio);\n    }\n\n    if (this.modules.state.type === 'area'){\n      stepY = 25;\n      linesCount = 5;\n      max = 100;\n      kY = height / max;\n    }\n\n    if (this.nodes.gridLines.length){\n      this.nodes.gridLines.forEach( line => {\n        line.classList.add(Chart.CSS.gridSectionHidden);\n      })\n    }\n\n    for (let j = 0; j <= linesCount; j++) {\n      let y = j * stepY;\n      let line;\n\n      if (this.nodes.gridLines.length && this.nodes.gridLines[j]){\n        line = this.nodes.gridLines[j];\n      } else {\n        line = this.createLine();\n      }\n\n      if (j === 0){\n        line.classList.add('no-animation');\n      }\n\n      let bottom = y * kY;\n\n      if (bottom > this.height){\n        continue;\n      }\n\n      line.classList.remove(Chart.CSS.gridSectionHidden);\n      line.style.bottom = `${y * kY}px`;\n\n      line.innerHTML = '';\n\n\n      let counter = this.getLegendCounter(y + min, '0');\n      line.appendChild(counter);\n\n      if (stepYSecond){\n        counter.style.color = this.modules.state.getLineColor('0');\n        let kYRatio = kY / kYSecond;\n        let counter2 = this.getLegendCounter((j * stepYSecond + minSecond), '1', true);\n        counter2.style.color = this.modules.state.getLineColor('1');\n        line.appendChild(counter2);\n      }\n    }\n\n    if (this.modules.state.isYScaled){\n      this.toggleGridLabelsForChart();\n    }\n  }\n\n  /**\n   * Check if date under passed index should be visible\n   * @param {number} originalIndex - index in this.modules.state.dates\n   * @return {boolean}\n   */\n  checkDateShouldBeHidden(originalIndex){\n    let skippedCount = Math.round(((this.onscreenPointsCount / this.datesPerScreen ) - this._showEveryNDateInitial) / this._showEveryNDateInitial);\n    let checks = [];\n\n    for (let i = 1; i < skippedCount + 1; i++){\n      let idxToCheck = originalIndex + i * this._showEveryNDateInitial;\n      let check = idxToCheck % (this._showEveryNDateInitial * 2 * i) === 0;\n      checks.push(check)\n    }\n\n    return checks.some(check => !!check);\n  }\n\n  moveDate(originalIndex){\n    let dateEl = this.onscreenDatesElements[originalIndex];\n    let centering = 'translateX(-85%)';\n    let newX = originalIndex * this.stepScaled + this.scrollValue;\n\n    if (originalIndex === 0){\n      centering = '';\n    }\n\n    if (originalIndex === this.modules.state.daysCount - 1){\n      centering = 'translateX(-100%)';\n    }\n\n    dateEl.style.transform = `translateX(${ newX }px)` + centering;\n\n    if (this.checkDateShouldBeHidden(originalIndex)){\n      dateEl.classList.add('hided');\n    } else {\n      dateEl.classList.remove('hided');\n    }\n  }\n\n\n  pushDate(date, originIndex, visibleIndex){\n    if (this.checkDateShouldBeHidden(originIndex)){\n      return;\n    }\n\n    const dt = new Date(date);\n    const dateEl = Dom.make('time');\n\n    if (this.modules.state.byMonth){\n      dateEl.textContent = dt.toLocaleDateString('en-US', {\n        month: 'short'\n      });\n    } else {\n      dateEl.textContent = dt.toLocaleDateString('en-US', {\n        day: 'numeric',\n        month: 'short'\n      });\n    }\n\n    // dateEl.textContent = originIndex;\n\n    this.nodes.legend.appendChild(dateEl);\n    this.nodes.legendDates.push(dateEl);\n    this.onscreenDates.add(originIndex);\n    this.onscreenDatesElements[originIndex] = dateEl;\n    this.moveDate(originIndex);\n  }\n\n  get onscreenPointsCount(){\n    return Math.floor(this.viewportWidth / this.stepScaled);\n  }\n\n  /**\n   * Left visible point\n   * @return {number}\n   */\n  // get leftPointIndex(){\n  //   return parseInt(Math.floor(this.scrollValue * -1/ this.stepX / this.scaling));\n  // }\n\n  /**\n   * Right visible point\n   * @return {number}\n   */\n  get rightPointIndex(){\n    return this.leftPointIndex + this.onscreenPointsCount;\n  }\n\n  get datesPerScreen(){\n    if (!this._datesPerScreenInitial){\n      this._datesPerScreenInitial = Math.floor(this.viewportWidth / (this.legendDateWidth + this.legendDateWidthMargins));\n    }\n    return this._datesPerScreenInitial;\n  }\n\n  get stepScaled(){\n    return this.stepX * this.scaling\n  }\n\n  addOnscreenDates(){\n    /**\n     * Get slice of timestamps that currently visible on the screen\n     */\n    let datesOnScreenSlice = this.modules.state.dates.slice(this.leftPointIndex, this.rightPointIndex + 2);\n    let datesOnScreenIndexes = new Set();\n\n    if (!this._showEveryNDateInitial){\n      let pointsOnScreen = this.rightPointIndex - this.leftPointIndex;\n      this._showEveryNDateInitial = Math.ceil(pointsOnScreen / this.datesPerScreen);\n    }\n\n    let visibleIndex = 0;\n\n    datesOnScreenSlice.forEach((date, index) => {\n      const originIndex = this.leftPointIndex + index;\n\n\n      /**\n       * Skip dates that can not be fit event on maximum zoom\n       */\n      if (originIndex % this._showEveryNDateInitial !== 0){\n        return;\n      }\n\n      /**\n       * Store index of added date to check if it out of screen\n       */\n      datesOnScreenIndexes.add(originIndex);\n\n      /**\n       * If point already showed, move it\n       */\n      if (this.onscreenDates.has(originIndex)){\n        this.moveDate(originIndex);\n        visibleIndex++;\n        return\n      }\n\n      /**\n       * Add new date to its position computed by original index * step scaled\n       */\n      this.pushDate(date, originIndex, visibleIndex);\n      visibleIndex++;\n    });\n\n    /**\n     * Remove dates that are out of screen\n     */\n    this.onscreenDates.forEach((originalIndex) => {\n      if (!datesOnScreenIndexes.has(originalIndex)) {\n        this.removeDate(originalIndex);\n      }\n    });\n  }\n\n  removeDate(originalIndex){\n    if (!this.onscreenDatesElements[originalIndex]){\n      return;\n    }\n\n    this.onscreenDates[originalIndex] = null;\n    this.onscreenDates.delete(originalIndex);\n    this.onscreenDatesElements[originalIndex].remove();\n    this.onscreenDatesElements[originalIndex] = null;\n  }\n\n  /**\n   * Renders a legend with dates\n   * @param {number[]} dates\n   */\n  renderLegend(){\n    this.nodes.legend = Dom.make('footer');\n\n    // this.addOnscreenDates();\n\n    Dom.insertAfter(this.nodes.canvas, this.nodes.legend);\n  }\n\n  /**\n   * Perform scroll\n   * @param position\n   */\n  scroll(position, fromScale){\n    this.scrollValue = position * -1;\n    this.graph.scroll(this.scrollValue);\n    this.tooltip.hide();\n    this.pointer.hide();\n    this.hideBarHighlighting();\n    this.addOnscreenDates();\n\n    if (this._sd){\n      clearTimeout(this._sd);\n    }\n\n    this._sd = setTimeout(()=>{\n      const rightDate = this.modules.state.dates[this.rightPointIndex] || this.modules.state.dates[this.rightPointIndex - 1];\n\n      this.modules.header.setPeriod(this.modules.state.dates[this.leftPointIndex], rightDate);\n    }, 50)\n  }\n\n  /**\n   * Perform scaling\n   * @param {number} scaling\n   */\n  scale(scaling, direction){\n    this.graph.scaleLines(scaling, direction);\n\n    this.scaling = scaling;\n  }\n\n  /**\n   * Left visible point\n   * @return {number}\n   */\n  get leftPointIndex(){\n    return Math.ceil(this.scrollValue * -1/ this.graph.step / this.scaling);\n  }\n\n  /**\n   * Filter to skip hidden line\n   * @param {string} line - name of the graph\n   * @return {boolean}\n   */\n  notHiddenGraph(line){\n    return this.graph.checkPathVisibility(line);\n  }\n\n  get pointsVisible(){\n    const stepX = this.graph.step;\n    return Math.round(this.viewportWidth / stepX / this.scaling);\n  }\n\n  /**\n   * Return max visible point\n   * If line passed, check for that. Otherwise, return maximum between all\n   */\n  getMaxVisiblePoint(line = undefined){\n    return this.graph.getMaxFromVisible(this.leftPointIndex, this.pointsVisible + 1, line);\n  }\n\n  /**\n   * Return min visible point\n   * If line passed, check for that. Otherwise, return maximum between all\n   */\n  getMinVisiblePoint(line = undefined){\n    const leftPointVisible = Math.max(0, this.leftPointIndex -1);\n\n    if (!line){\n      return Math.min(...this.modules.state.linesAvailable.filter(line => this.notHiddenGraph(line)).map(line => {\n        return this.modules.state.getMinForLineSliced(line, leftPointVisible, this.pointsVisible + 1);\n      }));\n    }\n\n    return this.modules.state.getMinForLineSliced(line, leftPointVisible , this.pointsVisible + 1);\n  }\n\n  /**\n   * Upscale or downscale graph to fit visible points\n   */\n  fitToMax(){\n    if (this.modules.state.type !== 'area'){\n      if (!this.modules.state.isYScaled){\n        this.graph.scaleToMaxPoint(this.getMaxVisiblePoint(), this.getMinVisiblePoint());\n      } else {\n        this.modules.state.linesAvailable.filter(line => this.notHiddenGraph(line)).forEach((line) => {\n          this.graph.scaleToMaxPoint(this.getMaxVisiblePoint(line), this.getMinVisiblePoint(line), line);\n        })\n      }\n    }\n\n    /**\n     * Rerender grid if it was rendered before\n     */\n    if (this.nodes.grid){\n\n      if (this._gd){\n        clearTimeout(this._gd);\n      }\n\n      this._gd = setTimeout(() => {\n        this.renderGrid();\n      }, 15)\n    }\n  }\n\n  /**\n   * Store wrapper rectangle data\n   */\n  calculateWrapperCoords(){\n    let rect = this.nodes.wrapper.getBoundingClientRect();\n\n    this.wrapperLeftCoord = rect.left;\n  }\n\n  bindEvents(){\n    let supportsPassive = false;\n    try {\n      let opts = Object.defineProperty({}, 'passive', {\n        get: function() {\n          supportsPassive = true;\n        }\n      });\n      window.addEventListener(\"testPassive\", null, opts);\n      window.removeEventListener(\"testPassive\", null, opts);\n    } catch (e) {}\n\n    this.nodes.wrapper.addEventListener('mousemove', (event) => {\n      this.mouseMove(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    this.nodes.wrapper.addEventListener('mouseleave', (event) => {\n      this.mouseLeave(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    this.nodes.wrapper.addEventListener('touchmove', (event) => {\n      this.mouseMove(event);\n    }, supportsPassive ? { passive: true } : false);\n\n    this.nodes.wrapper.addEventListener('touchcancel', (event) => {\n      this.mouseLeave(event);\n    }, supportsPassive ? { passive: true } : false);\n  }\n\n  /**\n   * Shows line with Tooltip\n   * @param {MouseEvent|TouchEvent} event\n   */\n  mouseMove(event){\n    let x = Event.getPageX(event);\n    let viewportX = x - this.wrapperLeftCoord;\n\n    let stepXWithScale = this.graph.stepX * this.scaling;\n    let scrollOffset = this.scrollValue % stepXWithScale;\n    let pointIndex = Math.round((viewportX - scrollOffset) / this.graph.stepX / this.scaling) - 1;\n\n    if (this.leftPointIndex === 0){\n      pointIndex = pointIndex + 1;\n    }\n\n    let hoveredPointIndex = pointIndex + this.leftPointIndex;\n\n    /**\n     * Prevent recalculations on mousemove with the same point\n     */\n    if (hoveredPointIndex === this._hoveredPointIndex){\n      return;\n    }\n\n\n    /**\n     * Case when scrolled chart shows wrong index\n     * @since 2019/09/10  Does not occurs after 1.0.5\n     */\n    if (Math.abs(scrollOffset) > (stepXWithScale / 2) ){\n      // console.warn('scrolled');\n    }\n\n    this._hoveredPointIndex = hoveredPointIndex;\n\n    let newLeft = (pointIndex + 1) * stepXWithScale + scrollOffset;\n\n    if (this.leftPointIndex === 0){\n      newLeft = pointIndex * stepXWithScale + scrollOffset;\n    }\n\n    // console.log('scroll offset %o | step %o (%o)| index %o | x %o | drawn at %o | first step offset %o | left index %o ', scrollOffset, this.graph.stepX, stepXWithScale, pointIndex, viewportX, newLeft, firstStepOffset, this.leftPointIndex);\n\n     if (newLeft < this.stepScaled * 2){\n       // let old = this.scrollValue;\n       // let newScroll = (this.scrollValue + 20) * -1;\n\n       //scroll\n       //\n       // this.modules.minimap.moveViewport(-1 * (old*-1 - newScroll));\n       // this.scroll(newScroll);\n     }\n\n     if (newLeft < 0 || newLeft > this.viewportWidth){\n       return;\n     }\n\n    this.tooltip.show();\n\n    if (this.modules.state.type === 'bar'){\n      this.highlightBar(pointIndex, scrollOffset);\n    } else {\n      this.pointer.move(newLeft);\n    }\n\n    const values = this.modules.state.linesAvailable.filter(line => this.notHiddenGraph(line)).map( line => {\n      return {\n        name: line,\n        value: this.modules.state.getLinePoints(line)[hoveredPointIndex]\n      }\n    });\n\n    /**\n     * Show circles\n     */\n    if (values.length){\n      this.pointer.showValues(values);\n    } else {\n      this.tooltip.hide();\n    }\n\n    const date = this.modules.state.dates[hoveredPointIndex];\n\n    /**\n     * Skip bounding empty positions\n     */\n    if (!date){\n      return;\n    }\n\n    this.tooltip.values = values;\n    this.tooltip.move(newLeft, values);\n    this.tooltip.date = new Date(date);\n  }\n\n  mouseLeave(){\n    this.tooltip.hide();\n    this.pointer.hide();\n    this.hideOverlays();\n  }\n\n  /**\n   * Toggle path visibility\n   * @param {string} name - graph name\n   */\n  togglePath(name, status){\n    this.graph.togglePathVisibility(name, status);\n    this.pointer.toggleVisibility(name);\n\n    if (this.modules.state.type === 'bar'){\n      this.graph.recalculatePointsHeight();\n      this.fitToMax();\n    } else if (this.modules.state.type === 'area') {\n      this.graph.recalculatePointsHeight();\n    } else {\n      this.fitToMax();\n    }\n  }\n\n  toggleGridLabelsForChart(){\n    this.modules.state.linesAvailable.forEach(line => {\n      this.nodes.grid.querySelectorAll(`[data-name=\"${line}\"]`).forEach( el => {\n        el.classList.toggle(Chart.CSS.gridCounterHidden, !this.graph.checkPathVisibility(line))\n      });\n    });\n  }\n\n  highlightBar(index, scrollOffset){\n    this.nodes.overlays.style.opacity = '1';\n    let leftWidth = index * this.stepScaled + scrollOffset - (this.stepScaled / 2);\n\n    if (scrollOffset !== 0){\n      leftWidth = leftWidth + this.stepScaled;\n    }\n\n    let rightX = leftWidth + this.stepScaled;\n    let rightWidth = Math.max(0 , (this.onscreenPointsCount - index)) * this.stepScaled - scrollOffset;\n\n\n    this.nodes.overlayLeft.setAttribute('width', Math.max(0, leftWidth) );\n    this.nodes.overlayRight.setAttribute('x', rightX);\n    this.nodes.overlayRight.setAttribute('width', Math.max(0, rightWidth));\n  }\n\n  hideBarHighlighting(){\n    this.nodes.overlays.style.opacity = '0';\n  }\n\n  renderOverlays(){\n    this.nodes.overlays = Dom.make('g');\n    this.nodes.overlays.setAttribute('class', Chart.CSS.overlays);\n\n\n    this.nodes.overlayLeft = Dom.make('rect');\n    this.nodes.overlayLeft.setAttribute('class', Chart.CSS.overlayLeft);\n    this.nodes.overlayRight = Dom.make('rect');\n    this.nodes.overlayRight.setAttribute('class', Chart.CSS.overlayRight);\n\n    let defaultWidth = 0;\n\n    this.nodes.overlayLeft.setAttribute('x', 0);\n    this.nodes.overlayRight.setAttribute('x', this.viewportWidth - defaultWidth);\n    this.nodes.overlayLeft.setAttribute('y', 0);\n    this.nodes.overlayRight.setAttribute('y', 0);\n    this.nodes.overlayLeft.setAttribute('width', defaultWidth);\n    this.nodes.overlayRight.setAttribute('width', defaultWidth);\n    this.nodes.overlayLeft.setAttribute('height', this.viewportHeight);\n    this.nodes.overlayRight.setAttribute('height', this.viewportHeight);\n\n    this.nodes.overlays.appendChild(this.nodes.overlayLeft);\n    this.nodes.overlays.appendChild(this.nodes.overlayRight);\n    this.graph.canvas.appendChild(this.nodes.overlays);\n  }\n\n  hideOverlays(){\n    this.nodes.overlays.style.opacity = 0;\n  }\n\n  destroy(){\n    this.nodes.canvas.remove();\n\n    this._datesPerScreenInitial = undefined;\n    this._showEveryNDateInitial = undefined;\n\n    if (this.nodes.overlays){\n      this.nodes.overlays.remove();\n    }\n\n    if (this.nodes.legend){\n      this.nodes.legend.remove();\n    }\n\n    this.scaling = 1;\n    this.scrollValue = 0;\n  }\n}\n","import * as Dom from '../utils/dom.js';\n\nexport default class Legend {\n  /**\n   * @param {Graphon} modules\n   */\n  constructor(modules){\n    this.modules = modules;\n    this.nodes = {\n      wrapper: undefined,\n    };\n\n    this.buttons = {};\n  }\n\n  static get CSS(){\n    return {\n      wrapper: 'tg-legend',\n      item: 'tg-legend__item',\n      itemWobble: 'tg-legend__item--wobble',\n      itemSelected: 'tg-legend__item--selected',\n      itemEnabled: 'tg-legend__item--enabled',\n      checkbox: 'tg-legend__checkbox',\n    }\n  }\n\n  /**\n   * Show graphs togglers\n   * @return {Element}\n   */\n  render(){\n    this.nodes.wrapper = Dom.make('div', Legend.CSS.wrapper);\n\n    /**\n     * Object with names -> array with names\n     */\n    const namesArray = Object.entries(this.modules.state.names).map(([name, title]) => {\n      return {name, title}\n    });\n\n    namesArray.forEach(({name, title}) => {\n      let item = Dom.make('div', [Legend.CSS.item, Legend.CSS.itemEnabled]),\n        checkbox = Dom.make('span', Legend.CSS.checkbox);\n\n      item.appendChild(checkbox);\n      item.appendChild(document.createTextNode(title));\n\n      this.buttons[name] = item;\n\n      this._clickPrevented = false;\n\n      item.addEventListener('click', () => {\n        if (!this._clickPrevented){\n          this.itemClicked(name);\n        }\n      });\n\n      item.addEventListener('mousedown', () => {\n        this.mousedown(name);\n      });\n\n      item.addEventListener('touchstart', () => {\n        this.mousedown(name);\n      });\n\n      item.addEventListener('mouseup', () => {\n        this.mouseup(name);\n      });\n\n      item.addEventListener('touchend', () => {\n        this.mouseup(name);\n      });\n\n      this.toggle(name, true);\n\n      this.nodes.wrapper.appendChild(item);\n    });\n    return this.nodes.wrapper;\n  }\n\n  mousedown(name){\n    this._timer = setTimeout(() => {\n      this._clickPrevented = true;\n\n      this.uncheckAllExceptPassed(name);\n    }, 500);\n  }\n\n  uncheckAllExceptPassed(exceptName) {\n    Object.entries(this.buttons).forEach(([name, el], index) => {\n        if (name !== exceptName){\n          this.toggle(name, false);\n\n          this.modules.chart.togglePath(name, true);\n          this.modules.minimap.togglePath(name, true);\n        } else {\n          this.toggle(name, true);\n\n          this.modules.chart.togglePath(name, false);\n          this.modules.minimap.togglePath(name, false);\n        }\n    })\n\n  }\n\n\n  mouseup(name){\n    if (!this._timer){\n      return;\n    }\n\n    setTimeout(() => {\n      this._clickPrevented = false;\n    }, 400)\n\n    clearTimeout(this._timer);\n  }\n\n\n  /**\n   * Click handler for togglers\n   * @param {string} name - graph name\n   */\n  itemClicked(name){\n    let isLast = this.modules.state.linesAvailable.filter(line => this.modules.chart.graph.checkPathVisibility(line)).length === 1;\n\n    if (!this.buttons[name].classList.contains(Legend.CSS.itemEnabled)){\n      this.toggle(name, true);\n    } else {\n      if (isLast){\n        this.buttons[name].classList.add(Legend.CSS.itemWobble);\n        setTimeout(() => {\n          this.buttons[name].classList.remove(Legend.CSS.itemWobble);\n        }, 300);\n\n        return;\n      }\n\n      this.toggle(name, false);\n    }\n\n    this.modules.chart.togglePath(name);\n    this.modules.minimap.togglePath(name);\n  }\n\n  toggle(name, status = true){\n    const checkbox = this.buttons[name].querySelector(`.${Legend.CSS.checkbox}`);\n\n    this.buttons[name].classList.toggle(Legend.CSS.itemEnabled, status);\n\n    checkbox.style.backgroundColor = status ? this.modules.state.colors[name] : '#EFEFEF';\n  }\n}\n","import * as Dom from \"../utils/dom\";\n\nexport default class Header {\n  constructor(modules){\n    this.modules = modules;\n    this.nodes = {\n      wrapper: undefined,\n      title: undefined,\n      dates: undefined,\n      typeSwitchers: [],\n      detailsTogglers: [],\n    };\n\n  }\n\n  /**\n   * @return {{wrapper: string, title: string, dates: string, typeSwitcher: string, typeSwitcherCurrent: string, detailsToggler: string, detailsTogglerItem: string, detailsTogglerItemCurrent: string}}\n   */\n  static get CSS(){\n    return {\n      wrapper: 'tg-header',\n      title: 'tg-header__title',\n      dates: 'tg-header__dates',\n      typeSwitcher: 'tg-header__type-switcher',\n      typeSwitcherCurrent: 'tg-header__type-switcher--current',\n      detailsToggler: 'tg-header__details',\n      detailsTogglerItem: 'tg-header__details-item',\n      detailsTogglerItemCurrent: 'tg-header__details-item--current',\n    }\n  }\n\n  render(){\n    this.nodes.wrapper = Dom.make('div', Header.CSS.wrapper);\n    this.nodes.title = Dom.make('div', Header.CSS.title);\n    this.nodes.dates = Dom.make('div', Header.CSS.dates);\n\n    this.nodes.title.textContent = this.modules.state.title || 'Untitled';\n    this.nodes.wrapper.appendChild(this.nodes.title);\n\n    if (this.modules.dataByMonth){\n      this.appendDetailsToggler();\n    }\n\n    if (this.modules.showTypeSwitchers) {\n      [\n        {\n          type: 'line',\n          icon: `<svg width=\"17\" height=\"9\" xmlns=\"http://www.w3.org/2000/svg\" style=\"margin: auto -2px;\">\n                <path d=\"M13.638 4.28l-1.566 1.5c.147.294.23.623.23.97 0 1.243-1.053 2.25-2.35 2.25-1.298 0-2.35-1.007-2.35-2.25 0-.094.006-.187.018-.278L5.317 5.37c-.422.39-.997.63-1.63.63-.302 0-.59-.054-.854-.153L1 8 0 7l1.717-2.023a2.172 2.172 0 0 1-.38-1.227c0-1.243 1.052-2.25 2.35-2.25 1.297 0 2.349 1.007 2.349 2.25 0 .094-.006.187-.018.278L8.321 5.13c.422-.39.997-.63 1.63-.63.363 0 .707.079 1.014.22l1.565-1.5a2.163 2.163 0 0 1-.229-.97c0-1.243 1.052-2.25 2.35-2.25C15.948 0 17 1.007 17 2.25S15.948 4.5 14.65 4.5c-.362 0-.706-.079-1.012-.22zm-9.952.22c.433 0 .784-.336.784-.75S4.119 3 3.686 3c-.432 0-.783.336-.783.75s.35.75.783.75zm6.266 3c.432 0 .783-.336.783-.75S10.385 6 9.952 6c-.433 0-.784.336-.784.75s.351.75.784.75zM14.65 3c.432 0 .783-.336.783-.75s-.35-.75-.783-.75c-.433 0-.784.336-.784.75s.351.75.784.75z\"/>\n              </svg>`\n        },\n        {\n          type: 'area',\n          icon: `<svg width=\"15\" height=\"13\" xmlns=\"http://www.w3.org/2000/svg\" style=\"margin: auto -1px;\">\n                <path d=\"M15 7.952L6.032 9.233 3.765 6.21 0 8.36V5.382l3.557-2.371 4.884 3.488L15 4.531v3.42zm0 1.443v1.462a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-.85l3.378-1.931 2.019 2.69L15 9.396zm0-6.355L8.702 4.93 3.585 1.274 0 3.665V2a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v1.04z\"/>\n              </svg>`\n        },\n        {\n          type: 'bar',\n          icon: `<svg width=\"14\" height=\"13\" xmlns=\"http://www.w3.org/2000/svg\">\n                <rect y=\"7\" width=\"2\" height=\"6\" rx=\"1\"/>\n                <rect x=\"12\" y=\"6\" width=\"2\" height=\"7\" rx=\"1\"/>\n                <rect x=\"4\" y=\"4\" width=\"2\" height=\"9\" rx=\"1\"/>\n                <rect x=\"8\" width=\"2\" height=\"13\" rx=\"1\"/>\n              </svg>`,\n        },\n      ].forEach(({type, icon}) => {\n        const switcher = Dom.make('span', Header.CSS.typeSwitcher);\n\n        if (type === this.modules.state.type){\n          switcher.classList.add(Header.CSS.typeSwitcherCurrent);\n        }\n\n        switcher.innerHTML = icon;\n        switcher.addEventListener('click', () => {\n          this.typeSwitcherClicked(type, switcher);\n        });\n\n        this.nodes.typeSwitchers.push(switcher);\n\n        this.nodes.wrapper.appendChild(switcher);\n      });\n    }\n\n    this.nodes.wrapper.appendChild(this.nodes.dates);\n\n    return this.nodes.wrapper\n  }\n\n  /**\n   * Create Day|Month toggler\n   */\n  appendDetailsToggler(){\n    const toggler = Dom.make('span', Header.CSS.detailsToggler);\n\n    [\n      {\n        title: 'Day',\n        dataStoringProperty: 'data'\n      },\n      {\n        title: 'Month',\n        dataStoringProperty: 'dataByMonth'\n      }\n    ].forEach(({title, dataStoringProperty}, index) => {\n      const togglerItem = Dom.make('span', Header.CSS.detailsTogglerItem);\n\n      if (index === 0) {\n        togglerItem.classList.add(Header.CSS.detailsTogglerItemCurrent);\n      }\n\n      togglerItem.innerHTML = title;\n      togglerItem.addEventListener('click', () => {\n        this.detailsTogglerClicked(dataStoringProperty, togglerItem);\n      });\n      toggler.appendChild(togglerItem);\n\n      this.nodes.detailsTogglers.push(togglerItem);\n    });\n\n    this.nodes.wrapper.appendChild(toggler);\n  }\n\n  typeSwitcherClicked(type, switcher){\n    this.modules.state.type = type;\n    this.modules.state.clearRecalculatedValues();\n    this.modules.chart.destroy();\n    this.modules.chart.renderCharts();\n    this.modules.minimap.renderMap();\n    this.modules.minimap.syncScrollWithChart();\n\n    this.nodes.typeSwitchers.forEach(el => el.classList.remove(Header.CSS.typeSwitcherCurrent));\n\n    switcher.classList.add(Header.CSS.typeSwitcherCurrent);\n  }\n\n  /**\n   * Daily/Monthly switcher\n   * @param {string} dataStoringProperty - where to get charts data : 'data' or 'dataByMonth'\n   * @param {Element} toggler - button\n   */\n  detailsTogglerClicked(dataStoringProperty, toggler){\n    this.modules.createState(dataStoringProperty);\n\n    this.modules.chart.destroy();\n    this.modules.chart.renderCharts();\n    this.modules.minimap.renderMap();\n    this.modules.minimap.syncScrollWithChart();\n\n    this.nodes.detailsTogglers.forEach(el => el.classList.remove(Header.CSS.detailsTogglerItemCurrent));\n\n    toggler.classList.add(Header.CSS.detailsTogglerItemCurrent);\n  }\n\n  setPeriod(leftDateTimestamp, rightDateTimestamp){\n    this._sd = setTimeout(() => {\n      let leftDate = (new Date(leftDateTimestamp)).toLocaleDateString('en-US', {\n        day: 'numeric',\n        month: 'short',\n        year: 'numeric'\n      });\n      let rightDate = (new Date(rightDateTimestamp)).toLocaleDateString('en-US', {\n        day: 'numeric',\n        month: 'short',\n        year: 'numeric'\n      });\n\n      this.nodes.dates.innerHTML = `${leftDate} - ${rightDate}`;\n\n    }, 20)\n  }\n}\n","import Styles from './styles/index.pcss';\n\nimport State from './modules/state';\nimport Minimap from './modules/minimap.js';\nimport Chart from './modules/chart.js';\nimport Legend from './modules/legend.js';\nimport Header from './modules/header.js';\n\nexport default class Graphon {\n  /**\n   * Main entry constructor\n   * @param {string} holderId - where to append a Chart\n   * @param {string} data - chart data in csv format\n   * @param {string} dataByMonth - chart data grouped by months in csv format\n   * @param {string} type - graph type. Available types: 'line', 'area', 'bar'\n   * @param {string[]} colors - colors list for each line\n   * @param {string[]} titles - titles list for each line\n   * @param {string} title - Graph title\n   * @param {boolean} byMonth - is graphs represents data grouped by month\n   * @param {boolean} scaled - enabled 2-axis mode\n   * @param {number} height - chart height\n   * @param {boolean} showLegend - legend visibility state\n   * @param {boolean} showTypeSwitchers - type switchers visibility state\n   */\n  constructor({holderId, data, dataByMonth, colors, titles, type, title, byMonth, scaled, height = 350, showLegend = true, showTypeSwitchers = true}) {\n    this.holder = document.getElementById(holderId);\n\n    /**\n     * Append <style> with all styles\n     */\n    this.loadStyles();\n\n    /**\n     * Save input params to allow to recreate State object\n     */\n    this.data = data ? data.trim() : null;\n    this.dataByMonth = dataByMonth ? dataByMonth.trim() : null;\n    this.colors = colors;\n    this.type = type;\n    this.title = title;\n    this.titles = titles;\n    this.byMonth = byMonth;\n    this.scaled = scaled;\n    this.height = height;\n    this.showLegend = showLegend;\n    this.showTypeSwitchers = showTypeSwitchers;\n\n    this.createState();\n\n    /**\n     * Module for mini map\n     */\n    this.minimap = new Minimap(this);\n\n    /**\n     * Working with main chart zone\n     */\n    this.chart = new Chart(this);\n\n    /**\n     * Working with legend items\n     */\n    this.legend = new Legend(this);\n\n    /**\n     * Header module\n     */\n    this.header = new Header(this);\n\n    /**\n     * Create base UI elements\n     */\n    this.prepareUi();\n\n    /**\n     * Render chart and mini map\n     */\n    this.chart.renderCharts();\n    this.minimap.renderMap();\n\n    // console.timeEnd('telegraph');\n  }\n\n  /**\n   * CSS classes map\n   * @return {{nightModeEnabled: string}}\n   */\n  static get CSS(){\n    return {\n      nightModeEnabled : 'tg--night-mode'\n    }\n  }\n\n  /**\n   * Create an object with all graphs data\n   * @param {string} dataStoringProperty - name of field that stores input data in csv\n   */\n  createState(dataStoringProperty = 'data'){\n    /**\n     * Force set byMonth state depends on dataStoringProperty\n     * @type {boolean}\n     */\n    this.byMonth = dataStoringProperty === 'dataByMonth';\n\n    /**\n     * Module that stores all main app state values\n     */\n    this.state = new State(this[dataStoringProperty], this.colors, this.titles, this.type, this.title, this.byMonth, this.scaled, this.height);\n  }\n\n  /**\n   * Load styles and append it via <style id=\"specc-graph-styles\"> tag\n   */\n  loadStyles(){\n    const styleIdentifier = 'specc-graph-styles';\n    const styleExists = document.getElementById(styleIdentifier);\n\n    if (styleExists){\n      return;\n    }\n\n    const style = document.createElement('style');\n    const head = document.querySelector('head');\n\n    style.id = styleIdentifier;\n    style.textContent = Styles;\n\n    head.appendChild(style);\n  }\n\n  /**\n   * Create base app UI\n   */\n  prepareUi(){\n    this.holder.appendChild(this.header.render());\n    this.holder.appendChild(this.chart.renderUi());\n    this.holder.appendChild(this.minimap.renderUi());\n\n    if (this.showLegend) {\n      this.holder.appendChild(this.legend.render());\n    }\n  }\n\n  /**\n   * @public\n   * Toggles night mode\n   */\n  toggleNightMode(){\n    this.holder.classList.toggle(Graphon.CSS.nightModeEnabled);\n  }\n}\n"],"sourceRoot":""}